import{r as j,a as qs,R as ce,L as it,u as Vs,b as Hs,c as Ks,d as Et,H as Ws}from"./vendor-CxJdZliX.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var Vr={exports:{}},ft={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Js=j,Gs=Symbol.for("react.element"),Ys=Symbol.for("react.fragment"),Qs=Object.prototype.hasOwnProperty,Zs=Js.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Xs={key:!0,ref:!0,__self:!0,__source:!0};function Hr(t,e,r){var s,n={},i=null,a=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(s in e)Qs.call(e,s)&&!Xs.hasOwnProperty(s)&&(n[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)n[s]===void 0&&(n[s]=e[s]);return{$$typeof:Gs,type:t,key:i,ref:a,props:n,_owner:Zs.current}}ft.Fragment=Ys;ft.jsx=Hr;ft.jsxs=Hr;Vr.exports=ft;var h=Vr.exports,Lt={},pr=qs;Lt.createRoot=pr.createRoot,Lt.hydrateRoot=pr.hydrateRoot;let en={data:""},tn=t=>{if(typeof window=="object"){let e=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(t||document.head).appendChild(e),e.firstChild}return t||en},rn=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,sn=/\/\*[^]*?\*\/|  +/g,mr=/\n+/g,ae=(t,e)=>{let r="",s="",n="";for(let i in t){let a=t[i];i[0]=="@"?i[1]=="i"?r=i+" "+a+";":s+=i[1]=="f"?ae(a,i):i+"{"+ae(a,i[1]=="k"?"":e)+"}":typeof a=="object"?s+=ae(a,e?e.replace(/([^,])+/g,o=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,o):o?o+" "+l:l)):i):a!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=ae.p?ae.p(i,a):i+":"+a+";")}return r+(e&&n?e+"{"+n+"}":n)+s},te={},Kr=t=>{if(typeof t=="object"){let e="";for(let r in t)e+=r+Kr(t[r]);return e}return t},nn=(t,e,r,s,n)=>{let i=Kr(t),a=te[i]||(te[i]=(l=>{let c=0,u=11;for(;c<l.length;)u=101*u+l.charCodeAt(c++)>>>0;return"go"+u})(i));if(!te[a]){let l=i!==t?t:(c=>{let u,g,d=[{}];for(;u=rn.exec(c.replace(sn,""));)u[4]?d.shift():u[3]?(g=u[3].replace(mr," ").trim(),d.unshift(d[0][g]=d[0][g]||{})):d[0][u[1]]=u[2].replace(mr," ").trim();return d[0]})(t);te[a]=ae(n?{["@keyframes "+a]:l}:l,r?"":"."+a)}let o=r&&te.g?te.g:null;return r&&(te.g=te[a]),((l,c,u,g)=>{g?c.data=c.data.replace(g,l):c.data.indexOf(l)===-1&&(c.data=u?l+c.data:c.data+l)})(te[a],e,s,o),a},an=(t,e,r)=>t.reduce((s,n,i)=>{let a=e[i];if(a&&a.call){let o=a(r),l=o&&o.props&&o.props.className||/^go/.test(o)&&o;a=l?"."+l:o&&typeof o=="object"?o.props?"":ae(o,""):o===!1?"":o}return s+n+(a??"")},"");function gt(t){let e=this||{},r=t.call?t(e.p):t;return nn(r.unshift?r.raw?an(r,[].slice.call(arguments,1),e.p):r.reduce((s,n)=>Object.assign(s,n&&n.call?n(e.p):n),{}):r,tn(e.target),e.g,e.o,e.k)}let Wr,Bt,Mt;gt.bind({g:1});let se=gt.bind({k:1});function on(t,e,r,s){ae.p=e,Wr=t,Bt=r,Mt=s}function he(t,e){let r=this||{};return function(){let s=arguments;function n(i,a){let o=Object.assign({},i),l=o.className||n.className;r.p=Object.assign({theme:Bt&&Bt()},o),r.o=/ *go\d+/.test(l),o.className=gt.apply(r,s)+(l?" "+l:"");let c=t;return t[0]&&(c=o.as||t,delete o.as),Mt&&c[0]&&Mt(o),Wr(c,o)}return n}}var ln=t=>typeof t=="function",ot=(t,e)=>ln(t)?t(e):t,cn=(()=>{let t=0;return()=>(++t).toString()})(),Jr=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),un=20,sr="default",Gr=(t,e)=>{let{toastLimit:r}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,r)};case 1:return{...t,toasts:t.toasts.map(a=>a.id===e.toast.id?{...a,...e.toast}:a)};case 2:let{toast:s}=e;return Gr(t,{type:t.toasts.find(a=>a.id===s.id)?1:0,toast:s});case 3:let{toastId:n}=e;return{...t,toasts:t.toasts.map(a=>a.id===n||n===void 0?{...a,dismissed:!0,visible:!1}:a)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(a=>a.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(a=>({...a,pauseDuration:a.pauseDuration+i}))}}},at=[],Yr={toasts:[],pausedAt:void 0,settings:{toastLimit:un}},X={},Qr=(t,e=sr)=>{X[e]=Gr(X[e]||Yr,t),at.forEach(([r,s])=>{r===e&&s(X[e])})},Zr=t=>Object.keys(X).forEach(e=>Qr(t,e)),hn=t=>Object.keys(X).find(e=>X[e].toasts.some(r=>r.id===t)),pt=(t=sr)=>e=>{Qr(e,t)},dn={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},fn=(t={},e=sr)=>{let[r,s]=j.useState(X[e]||Yr),n=j.useRef(X[e]);j.useEffect(()=>(n.current!==X[e]&&s(X[e]),at.push([e,s]),()=>{let a=at.findIndex(([o])=>o===e);a>-1&&at.splice(a,1)}),[e]);let i=r.toasts.map(a=>{var o,l,c;return{...t,...t[a.type],...a,removeDelay:a.removeDelay||((o=t[a.type])==null?void 0:o.removeDelay)||(t==null?void 0:t.removeDelay),duration:a.duration||((l=t[a.type])==null?void 0:l.duration)||(t==null?void 0:t.duration)||dn[a.type],style:{...t.style,...(c=t[a.type])==null?void 0:c.style,...a.style}}});return{...r,toasts:i}},gn=(t,e="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...r,id:(r==null?void 0:r.id)||cn()}),Ge=t=>(e,r)=>{let s=gn(e,t,r);return pt(s.toasterId||hn(s.id))({type:2,toast:s}),s.id},B=(t,e)=>Ge("blank")(t,e);B.error=Ge("error");B.success=Ge("success");B.loading=Ge("loading");B.custom=Ge("custom");B.dismiss=(t,e)=>{let r={type:3,toastId:t};e?pt(e)(r):Zr(r)};B.dismissAll=t=>B.dismiss(void 0,t);B.remove=(t,e)=>{let r={type:4,toastId:t};e?pt(e)(r):Zr(r)};B.removeAll=t=>B.remove(void 0,t);B.promise=(t,e,r)=>{let s=B.loading(e.loading,{...r,...r==null?void 0:r.loading});return typeof t=="function"&&(t=t()),t.then(n=>{let i=e.success?ot(e.success,n):void 0;return i?B.success(i,{id:s,...r,...r==null?void 0:r.success}):B.dismiss(s),n}).catch(n=>{let i=e.error?ot(e.error,n):void 0;i?B.error(i,{id:s,...r,...r==null?void 0:r.error}):B.dismiss(s)}),t};var pn=1e3,mn=(t,e="default")=>{let{toasts:r,pausedAt:s}=fn(t,e),n=j.useRef(new Map).current,i=j.useCallback((g,d=pn)=>{if(n.has(g))return;let f=setTimeout(()=>{n.delete(g),a({type:4,toastId:g})},d);n.set(g,f)},[]);j.useEffect(()=>{if(s)return;let g=Date.now(),d=r.map(f=>{if(f.duration===1/0)return;let p=(f.duration||0)+f.pauseDuration-(g-f.createdAt);if(p<0){f.visible&&B.dismiss(f.id);return}return setTimeout(()=>B.dismiss(f.id,e),p)});return()=>{d.forEach(f=>f&&clearTimeout(f))}},[r,s,e]);let a=j.useCallback(pt(e),[e]),o=j.useCallback(()=>{a({type:5,time:Date.now()})},[a]),l=j.useCallback((g,d)=>{a({type:1,toast:{id:g,height:d}})},[a]),c=j.useCallback(()=>{s&&a({type:6,time:Date.now()})},[s,a]),u=j.useCallback((g,d)=>{let{reverseOrder:f=!1,gutter:p=8,defaultPosition:w}=d||{},_=r.filter(m=>(m.position||w)===(g.position||w)&&m.height),y=_.findIndex(m=>m.id===g.id),v=_.filter((m,b)=>b<y&&m.visible).length;return _.filter(m=>m.visible).slice(...f?[v+1]:[0,v]).reduce((m,b)=>m+(b.height||0)+p,0)},[r]);return j.useEffect(()=>{r.forEach(g=>{if(g.dismissed)i(g.id,g.removeDelay);else{let d=n.get(g.id);d&&(clearTimeout(d),n.delete(g.id))}})},[r,i]),{toasts:r,handlers:{updateHeight:l,startPause:o,endPause:c,calculateOffset:u}}},wn=se`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,yn=se`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,vn=se`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,bn=he("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${wn} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${yn} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${vn} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,_n=se`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,xn=he("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${_n} 1s linear infinite;
`,En=se`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,kn=se`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Sn=he("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${En} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${kn} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Tn=he("div")`
  position: absolute;
`,jn=he("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Cn=se`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Rn=he("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Cn} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,An=({toast:t})=>{let{icon:e,type:r,iconTheme:s}=t;return e!==void 0?typeof e=="string"?j.createElement(Rn,null,e):e:r==="blank"?null:j.createElement(jn,null,j.createElement(xn,{...s}),r!=="loading"&&j.createElement(Tn,null,r==="error"?j.createElement(bn,{...s}):j.createElement(Sn,{...s})))},On=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Nn=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,In="0%{opacity:0;} 100%{opacity:1;}",Pn="0%{opacity:1;} 100%{opacity:0;}",$n=he("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Un=he("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Dn=(t,e)=>{let r=t.includes("top")?1:-1,[s,n]=Jr()?[In,Pn]:[On(r),Nn(r)];return{animation:e?`${se(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${se(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Ln=j.memo(({toast:t,position:e,style:r,children:s})=>{let n=t.height?Dn(t.position||e||"top-center",t.visible):{opacity:0},i=j.createElement(An,{toast:t}),a=j.createElement(Un,{...t.ariaProps},ot(t.message,t));return j.createElement($n,{className:t.className,style:{...n,...r,...t.style}},typeof s=="function"?s({icon:i,message:a}):j.createElement(j.Fragment,null,i,a))});on(j.createElement);var Bn=({id:t,className:e,style:r,onHeightUpdate:s,children:n})=>{let i=j.useCallback(a=>{if(a){let o=()=>{let l=a.getBoundingClientRect().height;s(t,l)};o(),new MutationObserver(o).observe(a,{subtree:!0,childList:!0,characterData:!0})}},[t,s]);return j.createElement("div",{ref:i,className:e,style:r},n)},Mn=(t,e)=>{let r=t.includes("top"),s=r?{top:0}:{bottom:0},n=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Jr()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(r?1:-1)}px)`,...s,...n}},zn=gt`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ze=16,Fn=({reverseOrder:t,position:e="top-center",toastOptions:r,gutter:s,children:n,toasterId:i,containerStyle:a,containerClassName:o})=>{let{toasts:l,handlers:c}=mn(r,i);return j.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Ze,left:Ze,right:Ze,bottom:Ze,pointerEvents:"none",...a},className:o,onMouseEnter:c.startPause,onMouseLeave:c.endPause},l.map(u=>{let g=u.position||e,d=c.calculateOffset(u,{reverseOrder:t,gutter:s,defaultPosition:e}),f=Mn(g,d);return j.createElement(Bn,{id:u.id,key:u.id,onHeightUpdate:c.updateHeight,className:u.visible?zn:"",style:f},u.type==="custom"?ot(u.message,u):n?n(u):j.createElement(Ln,{toast:u,position:g}))}))},q=B,Xr={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},wr=ce.createContext&&ce.createContext(Xr),ue=function(){return ue=Object.assign||function(t){for(var e,r=1,s=arguments.length;r<s;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},ue.apply(this,arguments)},qn=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};function es(t){return t&&t.map(function(e,r){return ce.createElement(e.tag,ue({key:r},e.attr),es(e.child))})}function M(t){return function(e){return ce.createElement(Vn,ue({attr:ue({},t.attr)},e),es(t.child))}}function Vn(t){var e=function(r){var s=t.attr,n=t.size,i=t.title,a=qn(t,["attr","size","title"]),o=n||r.size||"1em",l;return r.className&&(l=r.className),t.className&&(l=(l?l+" ":"")+t.className),ce.createElement("svg",ue({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,s,a,{className:l,style:ue(ue({color:t.color||r.color},r.style),t.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),i&&ce.createElement("title",null,i),t.children)};return wr!==void 0?ce.createElement(wr.Consumer,null,function(r){return e(r)}):e(Xr)}function Hn(t){return M({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 384c-28.02 0-31.26-32-74.5-32-43.43 0-46.825 32-74.75 32-27.695 0-31.454-32-74.75-32-42.842 0-47.218 32-74.5 32-28.148 0-31.202-32-74.75-32-43.547 0-46.653 32-74.75 32v-80c0-26.5 21.5-48 48-48h16V112h64v144h64V112h64v144h64V112h64v144h16c26.5 0 48 21.5 48 48v80zm0 128H0v-96c43.356 0 46.767-32 74.75-32 27.951 0 31.253 32 74.75 32 42.843 0 47.217-32 74.5-32 28.148 0 31.201 32 74.75 32 43.357 0 46.767-32 74.75-32 27.488 0 31.252 32 74.5 32v96zM96 96c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40zm128 0c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40zm128 0c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40z"}}]})(t)}function Kn(t){return M({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M32 448c0 17.7 14.3 32 32 32h160V320H32v128zm256 32h160c17.7 0 32-14.3 32-32V320H288v160zm192-320h-42.1c6.2-12.1 10.1-25.5 10.1-40 0-48.5-39.5-88-88-88-41.6 0-68.5 21.3-103 68.3-34.5-47-61.4-68.3-103-68.3-48.5 0-88 39.5-88 88 0 14.5 3.8 27.9 10.1 40H32c-17.7 0-32 14.3-32 32v80c0 8.8 7.2 16 16 16h480c8.8 0 16-7.2 16-16v-80c0-17.7-14.3-32-32-32zm-326.1 0c-22.1 0-40-17.9-40-40s17.9-40 40-40c19.9 0 34.6 3.3 86.1 80h-86.1zm206.1 0h-86.1c51.4-76.5 65.7-80 86.1-80 22.1 0 40 17.9 40 40s-17.9 40-40 40z"}}]})(t)}function Wn(t){return M({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"}}]})(t)}function Jn(t){return M({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"}}]})(t)}function nr(t){return M({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M360 0H24C10.745 0 0 10.745 0 24v16c0 13.255 10.745 24 24 24 0 90.965 51.016 167.734 120.842 192C75.016 280.266 24 357.035 24 448c-13.255 0-24 10.745-24 24v16c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24v-16c0-13.255-10.745-24-24-24 0-90.965-51.016-167.734-120.842-192C308.984 231.734 360 154.965 360 64c13.255 0 24-10.745 24-24V24c0-13.255-10.745-24-24-24zm-75.078 384H99.08c17.059-46.797 52.096-80 92.92-80 40.821 0 75.862 33.196 92.922 80zm.019-256H99.078C91.988 108.548 88 86.748 88 64h208c0 22.805-3.987 44.587-11.059 64z"}}]})(t)}function ts(t){return M({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"}}]})(t)}function Gn(t){return M({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"}}]})(t)}function Yn(t){return M({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"}}]})(t)}function Qn(t){return M({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"}}]})(t)}function Zn(t){return M({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 224h192V32H0v192zM64 96h64v64H64V96zm192-64v192h192V32H256zm128 128h-64V96h64v64zM0 480h192V288H0v192zm64-128h64v64H64v-64zm352-64h32v128h-96v-32h-32v96h-64V288h96v32h64v-32zm0 160h32v32h-32v-32zm-64 0h32v32h-32v-32z"}}]})(t)}function Xn(t){return M({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505.12019,19.09375c-1.18945-5.53125-6.65819-11-12.207-12.1875C460.716,0,435.507,0,410.40747,0,307.17523,0,245.26909,55.20312,199.05238,128H94.83772c-16.34763.01562-35.55658,11.875-42.88664,26.48438L2.51562,253.29688A28.4,28.4,0,0,0,0,264a24.00867,24.00867,0,0,0,24.00582,24H127.81618l-22.47457,22.46875c-11.36521,11.36133-12.99607,32.25781,0,45.25L156.24582,406.625c11.15623,11.1875,32.15619,13.15625,45.27726,0l22.47457-22.46875V488a24.00867,24.00867,0,0,0,24.00581,24,28.55934,28.55934,0,0,0,10.707-2.51562l98.72834-49.39063c14.62888-7.29687,26.50776-26.5,26.50776-42.85937V312.79688c72.59753-46.3125,128.03493-108.40626,128.03493-211.09376C512.07526,76.5,512.07526,51.29688,505.12019,19.09375ZM384.04033,168A40,40,0,1,1,424.05,128,40.02322,40.02322,0,0,1,384.04033,168Z"}}]})(t)}function ei(t){return M({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M352 320c-22.608 0-43.387 7.819-59.79 20.895l-102.486-64.054a96.551 96.551 0 0 0 0-41.683l102.486-64.054C308.613 184.181 329.392 192 352 192c53.019 0 96-42.981 96-96S405.019 0 352 0s-96 42.981-96 96c0 7.158.79 14.13 2.276 20.841L155.79 180.895C139.387 167.819 118.608 160 96 160c-53.019 0-96 42.981-96 96s42.981 96 96 96c22.608 0 43.387-7.819 59.79-20.895l102.486 64.054A96.301 96.301 0 0 0 256 416c0 53.019 42.981 96 96 96s96-42.981 96-96-42.981-96-96-96z"}}]})(t)}function ti(t){return M({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M510.9 152.3l-5.9-14.5c-3.3-8-12.6-11.9-20.8-8.7L456 140.6v-29c0-8.6-7.2-15.6-16-15.6h-16c-8.8 0-16 7-16 15.6v46.9c0 .5.3 1 .3 1.5l-56.4 23c-5.9-10-13.3-18.9-22-26.6 13.6-16.6 22-37.4 22-60.5 0-53-43-96-96-96s-96 43-96 96c0 23.1 8.5 43.9 22 60.5-8.7 7.7-16 16.6-22 26.6l-56.4-23c.1-.5.3-1 .3-1.5v-46.9C104 103 96.8 96 88 96H72c-8.8 0-16 7-16 15.6v29l-28.1-11.5c-8.2-3.2-17.5.7-20.8 8.7l-5.9 14.5c-3.3 8 .7 17.1 8.9 20.3l135.2 55.2c-.4 4-1.2 8-1.2 12.2 0 10.1 1.7 19.6 4.2 28.9C120.9 296.4 104 334.2 104 376c0 54 28.4 100.9 70.8 127.8 9.3 5.9 20.3 8.2 31.3 8.2h99.2c13.3 0 26.3-4.1 37.2-11.7 46.5-32.3 74.4-89.4 62.9-152.6-5.5-30.2-20.5-57.6-41.6-79 2.5-9.2 4.2-18.7 4.2-28.7 0-4.2-.8-8.1-1.2-12.2L502 172.6c8.1-3.1 12.1-12.2 8.9-20.3zM224 96c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm32 272c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm0-64c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm0-64c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm0-88s-16-23.2-16-32 7.2-16 16-16 16 7.2 16 16-16 32-16 32zm32-56c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"}}]})(t)}function ri(t){return M({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"}}]})(t)}function si(t){return M({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M296 384h-80c-13.3 0-24-10.7-24-24V192h-87.7c-17.8 0-26.7-21.5-14.1-34.1L242.3 5.7c7.5-7.5 19.8-7.5 27.3 0l152.2 152.2c12.6 12.6 3.7 34.1-14.1 34.1H320v168c0 13.3-10.7 24-24 24zm216-8v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h136v8c0 30.9 25.1 56 56 56h80c30.9 0 56-25.1 56-56v-8h136c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"}}]})(t)}function ni(){return h.jsx("div",{className:"text-center",children:h.jsxs("div",{className:"max-w-4xl mx-auto",children:[h.jsxs("h1",{className:"text-5xl md:text-6xl font-bold text-gray-900 mb-6",children:["Crea Countdowns Personalizados",h.jsx("span",{className:"block text-purple-600",children:"con Códigos QR"})]}),h.jsx("p",{className:"text-xl text-gray-600 mb-10",children:"Genera cuenta regresivas únicas para cumpleaños, eventos especiales, Navidad... ¡Todo con un QR que puedes imprimir o compartir!"}),h.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mb-12",children:[h.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-lg",children:[h.jsx("div",{className:"text-purple-600 mb-4",children:h.jsx(Zn,{className:"text-5xl mx-auto"})}),h.jsx("h3",{className:"text-2xl font-bold mb-3",children:"QR Generado Automáticamente"}),h.jsx("p",{className:"text-gray-600",children:"Cada countdown tiene su propio código QR único para compartir fácilmente."})]}),h.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-lg",children:[h.jsx("div",{className:"text-purple-600 mb-4",children:h.jsx(ts,{className:"text-5xl mx-auto"})}),h.jsx("h3",{className:"text-2xl font-bold mb-3",children:"Personalización Completa"}),h.jsx("p",{className:"text-gray-600",children:"Elige colores, imágenes de fondo y iconos animados para la barra de progreso."})]})]}),h.jsx(it,{to:"/create",className:"inline-block px-8 py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white text-xl font-bold rounded-full hover:from-purple-700 hover:to-pink-700 transform hover:-translate-y-1 transition-all duration-300 shadow-xl",children:"Comenzar a Crear →"}),h.jsxs("div",{className:"mt-16",children:[h.jsx("h2",{className:"text-3xl font-bold mb-8",children:"¿Cómo funciona?"}),h.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow",children:[h.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:"1"}),h.jsx("h4",{className:"font-bold mb-2",children:"Configura tu evento"}),h.jsx("p",{className:"text-gray-600",children:"Elige fecha, mensaje, colores e icono."})]}),h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow",children:[h.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:"2"}),h.jsx("h4",{className:"font-bold mb-2",children:"Genera el QR"}),h.jsx("p",{className:"text-gray-600",children:"Obtén automáticamente un código QR único."})]}),h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow",children:[h.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:"3"}),h.jsx("h4",{className:"font-bold mb-2",children:"Comparte"}),h.jsx("p",{className:"text-gray-600",children:"Envía el QR o enlace a quien quieras."})]})]})]})]})})}var Ne={},ii=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},rs={},W={};let ir;const ai=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];W.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};W.getSymbolTotalCodewords=function(e){return ai[e]};W.getBCHDigit=function(t){let e=0;for(;t!==0;)e++,t>>>=1;return e};W.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');ir=e};W.isKanjiModeEnabled=function(){return typeof ir<"u"};W.toSJIS=function(e){return ir(e)};var mt={};(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function e(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+r)}}t.isValid=function(s){return s&&typeof s.bit<"u"&&s.bit>=0&&s.bit<4},t.from=function(s,n){if(t.isValid(s))return s;try{return e(s)}catch{return n}}})(mt);function ss(){this.buffer=[],this.length=0}ss.prototype={get:function(t){const e=Math.floor(t/8);return(this.buffer[e]>>>7-t%8&1)===1},put:function(t,e){for(let r=0;r<e;r++)this.putBit((t>>>e-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var oi=ss;function Ye(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}Ye.prototype.set=function(t,e,r,s){const n=t*this.size+e;this.data[n]=r,s&&(this.reservedBit[n]=!0)};Ye.prototype.get=function(t,e){return this.data[t*this.size+e]};Ye.prototype.xor=function(t,e,r){this.data[t*this.size+e]^=r};Ye.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var li=Ye,ns={};(function(t){const e=W.getSymbolSize;t.getRowColCoords=function(s){if(s===1)return[];const n=Math.floor(s/7)+2,i=e(s),a=i===145?26:Math.ceil((i-13)/(2*n-2))*2,o=[i-7];for(let l=1;l<n-1;l++)o[l]=o[l-1]-a;return o.push(6),o.reverse()},t.getPositions=function(s){const n=[],i=t.getRowColCoords(s),a=i.length;for(let o=0;o<a;o++)for(let l=0;l<a;l++)o===0&&l===0||o===0&&l===a-1||o===a-1&&l===0||n.push([i[o],i[l]]);return n}})(ns);var is={};const ci=W.getSymbolSize,yr=7;is.getPositions=function(e){const r=ci(e);return[[0,0],[r-yr,0],[0,r-yr]]};var as={};(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};t.isValid=function(n){return n!=null&&n!==""&&!isNaN(n)&&n>=0&&n<=7},t.from=function(n){return t.isValid(n)?parseInt(n,10):void 0},t.getPenaltyN1=function(n){const i=n.size;let a=0,o=0,l=0,c=null,u=null;for(let g=0;g<i;g++){o=l=0,c=u=null;for(let d=0;d<i;d++){let f=n.get(g,d);f===c?o++:(o>=5&&(a+=e.N1+(o-5)),c=f,o=1),f=n.get(d,g),f===u?l++:(l>=5&&(a+=e.N1+(l-5)),u=f,l=1)}o>=5&&(a+=e.N1+(o-5)),l>=5&&(a+=e.N1+(l-5))}return a},t.getPenaltyN2=function(n){const i=n.size;let a=0;for(let o=0;o<i-1;o++)for(let l=0;l<i-1;l++){const c=n.get(o,l)+n.get(o,l+1)+n.get(o+1,l)+n.get(o+1,l+1);(c===4||c===0)&&a++}return a*e.N2},t.getPenaltyN3=function(n){const i=n.size;let a=0,o=0,l=0;for(let c=0;c<i;c++){o=l=0;for(let u=0;u<i;u++)o=o<<1&2047|n.get(c,u),u>=10&&(o===1488||o===93)&&a++,l=l<<1&2047|n.get(u,c),u>=10&&(l===1488||l===93)&&a++}return a*e.N3},t.getPenaltyN4=function(n){let i=0;const a=n.data.length;for(let l=0;l<a;l++)i+=n.data[l];return Math.abs(Math.ceil(i*100/a/5)-10)*e.N4};function r(s,n,i){switch(s){case t.Patterns.PATTERN000:return(n+i)%2===0;case t.Patterns.PATTERN001:return n%2===0;case t.Patterns.PATTERN010:return i%3===0;case t.Patterns.PATTERN011:return(n+i)%3===0;case t.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(i/3))%2===0;case t.Patterns.PATTERN101:return n*i%2+n*i%3===0;case t.Patterns.PATTERN110:return(n*i%2+n*i%3)%2===0;case t.Patterns.PATTERN111:return(n*i%3+(n+i)%2)%2===0;default:throw new Error("bad maskPattern:"+s)}}t.applyMask=function(n,i){const a=i.size;for(let o=0;o<a;o++)for(let l=0;l<a;l++)i.isReserved(l,o)||i.xor(l,o,r(n,l,o))},t.getBestMask=function(n,i){const a=Object.keys(t.Patterns).length;let o=0,l=1/0;for(let c=0;c<a;c++){i(c),t.applyMask(c,n);const u=t.getPenaltyN1(n)+t.getPenaltyN2(n)+t.getPenaltyN3(n)+t.getPenaltyN4(n);t.applyMask(c,n),u<l&&(l=u,o=c)}return o}})(as);var wt={};const le=mt,Xe=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],et=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];wt.getBlocksCount=function(e,r){switch(r){case le.L:return Xe[(e-1)*4+0];case le.M:return Xe[(e-1)*4+1];case le.Q:return Xe[(e-1)*4+2];case le.H:return Xe[(e-1)*4+3];default:return}};wt.getTotalCodewordsCount=function(e,r){switch(r){case le.L:return et[(e-1)*4+0];case le.M:return et[(e-1)*4+1];case le.Q:return et[(e-1)*4+2];case le.H:return et[(e-1)*4+3];default:return}};var os={},yt={};const Be=new Uint8Array(512),lt=new Uint8Array(256);(function(){let e=1;for(let r=0;r<255;r++)Be[r]=e,lt[e]=r,e<<=1,e&256&&(e^=285);for(let r=255;r<512;r++)Be[r]=Be[r-255]})();yt.log=function(e){if(e<1)throw new Error("log("+e+")");return lt[e]};yt.exp=function(e){return Be[e]};yt.mul=function(e,r){return e===0||r===0?0:Be[lt[e]+lt[r]]};(function(t){const e=yt;t.mul=function(s,n){const i=new Uint8Array(s.length+n.length-1);for(let a=0;a<s.length;a++)for(let o=0;o<n.length;o++)i[a+o]^=e.mul(s[a],n[o]);return i},t.mod=function(s,n){let i=new Uint8Array(s);for(;i.length-n.length>=0;){const a=i[0];for(let l=0;l<n.length;l++)i[l]^=e.mul(n[l],a);let o=0;for(;o<i.length&&i[o]===0;)o++;i=i.slice(o)}return i},t.generateECPolynomial=function(s){let n=new Uint8Array([1]);for(let i=0;i<s;i++)n=t.mul(n,new Uint8Array([1,e.exp(i)]));return n}})(os);const ls=os;function ar(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}ar.prototype.initialize=function(e){this.degree=e,this.genPoly=ls.generateECPolynomial(this.degree)};ar.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(e.length+this.degree);r.set(e);const s=ls.mod(r,this.genPoly),n=this.degree-s.length;if(n>0){const i=new Uint8Array(this.degree);return i.set(s,n),i}return s};var ui=ar,cs={},de={},or={};or.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var ee={};const us="[0-9]+",hi="[A-Z $%*+\\-./:]+";let Fe="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Fe=Fe.replace(/u/g,"\\u");const di="(?:(?![A-Z0-9 $%*+\\-./:]|"+Fe+`)(?:.|[\r
]))+`;ee.KANJI=new RegExp(Fe,"g");ee.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");ee.BYTE=new RegExp(di,"g");ee.NUMERIC=new RegExp(us,"g");ee.ALPHANUMERIC=new RegExp(hi,"g");const fi=new RegExp("^"+Fe+"$"),gi=new RegExp("^"+us+"$"),pi=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");ee.testKanji=function(e){return fi.test(e)};ee.testNumeric=function(e){return gi.test(e)};ee.testAlphanumeric=function(e){return pi.test(e)};(function(t){const e=or,r=ee;t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(i,a){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!e.isValid(a))throw new Error("Invalid version: "+a);return a>=1&&a<10?i.ccBits[0]:a<27?i.ccBits[1]:i.ccBits[2]},t.getBestModeForData=function(i){return r.testNumeric(i)?t.NUMERIC:r.testAlphanumeric(i)?t.ALPHANUMERIC:r.testKanji(i)?t.KANJI:t.BYTE},t.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},t.isValid=function(i){return i&&i.bit&&i.ccBits};function s(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+n)}}t.from=function(i,a){if(t.isValid(i))return i;try{return s(i)}catch{return a}}})(de);(function(t){const e=W,r=wt,s=mt,n=de,i=or,a=7973,o=e.getBCHDigit(a);function l(d,f,p){for(let w=1;w<=40;w++)if(f<=t.getCapacity(w,p,d))return w}function c(d,f){return n.getCharCountIndicator(d,f)+4}function u(d,f){let p=0;return d.forEach(function(w){const _=c(w.mode,f);p+=_+w.getBitsLength()}),p}function g(d,f){for(let p=1;p<=40;p++)if(u(d,p)<=t.getCapacity(p,f,n.MIXED))return p}t.from=function(f,p){return i.isValid(f)?parseInt(f,10):p},t.getCapacity=function(f,p,w){if(!i.isValid(f))throw new Error("Invalid QR Code version");typeof w>"u"&&(w=n.BYTE);const _=e.getSymbolTotalCodewords(f),y=r.getTotalCodewordsCount(f,p),v=(_-y)*8;if(w===n.MIXED)return v;const m=v-c(w,f);switch(w){case n.NUMERIC:return Math.floor(m/10*3);case n.ALPHANUMERIC:return Math.floor(m/11*2);case n.KANJI:return Math.floor(m/13);case n.BYTE:default:return Math.floor(m/8)}},t.getBestVersionForData=function(f,p){let w;const _=s.from(p,s.M);if(Array.isArray(f)){if(f.length>1)return g(f,_);if(f.length===0)return 1;w=f[0]}else w=f;return l(w.mode,w.getLength(),_)},t.getEncodedBits=function(f){if(!i.isValid(f)||f<7)throw new Error("Invalid QR Code version");let p=f<<12;for(;e.getBCHDigit(p)-o>=0;)p^=a<<e.getBCHDigit(p)-o;return f<<12|p}})(cs);var hs={};const zt=W,ds=1335,mi=21522,vr=zt.getBCHDigit(ds);hs.getEncodedBits=function(e,r){const s=e.bit<<3|r;let n=s<<10;for(;zt.getBCHDigit(n)-vr>=0;)n^=ds<<zt.getBCHDigit(n)-vr;return(s<<10|n)^mi};var fs={};const wi=de;function Ie(t){this.mode=wi.NUMERIC,this.data=t.toString()}Ie.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};Ie.prototype.getLength=function(){return this.data.length};Ie.prototype.getBitsLength=function(){return Ie.getBitsLength(this.data.length)};Ie.prototype.write=function(e){let r,s,n;for(r=0;r+3<=this.data.length;r+=3)s=this.data.substr(r,3),n=parseInt(s,10),e.put(n,10);const i=this.data.length-r;i>0&&(s=this.data.substr(r),n=parseInt(s,10),e.put(n,i*3+1))};var yi=Ie;const vi=de,kt=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Pe(t){this.mode=vi.ALPHANUMERIC,this.data=t}Pe.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};Pe.prototype.getLength=function(){return this.data.length};Pe.prototype.getBitsLength=function(){return Pe.getBitsLength(this.data.length)};Pe.prototype.write=function(e){let r;for(r=0;r+2<=this.data.length;r+=2){let s=kt.indexOf(this.data[r])*45;s+=kt.indexOf(this.data[r+1]),e.put(s,11)}this.data.length%2&&e.put(kt.indexOf(this.data[r]),6)};var bi=Pe;const _i=de;function $e(t){this.mode=_i.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}$e.getBitsLength=function(e){return e*8};$e.prototype.getLength=function(){return this.data.length};$e.prototype.getBitsLength=function(){return $e.getBitsLength(this.data.length)};$e.prototype.write=function(t){for(let e=0,r=this.data.length;e<r;e++)t.put(this.data[e],8)};var xi=$e;const Ei=de,ki=W;function Ue(t){this.mode=Ei.KANJI,this.data=t}Ue.getBitsLength=function(e){return e*13};Ue.prototype.getLength=function(){return this.data.length};Ue.prototype.getBitsLength=function(){return Ue.getBitsLength(this.data.length)};Ue.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let r=ki.toSJIS(this.data[e]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),t.put(r,13)}};var Si=Ue,gs={exports:{}};(function(t){var e={single_source_shortest_paths:function(r,s,n){var i={},a={};a[s]=0;var o=e.PriorityQueue.make();o.push(s,0);for(var l,c,u,g,d,f,p,w,_;!o.empty();){l=o.pop(),c=l.value,g=l.cost,d=r[c]||{};for(u in d)d.hasOwnProperty(u)&&(f=d[u],p=g+f,w=a[u],_=typeof a[u]>"u",(_||w>p)&&(a[u]=p,o.push(u,p),i[u]=c))}if(typeof n<"u"&&typeof a[n]>"u"){var y=["Could not find a path from ",s," to ",n,"."].join("");throw new Error(y)}return i},extract_shortest_path_from_predecessor_list:function(r,s){for(var n=[],i=s;i;)n.push(i),r[i],i=r[i];return n.reverse(),n},find_path:function(r,s,n){var i=e.single_source_shortest_paths(r,s,n);return e.extract_shortest_path_from_predecessor_list(i,n)},PriorityQueue:{make:function(r){var s=e.PriorityQueue,n={},i;r=r||{};for(i in s)s.hasOwnProperty(i)&&(n[i]=s[i]);return n.queue=[],n.sorter=r.sorter||s.default_sorter,n},default_sorter:function(r,s){return r.cost-s.cost},push:function(r,s){var n={value:r,cost:s};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=e})(gs);var Ti=gs.exports;(function(t){const e=de,r=yi,s=bi,n=xi,i=Si,a=ee,o=W,l=Ti;function c(y){return unescape(encodeURIComponent(y)).length}function u(y,v,m){const b=[];let C;for(;(C=y.exec(m))!==null;)b.push({data:C[0],index:C.index,mode:v,length:C[0].length});return b}function g(y){const v=u(a.NUMERIC,e.NUMERIC,y),m=u(a.ALPHANUMERIC,e.ALPHANUMERIC,y);let b,C;return o.isKanjiModeEnabled()?(b=u(a.BYTE,e.BYTE,y),C=u(a.KANJI,e.KANJI,y)):(b=u(a.BYTE_KANJI,e.BYTE,y),C=[]),v.concat(m,b,C).sort(function(R,N){return R.index-N.index}).map(function(R){return{data:R.data,mode:R.mode,length:R.length}})}function d(y,v){switch(v){case e.NUMERIC:return r.getBitsLength(y);case e.ALPHANUMERIC:return s.getBitsLength(y);case e.KANJI:return i.getBitsLength(y);case e.BYTE:return n.getBitsLength(y)}}function f(y){return y.reduce(function(v,m){const b=v.length-1>=0?v[v.length-1]:null;return b&&b.mode===m.mode?(v[v.length-1].data+=m.data,v):(v.push(m),v)},[])}function p(y){const v=[];for(let m=0;m<y.length;m++){const b=y[m];switch(b.mode){case e.NUMERIC:v.push([b,{data:b.data,mode:e.ALPHANUMERIC,length:b.length},{data:b.data,mode:e.BYTE,length:b.length}]);break;case e.ALPHANUMERIC:v.push([b,{data:b.data,mode:e.BYTE,length:b.length}]);break;case e.KANJI:v.push([b,{data:b.data,mode:e.BYTE,length:c(b.data)}]);break;case e.BYTE:v.push([{data:b.data,mode:e.BYTE,length:c(b.data)}])}}return v}function w(y,v){const m={},b={start:{}};let C=["start"];for(let E=0;E<y.length;E++){const R=y[E],N=[];for(let U=0;U<R.length;U++){const J=R[U],k=""+E+U;N.push(k),m[k]={node:J,lastCount:0},b[k]={};for(let I=0;I<C.length;I++){const A=C[I];m[A]&&m[A].node.mode===J.mode?(b[A][k]=d(m[A].lastCount+J.length,J.mode)-d(m[A].lastCount,J.mode),m[A].lastCount+=J.length):(m[A]&&(m[A].lastCount=J.length),b[A][k]=d(J.length,J.mode)+4+e.getCharCountIndicator(J.mode,v))}}C=N}for(let E=0;E<C.length;E++)b[C[E]].end=0;return{map:b,table:m}}function _(y,v){let m;const b=e.getBestModeForData(y);if(m=e.from(v,b),m!==e.BYTE&&m.bit<b.bit)throw new Error('"'+y+'" cannot be encoded with mode '+e.toString(m)+`.
 Suggested mode is: `+e.toString(b));switch(m===e.KANJI&&!o.isKanjiModeEnabled()&&(m=e.BYTE),m){case e.NUMERIC:return new r(y);case e.ALPHANUMERIC:return new s(y);case e.KANJI:return new i(y);case e.BYTE:return new n(y)}}t.fromArray=function(v){return v.reduce(function(m,b){return typeof b=="string"?m.push(_(b,null)):b.data&&m.push(_(b.data,b.mode)),m},[])},t.fromString=function(v,m){const b=g(v,o.isKanjiModeEnabled()),C=p(b),E=w(C,m),R=l.find_path(E.map,"start","end"),N=[];for(let U=1;U<R.length-1;U++)N.push(E.table[R[U]].node);return t.fromArray(f(N))},t.rawSplit=function(v){return t.fromArray(g(v,o.isKanjiModeEnabled()))}})(fs);const vt=W,St=mt,ji=oi,Ci=li,Ri=ns,Ai=is,Ft=as,qt=wt,Oi=ui,ct=cs,Ni=hs,Ii=de,Tt=fs;function Pi(t,e){const r=t.size,s=Ai.getPositions(e);for(let n=0;n<s.length;n++){const i=s[n][0],a=s[n][1];for(let o=-1;o<=7;o++)if(!(i+o<=-1||r<=i+o))for(let l=-1;l<=7;l++)a+l<=-1||r<=a+l||(o>=0&&o<=6&&(l===0||l===6)||l>=0&&l<=6&&(o===0||o===6)||o>=2&&o<=4&&l>=2&&l<=4?t.set(i+o,a+l,!0,!0):t.set(i+o,a+l,!1,!0))}}function $i(t){const e=t.size;for(let r=8;r<e-8;r++){const s=r%2===0;t.set(r,6,s,!0),t.set(6,r,s,!0)}}function Ui(t,e){const r=Ri.getPositions(e);for(let s=0;s<r.length;s++){const n=r[s][0],i=r[s][1];for(let a=-2;a<=2;a++)for(let o=-2;o<=2;o++)a===-2||a===2||o===-2||o===2||a===0&&o===0?t.set(n+a,i+o,!0,!0):t.set(n+a,i+o,!1,!0)}}function Di(t,e){const r=t.size,s=ct.getEncodedBits(e);let n,i,a;for(let o=0;o<18;o++)n=Math.floor(o/3),i=o%3+r-8-3,a=(s>>o&1)===1,t.set(n,i,a,!0),t.set(i,n,a,!0)}function jt(t,e,r){const s=t.size,n=Ni.getEncodedBits(e,r);let i,a;for(i=0;i<15;i++)a=(n>>i&1)===1,i<6?t.set(i,8,a,!0):i<8?t.set(i+1,8,a,!0):t.set(s-15+i,8,a,!0),i<8?t.set(8,s-i-1,a,!0):i<9?t.set(8,15-i-1+1,a,!0):t.set(8,15-i-1,a,!0);t.set(s-8,8,1,!0)}function Li(t,e){const r=t.size;let s=-1,n=r-1,i=7,a=0;for(let o=r-1;o>0;o-=2)for(o===6&&o--;;){for(let l=0;l<2;l++)if(!t.isReserved(n,o-l)){let c=!1;a<e.length&&(c=(e[a]>>>i&1)===1),t.set(n,o-l,c),i--,i===-1&&(a++,i=7)}if(n+=s,n<0||r<=n){n-=s,s=-s;break}}}function Bi(t,e,r){const s=new ji;r.forEach(function(l){s.put(l.mode.bit,4),s.put(l.getLength(),Ii.getCharCountIndicator(l.mode,t)),l.write(s)});const n=vt.getSymbolTotalCodewords(t),i=qt.getTotalCodewordsCount(t,e),a=(n-i)*8;for(s.getLengthInBits()+4<=a&&s.put(0,4);s.getLengthInBits()%8!==0;)s.putBit(0);const o=(a-s.getLengthInBits())/8;for(let l=0;l<o;l++)s.put(l%2?17:236,8);return Mi(s,t,e)}function Mi(t,e,r){const s=vt.getSymbolTotalCodewords(e),n=qt.getTotalCodewordsCount(e,r),i=s-n,a=qt.getBlocksCount(e,r),o=s%a,l=a-o,c=Math.floor(s/a),u=Math.floor(i/a),g=u+1,d=c-u,f=new Oi(d);let p=0;const w=new Array(a),_=new Array(a);let y=0;const v=new Uint8Array(t.buffer);for(let R=0;R<a;R++){const N=R<l?u:g;w[R]=v.slice(p,p+N),_[R]=f.encode(w[R]),p+=N,y=Math.max(y,N)}const m=new Uint8Array(s);let b=0,C,E;for(C=0;C<y;C++)for(E=0;E<a;E++)C<w[E].length&&(m[b++]=w[E][C]);for(C=0;C<d;C++)for(E=0;E<a;E++)m[b++]=_[E][C];return m}function zi(t,e,r,s){let n;if(Array.isArray(t))n=Tt.fromArray(t);else if(typeof t=="string"){let c=e;if(!c){const u=Tt.rawSplit(t);c=ct.getBestVersionForData(u,r)}n=Tt.fromString(t,c||40)}else throw new Error("Invalid data");const i=ct.getBestVersionForData(n,r);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=i;else if(e<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const a=Bi(e,r,n),o=vt.getSymbolSize(e),l=new Ci(o);return Pi(l,e),$i(l),Ui(l,e),jt(l,r,0),e>=7&&Di(l,e),Li(l,a),isNaN(s)&&(s=Ft.getBestMask(l,jt.bind(null,l,r))),Ft.applyMask(s,l),jt(l,r,s),{modules:l,version:e,errorCorrectionLevel:r,maskPattern:s,segments:n}}rs.create=function(e,r){if(typeof e>"u"||e==="")throw new Error("No input text");let s=St.M,n,i;return typeof r<"u"&&(s=St.from(r.errorCorrectionLevel,St.M),n=ct.from(r.version),i=Ft.from(r.maskPattern),r.toSJISFunc&&vt.setToSJISFunction(r.toSJISFunc)),zi(e,n,s,i)};var ps={},lr={};(function(t){function e(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let s=r.slice().replace("#","").split("");if(s.length<3||s.length===5||s.length>8)throw new Error("Invalid hex color: "+r);(s.length===3||s.length===4)&&(s=Array.prototype.concat.apply([],s.map(function(i){return[i,i]}))),s.length===6&&s.push("F","F");const n=parseInt(s.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:n&255,hex:"#"+s.slice(0,6).join("")}}t.getOptions=function(s){s||(s={}),s.color||(s.color={});const n=typeof s.margin>"u"||s.margin===null||s.margin<0?4:s.margin,i=s.width&&s.width>=21?s.width:void 0,a=s.scale||4;return{width:i,scale:i?4:a,margin:n,color:{dark:e(s.color.dark||"#000000ff"),light:e(s.color.light||"#ffffffff")},type:s.type,rendererOpts:s.rendererOpts||{}}},t.getScale=function(s,n){return n.width&&n.width>=s+n.margin*2?n.width/(s+n.margin*2):n.scale},t.getImageWidth=function(s,n){const i=t.getScale(s,n);return Math.floor((s+n.margin*2)*i)},t.qrToImageData=function(s,n,i){const a=n.modules.size,o=n.modules.data,l=t.getScale(a,i),c=Math.floor((a+i.margin*2)*l),u=i.margin*l,g=[i.color.light,i.color.dark];for(let d=0;d<c;d++)for(let f=0;f<c;f++){let p=(d*c+f)*4,w=i.color.light;if(d>=u&&f>=u&&d<c-u&&f<c-u){const _=Math.floor((d-u)/l),y=Math.floor((f-u)/l);w=g[o[_*a+y]?1:0]}s[p++]=w.r,s[p++]=w.g,s[p++]=w.b,s[p]=w.a}}})(lr);(function(t){const e=lr;function r(n,i,a){n.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=a,i.width=a,i.style.height=a+"px",i.style.width=a+"px"}function s(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(i,a,o){let l=o,c=a;typeof l>"u"&&(!a||!a.getContext)&&(l=a,a=void 0),a||(c=s()),l=e.getOptions(l);const u=e.getImageWidth(i.modules.size,l),g=c.getContext("2d"),d=g.createImageData(u,u);return e.qrToImageData(d.data,i,l),r(g,c,u),g.putImageData(d,0,0),c},t.renderToDataURL=function(i,a,o){let l=o;typeof l>"u"&&(!a||!a.getContext)&&(l=a,a=void 0),l||(l={});const c=t.render(i,a,l),u=l.type||"image/png",g=l.rendererOpts||{};return c.toDataURL(u,g.quality)}})(ps);var ms={};const Fi=lr;function br(t,e){const r=t.a/255,s=e+'="'+t.hex+'"';return r<1?s+" "+e+'-opacity="'+r.toFixed(2).slice(1)+'"':s}function Ct(t,e,r){let s=t+e;return typeof r<"u"&&(s+=" "+r),s}function qi(t,e,r){let s="",n=0,i=!1,a=0;for(let o=0;o<t.length;o++){const l=Math.floor(o%e),c=Math.floor(o/e);!l&&!i&&(i=!0),t[o]?(a++,o>0&&l>0&&t[o-1]||(s+=i?Ct("M",l+r,.5+c+r):Ct("m",n,0),n=0,i=!1),l+1<e&&t[o+1]||(s+=Ct("h",a),a=0)):n++}return s}ms.render=function(e,r,s){const n=Fi.getOptions(r),i=e.modules.size,a=e.modules.data,o=i+n.margin*2,l=n.color.light.a?"<path "+br(n.color.light,"fill")+' d="M0 0h'+o+"v"+o+'H0z"/>':"",c="<path "+br(n.color.dark,"stroke")+' d="'+qi(a,i,n.margin)+'"/>',u='viewBox="0 0 '+o+" "+o+'"',d='<svg xmlns="http://www.w3.org/2000/svg" '+(n.width?'width="'+n.width+'" height="'+n.width+'" ':"")+u+' shape-rendering="crispEdges">'+l+c+`</svg>
`;return typeof s=="function"&&s(null,d),d};const Vi=ii,Vt=rs,ws=ps,Hi=ms;function cr(t,e,r,s,n){const i=[].slice.call(arguments,1),a=i.length,o=typeof i[a-1]=="function";if(!o&&!Vi())throw new Error("Callback required as last argument");if(o){if(a<2)throw new Error("Too few arguments provided");a===2?(n=r,r=e,e=s=void 0):a===3&&(e.getContext&&typeof n>"u"?(n=s,s=void 0):(n=s,s=r,r=e,e=void 0))}else{if(a<1)throw new Error("Too few arguments provided");return a===1?(r=e,e=s=void 0):a===2&&!e.getContext&&(s=r,r=e,e=void 0),new Promise(function(l,c){try{const u=Vt.create(r,s);l(t(u,e,s))}catch(u){c(u)}})}try{const l=Vt.create(r,s);n(null,t(l,e,s))}catch(l){n(l)}}Ne.create=Vt.create;Ne.toCanvas=cr.bind(null,ws.render);Ne.toDataURL=cr.bind(null,ws.renderToDataURL);Ne.toString=cr.bind(null,function(t,e,r){return Hi.render(t,r)});function Ki(t){return M({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M2 22l14-5-9-9zM14.53 12.53l5.59-5.59a1.25 1.25 0 011.77 0l.59.59 1.06-1.06-.59-.59a2.758 2.758 0 00-3.89 0l-5.59 5.59 1.06 1.06zM10.06 6.88l-.59.59 1.06 1.06.59-.59a2.758 2.758 0 000-3.89l-.59-.59-1.06 1.07.59.59c.48.48.48 1.28 0 1.76zM17.06 11.88l-1.59 1.59 1.06 1.06 1.59-1.59a1.25 1.25 0 011.77 0l1.61 1.61 1.06-1.06-1.61-1.61a2.758 2.758 0 00-3.89 0zM15.06 5.88l-3.59 3.59 1.06 1.06 3.59-3.59a2.758 2.758 0 000-3.89l-1.59-1.59-1.06 1.06 1.59 1.59c.48.49.48 1.29 0 1.77z"}}]})(t)}function Wi(t){return M({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M122.7 23.32l1.7 21.87-16.7 14.25 21.4 5.17 8.4 20.25L149 66.18l21.8-1.75-14.2-16.71 5.1-21.32-20.3 8.35-18.7-11.43zM464 32a16 16 0 0 0-16 16 16 16 0 0 0 16 16 16 16 0 0 0 16-16 16 16 0 0 0-16-16zM239.8 42.5a16 16 0 0 0-16 16 16 16 0 0 0 16 16 16 16 0 0 0 16-16 16 16 0 0 0-16-16zm183.9 6.84c-9.2 1.74-17.7 7.18-25.9 14.28-7.6 6.53-14.7 14.66-20.7 23.45-18.8 3.01-37.6 10.67-50.2 21.13-16.1 13.2-30.4 35.8-38.2 59.1-7.4 3.1-14.4 6.8-20.1 10.8-15.5 10.9-23.5 31.8-29.4 50-5.9 18.3-8.8 34.3-8.8 34.3l17.8 3.2s2.7-15 8.1-31.9c5.5-16.9 14.8-35.3 22.7-40.8 1.3-.9 3-1.9 4.5-2.8-.6 5.7-.6 11.4.3 16.8 1.8 11.4 8 22.3 19 28.2 7.8 4.2 16.6 3.2 24 .2 7.4-3.1 14-8.2 19.7-14.2 5.7-6 10.4-13.1 13.2-20.6 2.8-7.5 3.8-16 .2-23.9h-.1c-3.9-8.4-11.4-13.8-19.4-16.1-8-2.3-16.6-2.2-25.2-.9-1.5.2-2.9.7-4.4 1 7.4-15.8 18-30.7 27.5-38.6 6.2-5.1 16.6-10 27.7-13.6-1.4 3.8-2.5 7.6-3 11.5-1.6 10.5.7 21.9 9.1 29.7 6.1 5.6 14.3 6.5 21.5 5.3 7.1-1.2 14-4.4 20.2-8.5 6.2-4.2 11.7-9.4 15.6-15.5 3.9-6.1 6.5-13.9 4-21.7v-.1c-3.3-10.07-11.5-16.99-20.6-20.27-3.9-1.4-8-2.19-12.2-2.66 2.9-3.26 5.9-6.31 8.9-8.92 6.8-5.84 13.7-9.5 17.6-10.23l-3.4-17.68zM174.8 84.39l-15.2 9.56 34.5 55.25-56.4 2.9 26.5 57.8 16.4-7.6-15.5-33.6 60.6-3.1-50.9-81.21zm216.4 19.31c6.1-.1 11.5.6 15.5 2.1 5.4 1.9 8.1 4.3 9.5 8.8.4 1.1.2 3.3-1.9 6.6-2.2 3.4-6.1 7.2-10.5 10.2-4.5 3-9.5 5.1-13.2 5.7-3.8.7-5.5 0-6.3-.7-3.5-3.2-4.5-7.2-3.5-13.9.8-5.4 3.3-11.9 7-18.6 1.2 0 2.3-.2 3.4-.2zM94.99 123a16 16 0 0 0-16 16 16 16 0 0 0 16 16A16 16 0 0 0 111 139a16 16 0 0 0-16.01-16zm356.11 37.2l-14.4 16.6-21.8-1.8 11.4 18.8-8.5 20.2 21.4-5 16.6 14.3 1.9-21.9 18.7-11.4-20.2-8.5-5.1-21.3zm-123.5 16.5c2.9.1 5.6.5 7.7 1.1 4.3 1.2 6.6 3 8.2 6.4.9 1.9 1 5.4-.7 10-1.7 4.7-5.2 10.1-9.4 14.6s-9.3 8.1-13.5 9.8c-4.2 1.7-6.8 1.6-8.5.7h-.1c-5.8-3.2-8.6-7.8-9.7-15.2-1-6.3-.3-14.3 1.8-22.9 4.9-1.7 9.8-3.1 14.5-3.8 3.5-.5 6.7-.7 9.7-.7zm-202.4 51.9c-7.2-.2-11.7 1.5-14.5 4.3-2.8 2.8-4.5 7.3-4.3 14.5.2 7.3 2.6 16.9 7.2 27.6 9.2 21.5 27.3 47.4 51.6 71.8 24.3 24.3 50.3 42.3 71.8 51.5 10.6 4.6 20.2 7 27.5 7.2 7.3.3 11.7-1.5 14.5-4.3 2.8-2.8 4.6-7.2 4.3-14.5-.2-7.3-2.6-16.9-7.2-27.6-9.2-21.4-27.2-47.4-51.5-71.7-24.3-24.4-50.3-42.4-71.8-51.6-10.7-4.6-20.3-7-27.6-7.2zm232 31.3l-33 54-29.1-27.9-12.4 13 45.1 43.3 33.8-55.2 38.7 32.3 89.3-38.2-7-16.6-79.3 34-46.1-38.7zM93.43 272.6l-17.64 57.9c41.41 49.1 89.71 76.7 142.11 94.7l21.6-6.6c-3.1-1.1-6.4-2.4-9.7-3.8-24.4-10.4-51.7-29.6-77.3-55.3-25.7-25.7-44.9-53-55.34-77.4-1.41-3.2-2.65-6.4-3.73-9.5zm-23.82 78.2l-14.01 46c28.89 27 59 39.2 90.6 50.2l43.4-13.2c-43.2-17.6-84-43.3-119.99-83zM368 352a16 16 0 0 0-16 16 16 16 0 0 0 16 16 16 16 0 0 0 16-16 16 16 0 0 0-16-16zM49.81 415.9l-20.29 66.6 88.28-26.9c-22.77-9.1-45.78-20.7-67.99-39.7z"}}]})(t)}function Ji(t){return M({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M23 7a8.44 8.44 0 0 0-5 1.31c-.36-.41-.73-.82-1.12-1.21l-.29-.27.14-.12a3.15 3.15 0 0 0 .9-3.49A3.9 3.9 0 0 0 14 1v2a2 2 0 0 1 1.76 1c.17.4 0 .84-.47 1.31l-.23.21a16.71 16.71 0 0 0-3.41-2.2c-2.53-1.14-3.83-.61-4.47 0a2.18 2.18 0 0 0-.46.68l-.18.53L5.1 8.87C6.24 11.71 9 16.76 15 18.94l5-1.66a1 1 0 0 0 .43-.31l.21-.18c1.43-1.44.51-4.21-1.41-6.9A6.63 6.63 0 0 1 23 9zm-3.79 8.37h-.06c-.69.37-3.55-.57-6.79-3.81-.34-.34-.66-.67-.95-1-.1-.11-.19-.23-.29-.35l-.53-.64-.28-.39c-.14-.19-.28-.38-.4-.56s-.16-.26-.24-.39-.22-.34-.31-.51-.13-.24-.19-.37-.17-.28-.23-.42-.09-.23-.14-.34-.11-.27-.15-.4S8.6 6 8.58 5.9s-.06-.24-.08-.34a2 2 0 0 1 0-.24 1.15 1.15 0 0 1 0-.26l.11-.31c.17-.18.91-.23 2.23.37a13.83 13.83 0 0 1 2.49 1.54A4.17 4.17 0 0 1 12 7v2a6.43 6.43 0 0 0 3-.94l.49.46c.44.43.83.86 1.19 1.27A5.31 5.31 0 0 0 16 13.2l2-.39a3.23 3.23 0 0 1 0-1.14c1.29 1.97 1.53 3.39 1.21 3.7zM4.4 11l-2.23 6.7A3.28 3.28 0 0 0 5.28 22a3.21 3.21 0 0 0 1-.17l6.52-2.17A18.7 18.7 0 0 1 4.4 11z"}}]})(t)}const Gi={FaBirthdayCake:Hn,GiPartyPopper:Wi,FaGift:Kn,FaHourglassHalf:nr,FaHeart:Wn,FaRocket:Xn,MdCelebration:Ki,FaSnowman:ti,BiSolidParty:Ji},Ht=({iconKey:t="FaHourglassHalf",color:e="currentColor",size:r="1.5em",className:s="",animate:n=!1})=>{const i=Gi[t]||nr;return h.jsx("div",{className:`inline-flex items-center justify-center ${n?"animate-float":""} ${s}`,children:h.jsx(i,{style:{color:e,fontSize:r}})})},Yi=()=>[{name:"Pastel",key:"FaBirthdayCake",type:"birthday"},{name:"Fiesta",key:"GiPartyPopper",type:"party"},{name:"Regalo",key:"FaGift",type:"gift"},{name:"Reloj",key:"FaHourglassHalf",type:"hourglass"},{name:"Corazón",key:"FaHeart",type:"love"},{name:"Cohete",key:"FaRocket",type:"rocket"},{name:"Celebración",key:"MdCelebration",type:"celebration"},{name:"Navidad",key:"FaSnowman",type:"christmas"},{name:"Evento",key:"BiSolidParty",type:"event"}];function bt(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r}function Qi(t,e,r,s){function n(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(g){a(g)}}function l(u){try{c(s.throw(u))}catch(g){a(g)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(t,e||[])).next())})}const Zi=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class ur extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class Xi extends ur{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class _r extends ur{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class xr extends ur{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Kt;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Kt||(Kt={}));class ea{constructor(e,{headers:r={},customFetch:s,region:n=Kt.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=Zi(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Qi(this,arguments,void 0,function*(r,s={}){var n;let i,a;try{const{headers:o,method:l,body:c,signal:u,timeout:g}=s;let d={},{region:f}=s;f||(f=this.region);const p=new URL(`${this.url}/${r}`);f&&f!=="any"&&(d["x-region"]=f,p.searchParams.set("forceFunctionRegion",f));let w;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",w=c):typeof c=="string"?(d["Content-Type"]="text/plain",w=c):typeof FormData<"u"&&c instanceof FormData?w=c:(d["Content-Type"]="application/json",w=JSON.stringify(c)):w=c;let _=u;g&&(a=new AbortController,i=setTimeout(()=>a.abort(),g),u?(_=a.signal,u.addEventListener("abort",()=>a.abort())):_=a.signal);const y=yield this.fetch(p.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),o),body:w,signal:_}).catch(C=>{throw new Xi(C)}),v=y.headers.get("x-relay-error");if(v&&v==="true")throw new _r(y);if(!y.ok)throw new xr(y);let m=((n=y.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),b;return m==="application/json"?b=yield y.json():m==="application/octet-stream"||m==="application/pdf"?b=yield y.blob():m==="text/event-stream"?b=y:m==="multipart/form-data"?b=yield y.formData():b=yield y.text(),{data:b,error:null,response:y}}catch(o){return{data:null,error:o,response:o instanceof xr||o instanceof _r?o.context:void 0}}finally{i&&clearTimeout(i)}})}}var ta=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},ra=class{constructor(t){var e,r;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(r=t.isMaybeSingle)!==null&&r!==void 0?r:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let a=null,o=null,l=null,c=i.status,u=i.statusText;if(i.ok){var g,d;if(r.method!=="HEAD"){var f;const y=await i.text();y===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((f=r.headers.get("Accept"))===null||f===void 0)&&f.includes("application/vnd.pgrst.plan+text"))?o=y:o=JSON.parse(y))}const w=(g=r.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),_=(d=i.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");w&&_&&_.length>1&&(l=parseInt(_[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(a={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,c=406,u="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var p;const w=await i.text();try{a=JSON.parse(w),Array.isArray(a)&&i.status===404&&(o=[],a=null,c=200,u="OK")}catch{i.status===404&&w===""?(c=204,u="No Content"):a={message:w}}if(a&&r.isMaybeSingle&&(!(a==null||(p=a.details)===null||p===void 0)&&p.includes("0 rows"))&&(a=null,c=200,u="OK"),a&&r.shouldThrowOnError)throw new ta(a)}return{error:a,data:o,count:l,status:c,statusText:u}});return this.shouldThrowOnError||(n=n.catch(i=>{var a;let o="";const l=i==null?void 0:i.cause;if(l){var c,u,g,d;const p=(c=l==null?void 0:l.message)!==null&&c!==void 0?c:"",w=(u=l==null?void 0:l.code)!==null&&u!==void 0?u:"";o=`${(g=i==null?void 0:i.name)!==null&&g!==void 0?g:"FetchError"}: ${i==null?void 0:i.message}`,o+=`

Caused by: ${(d=l==null?void 0:l.name)!==null&&d!==void 0?d:"Error"}: ${p}`,w&&(o+=` (${w})`),l!=null&&l.stack&&(o+=`
${l.stack}`)}else{var f;o=(f=i==null?void 0:i.stack)!==null&&f!==void 0?f:""}return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),n.then(t,e)}returns(){return this}overrideTypes(){return this}},sa=class extends ra{select(t){let e=!1;const r=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:s,referencedTable:n=s}={}){const i=n?`${n}.order`:"order",a=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${a?`${a},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:r=e}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:r,referencedTable:s=r}={}){const n=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${t}`),this.url.searchParams.set(i,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:s=!1,wal:n=!1,format:i="text"}={}){var a;const o=[t?"analyze":null,e?"verbose":null,r?"settings":null,s?"buffers":null,n?"wal":null].filter(Boolean).join("|"),l=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${o};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Er=new RegExp("[,()]");var je=class extends sa{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const r=Array.from(new Set(e)).map(s=>typeof s=="string"&&Er.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}notIn(t,e){const r=Array.from(new Set(e)).map(s=>typeof s=="string"&&Er.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`not.in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:s}={}){let n="";s==="plain"?n="pl":s==="phrase"?n="ph":s==="websearch"&&(n="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${n}fts${i}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e,referencedTable:r=e}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}},na=class{constructor(t,{headers:e={},schema:r,fetch:s}){this.url=t,this.headers=new Headers(e),this.schema=r,this.fetch=s}select(t,e){const{head:r=!1,count:s}=e??{},n=r?"HEAD":"GET";let i=!1;const a=(t??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),s&&this.headers.append("Prefer",`count=${s}`),new je({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:r=!0}={}){var s;const n="POST";if(e&&this.headers.append("Prefer",`count=${e}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((a,o)=>a.concat(Object.keys(o)),[]);if(i.length>0){const a=[...new Set(i)].map(o=>`"${o}"`);this.url.searchParams.set("columns",a.join(","))}}return new je({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:s,defaultToNull:n=!0}={}){var i;const a="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),s&&this.headers.append("Prefer",`count=${s}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new je({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:e}={}){var r;const s="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new je({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:t}={}){var e;const r="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new je({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},ia=class ys{constructor(e,{headers:r={},schema:s,fetch:n}={}){this.url=e,this.headers=new Headers(r),this.schemaName=s,this.fetch=n}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new na(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new ys(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:s=!1,get:n=!1,count:i}={}){var a;let o;const l=new URL(`${this.url}/rpc/${e}`);let c;s||n?(o=s?"HEAD":"GET",Object.entries(r).filter(([g,d])=>d!==void 0).map(([g,d])=>[g,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([g,d])=>{l.searchParams.append(g,d)})):(o="POST",c=r);const u=new Headers(this.headers);return i&&u.set("Prefer",`count=${i}`),new je({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};class aa{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,n=parseInt(s.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const s=this.getWebSocketConstructor();return new s(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const oa="2.89.0",la=`realtime-js/${oa}`,vs="1.0.0",ca="2.0.0",kr=vs,Wt=1e4,ua=1e3,ha=100;var ie;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(ie||(ie={}));var L;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(L||(L={}));var Z;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Z||(Z={}));var Jt;(function(t){t.websocket="websocket"})(Jt||(Jt={}));var me;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(me||(me={}));class da{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,s;const n=(s=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var r,s;const n=(s=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:{},a=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(e,r,s){var n,i;const a=e.topic,o=(n=e.ref)!==null&&n!==void 0?n:"",l=(i=e.join_ref)!==null&&i!==void 0?i:"",c=e.payload.event,u=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},g=Object.keys(u).length===0?"":JSON.stringify(u);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`topic length ${a.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(g.length>255)throw new Error(`metadata length ${g.length} exceeds maximum of 255`);const d=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+o.length+a.length+c.length+g.length,f=new ArrayBuffer(this.HEADER_LENGTH+d);let p=new DataView(f),w=0;p.setUint8(w++,this.KINDS.userBroadcastPush),p.setUint8(w++,l.length),p.setUint8(w++,o.length),p.setUint8(w++,a.length),p.setUint8(w++,c.length),p.setUint8(w++,g.length),p.setUint8(w++,r),Array.from(l,y=>p.setUint8(w++,y.charCodeAt(0))),Array.from(o,y=>p.setUint8(w++,y.charCodeAt(0))),Array.from(a,y=>p.setUint8(w++,y.charCodeAt(0))),Array.from(c,y=>p.setUint8(w++,y.charCodeAt(0))),Array.from(g,y=>p.setUint8(w++,y.charCodeAt(0)));var _=new Uint8Array(f.byteLength+s.byteLength);return _.set(new Uint8Array(f),0),_.set(new Uint8Array(s),f.byteLength),_.buffer}decode(e,r){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return r(s)}if(typeof e=="string"){const s=JSON.parse(e),[n,i,a,o,l]=s;return r({join_ref:n,ref:i,topic:a,event:o,payload:l})}return r({})}_binaryDecode(e){const r=new DataView(e),s=r.getUint8(0),n=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,n)}}_decodeUserBroadcast(e,r,s){const n=r.getUint8(1),i=r.getUint8(2),a=r.getUint8(3),o=r.getUint8(4);let l=this.HEADER_LENGTH+4;const c=s.decode(e.slice(l,l+n));l=l+n;const u=s.decode(e.slice(l,l+i));l=l+i;const g=s.decode(e.slice(l,l+a));l=l+a;const d=e.slice(l,e.byteLength),f=o===this.JSON_ENCODING?JSON.parse(s.decode(d)):d,p={type:this.BROADCAST_EVENT,event:u,payload:f};return a>0&&(p.meta=JSON.parse(g)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e==null?void 0:e.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>r.includes(s)))}}class bs{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var O;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(O||(O={}));const Sr=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((i,a)=>(i[a]=fa(a,t,e,n),i),{}):{}},fa=(t,e,r,s)=>{const n=e.find(o=>o.name===t),i=n==null?void 0:n.type,a=r[t];return i&&!s.includes(i)?_s(i,a):Gt(a)},_s=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return wa(e,r)}switch(t){case O.bool:return ga(e);case O.float4:case O.float8:case O.int2:case O.int4:case O.int8:case O.numeric:case O.oid:return pa(e);case O.json:case O.jsonb:return ma(e);case O.timestamp:return ya(e);case O.abstime:case O.date:case O.daterange:case O.int4range:case O.int8range:case O.money:case O.reltime:case O.text:case O.time:case O.timestamptz:case O.timetz:case O.tsrange:case O.tstzrange:return Gt(e);default:return Gt(e)}},Gt=t=>t,ga=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},pa=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},ma=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},wa=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let i;const a=t.slice(1,r);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>_s(e,o))}return t},ya=t=>typeof t=="string"?t.replace(" ","T"):t,xs=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Rt{constructor(e,r,s={},n=Wt){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Tr;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Tr||(Tr={}));class Me{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Me.syncState(this.state,n,i,a),this.pendingDiffs.forEach(l=>{this.state=Me.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Me.syncDiff(this.state,n,i,a),o())}),this.onJoin((n,i,a)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:a})}),this.onLeave((n,i,a)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const i=this.cloneDeep(e),a=this.transformState(r),o={},l={};return this.map(i,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const g=i[c];if(g){const d=u.map(_=>_.presence_ref),f=g.map(_=>_.presence_ref),p=u.filter(_=>f.indexOf(_.presence_ref)<0),w=g.filter(_=>d.indexOf(_.presence_ref)<0);p.length>0&&(o[c]=p),w.length>0&&(l[c]=w)}else o[c]=u}),this.syncDiff(i,{joins:o,leaves:l},s,n)}static syncDiff(e,r,s,n){const{joins:i,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(o,l)=>{var c;const u=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),u.length>0){const g=e[o].map(f=>f.presence_ref),d=u.filter(f=>g.indexOf(f.presence_ref)<0);e[o].unshift(...d)}s(o,u,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const u=l.map(g=>g.presence_ref);c=c.filter(g=>u.indexOf(g.presence_ref)<0),e[o]=c,n(o,c,l),c.length===0&&delete e[o]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var jr;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(jr||(jr={}));var ze;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(ze||(ze={}));var re;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(re||(re={}));class Ae{constructor(e,r={config:{}},s){var n,i;if(this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=L.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Rt(this,Z.join,this.params,this.timeout),this.rejoinTimer=new bs(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=L.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=L.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=L.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=L.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=L.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Z.reply,{},(a,o)=>{this._trigger(this._replyEventName(o),a)}),this.presence=new Me(this),this.broadcastEndpointURL=xs(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var s,n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==L.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,c=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(f=>f.filter))!==null&&n!==void 0?n:[],u=!!this.bindings[ze.PRESENCE]&&this.bindings[ze.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,g={},d={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(f=>e==null?void 0:e(re.CHANNEL_ERROR,f)),this._onClose(()=>e==null?void 0:e(re.CLOSED)),this.updateJoinPayload(Object.assign({config:d},g)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:f})=>{var p;if(this.socket._isManualToken()||this.socket.setAuth(),f===void 0){e==null||e(re.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,_=(p=w==null?void 0:w.length)!==null&&p!==void 0?p:0,y=[];for(let v=0;v<_;v++){const m=w[v],{filter:{event:b,schema:C,table:E,filter:R}}=m,N=f&&f[v];if(N&&N.event===b&&Ae.isFilterValueEqual(N.schema,C)&&Ae.isFilterValueEqual(N.table,E)&&Ae.isFilterValueEqual(N.filter,R))y.push(Object.assign(Object.assign({},m),{id:N.id}));else{this.unsubscribe(),this.state=L.errored,e==null||e(re.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(re.SUBSCRIBED);return}}).receive("error",f=>{this.state=L.errored,e==null||e(re.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(re.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this.state===L.joined&&e===ze.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,r,s)}async httpSend(e,r,s={}){var n;if(r==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const c=await o.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:a}=e,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const c=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=L.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Z.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new Rt(this,Z.leave,{},e),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=L.closed,this.bindings={}}async _fetchWithTimeout(e,r,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(i),a}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Rt(this,e,r,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>ha){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Z;if(s&&[o,l,c,u].indexOf(a)>=0&&s!==this._joinRef())return;let d=this._onMessage(a,r,s);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var p,w,_;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((_=(w=f.filter)===null||w===void 0?void 0:w.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===a}).map(f=>f.callback(d,s)):(i=this.bindings[a])===null||i===void 0||i.filter(f=>{var p,w,_,y,v,m;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in f){const b=f.id,C=(p=f.filter)===null||p===void 0?void 0:p.event;return b&&((w=r.ids)===null||w===void 0?void 0:w.includes(b))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((_=r.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const b=(v=(y=f==null?void 0:f.filter)===null||y===void 0?void 0:y.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return b==="*"||b===((m=r==null?void 0:r.event)===null||m===void 0?void 0:m.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===a}).map(f=>{if(typeof d=="object"&&"ids"in d){const p=d.data,{schema:w,table:_,commit_timestamp:y,type:v,errors:m}=p;d=Object.assign(Object.assign({},{schema:w,table:_,commit_timestamp:y,eventType:v,new:{},old:{},errors:m}),this._getPayloadRecords(p))}f.callback(d,s)})}_isClosed(){return this.state===L.closed}_isJoined(){return this.state===L.joined}_isJoining(){return this.state===L.joining}_isLeaving(){return this.state===L.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),i={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Ae.isEqual(n.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}static isFilterValueEqual(e,r){return(e??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Z.close,{},e)}_onError(e){this._on(Z.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=L.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Sr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Sr(e.columns,e.old_record)),r}}const At=()=>{},tt={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},va=[1e3,2e3,5e3,1e4],ba=1e4,_a=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class xa{constructor(e,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Wt,this.transport=null,this.heartbeatIntervalMs=tt.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=At,this.ref=0,this.reconnectTimer=null,this.vsn=kr,this.logger=At,this.conn=null,this.sendBuffer=[],this.serializer=new da,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...i)=>n(...i):(...i)=>fetch(...i),!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Jt.websocket}`,this.httpEndpoint=xs(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=aa.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case ie.connecting:return me.Connecting;case ie.open:return me.Open;case ie.closing:return me.Closing;default:return me.Closed}}isConnected(){return this.connectionState()===me.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===s);if(n)return n;{const i=new Ae(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:s,payload:n,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${s} (${i})`,n),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(ua,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},tt.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:n,payload:i,ref:a}=r,o=a?`(${a})`:"",l=i.status||"";this.log("receive",`${l} ${s} ${n} ${o}`.trim(),i),this.channels.filter(c=>c._isMember(s)).forEach(c=>c._trigger(n,i,a)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===ie.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===ie.open||this.conn.readyState===ie.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Z.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([_a],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r,s=!1;if(e)r=e,s=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),r=this.accessTokenValue}else r=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:la};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(Z.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(r)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new bs(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},tt.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,s,n,i,a,o,l,c,u,g,d,f;switch(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:Wt,this.heartbeatIntervalMs=(n=e==null?void 0:e.heartbeatIntervalMs)!==null&&n!==void 0?n:tt.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=e==null?void 0:e.heartbeatCallback)!==null&&o!==void 0?o:At,this.vsn=(l=e==null?void 0:e.vsn)!==null&&l!==void 0?l:kr,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:p=>va[p-1]||ba,this.vsn){case vs:this.encode=(u=e==null?void 0:e.encode)!==null&&u!==void 0?u:(p,w)=>w(JSON.stringify(p)),this.decode=(g=e==null?void 0:e.decode)!==null&&g!==void 0?g:(p,w)=>w(JSON.parse(p));break;case ca:this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:this.serializer.encode.bind(this.serializer),this.decode=(f=e==null?void 0:e.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var qe=class extends Error{constructor(t,e){var r;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((r=e.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Ea(t,e,r){const s=new URL(e,t);if(r)for(const[n,i]of Object.entries(r))i!==void 0&&s.searchParams.set(n,i);return s.toString()}async function ka(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function Sa(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:n,body:i,headers:a}){const o=Ea(t.baseUrl,s,n),l=await ka(t.auth),c=await e(o,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...l,...a},body:i?JSON.stringify(i):void 0}),u=await c.text(),g=(c.headers.get("content-type")||"").includes("application/json"),d=g&&u?JSON.parse(u):u;if(!c.ok){const f=g?d:void 0,p=f==null?void 0:f.error;throw new qe((p==null?void 0:p.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:p==null?void 0:p.type,icebergCode:p==null?void 0:p.code,details:f})}return{status:c.status,headers:c.headers,data:d}}}}function rt(t){return t.join("")}var Ta=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:rt(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${rt(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${rt(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${rt(t.namespace)}`}),!0}catch(e){if(e instanceof qe&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof qe&&r.status===409)return;throw r}}};function _e(t){return t.join("")}var ja=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${_e(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${_e(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${_e(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${_e(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${_e(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${_e(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof qe&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof qe&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},Ca=class{constructor(t){var s;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=Sa({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(s=t.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new Ta(this.client,e),this.tableOps=new ja(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},_t=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function P(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var Ra=class extends _t{constructor(t,e,r){super(t),this.name="StorageApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Yt=class extends _t{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const hr=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Aa=()=>Response,Qt=t=>{if(Array.isArray(t))return t.map(r=>Qt(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=Qt(s)}),e},Oa=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Na=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Ve(t){"@babel/helpers - typeof";return Ve=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ve(t)}function Ia(t,e){if(Ve(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(Ve(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pa(t){var e=Ia(t,"string");return Ve(e)=="symbol"?e:e+""}function $a(t,e,r){return(e=Pa(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function T(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cr(Object(r),!0).forEach(function(s){$a(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Cr(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}const Ot=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},Ua=async(t,e,r)=>{t instanceof await Aa()&&!(r!=null&&r.noResolveJson)?t.json().then(s=>{const n=t.status||500,i=(s==null?void 0:s.statusCode)||n+"";e(new Ra(Ot(s),n,i))}).catch(s=>{e(new Yt(Ot(s),s))}):e(new Yt(Ot(t),t))},Da=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?n:(Oa(s)?(n.headers=T({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,e!=null&&e.duplex&&(n.duplex=e.duplex),T(T({},n),r))};async function Qe(t,e,r,s,n,i){return new Promise((a,o)=>{t(r,Da(e,s,n,i)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>Ua(l,o,s))})}async function He(t,e,r,s){return Qe(t,"GET",e,r,s)}async function Q(t,e,r,s,n){return Qe(t,"POST",e,s,n,r)}async function Zt(t,e,r,s,n){return Qe(t,"PUT",e,s,n,r)}async function La(t,e,r,s){return Qe(t,"HEAD",e,T(T({},r),{},{noResolveJson:!0}),s)}async function dr(t,e,r,s,n){return Qe(t,"DELETE",e,s,n,r)}var Ba=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(P(e))return{data:null,error:e};throw e}}};let Es;Es=Symbol.toStringTag;var Ma=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[Es]="BlobDownloadBuilder",this.promise=null}asStream(){return new Ba(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(P(e))return{data:null,error:e};throw e}}};const za={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Rr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Fa=class{constructor(t,e={},r,s){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=r,this.fetch=hr(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,r,s){var n=this;try{let i;const a=T(T({},Rr),s);let o=T(T({},n.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",n.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",a.cacheControl),l&&!i.has("metadata")&&i.append("metadata",n.encodeMetadata(l))):(i=r,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=n.toBase64(n.encodeMetadata(l))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!a.duplex&&(a.duplex="half")),s!=null&&s.headers&&(o=T(T({},o),s.headers));const c=n._removeEmptyFolders(e),u=n._getFinalPath(c),g=await(t=="PUT"?Zt:Q)(n.fetch,`${n.url}/object/${u}`,i,T({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:c,id:g.Id,fullPath:g.Key},error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(P(i))return{data:null,error:i};throw i}}async upload(t,e,r){return this.uploadOrUpdate("POST",t,e,r)}async uploadToSignedUrl(t,e,r,s){var n=this;const i=n._removeEmptyFolders(t),a=n._getFinalPath(i),o=new URL(n.url+`/object/upload/sign/${a}`);o.searchParams.set("token",e);try{let l;const c=T({upsert:Rr.upsert},s),u=T(T({},n.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType),{data:{path:i,fullPath:(await Zt(n.fetch,o.toString(),l,{headers:u})).Key},error:null}}catch(l){if(n.shouldThrowOnError)throw l;if(P(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(t,e){var r=this;try{let s=r._getFinalPath(t);const n=T({},r.headers);e!=null&&e.upsert&&(n["x-upsert"]="true");const i=await Q(r.fetch,`${r.url}/object/upload/sign/${s}`,{},{headers:n}),a=new URL(r.url+i.url),o=a.searchParams.get("token");if(!o)throw new _t("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:o},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(P(s))return{data:null,error:s};throw s}}async update(t,e,r){return this.uploadOrUpdate("PUT",t,e,r)}async move(t,e,r){var s=this;try{return{data:await Q(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(P(n))return{data:null,error:n};throw n}}async copy(t,e,r){var s=this;try{return{data:{path:(await Q(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:s.headers})).Key},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(P(n))return{data:null,error:n};throw n}}async createSignedUrl(t,e,r){var s=this;try{let n=s._getFinalPath(t),i=await Q(s.fetch,`${s.url}/object/sign/${n}`,T({expiresIn:e},r!=null&&r.transform?{transform:r.transform}:{}),{headers:s.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${s.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(P(n))return{data:null,error:n};throw n}}async createSignedUrls(t,e,r){var s=this;try{const n=await Q(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:t},{headers:s.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(a=>T(T({},a),{},{signedUrl:a.signedURL?encodeURI(`${s.url}${a.signedURL}${i}`):null})),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(P(n))return{data:null,error:n};throw n}}download(t,e){const r=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),n=s?`?${s}`:"",i=this._getFinalPath(t),a=()=>He(this.fetch,`${this.url}/${r}/${i}${n}`,{headers:this.headers,noResolveJson:!0});return new Ma(a,this.shouldThrowOnError)}async info(t){var e=this;const r=e._getFinalPath(t);try{return{data:Qt(await He(e.fetch,`${e.url}/object/info/${r}`,{headers:e.headers})),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(P(s))return{data:null,error:s};throw s}}async exists(t){var e=this;const r=e._getFinalPath(t);try{return await La(e.fetch,`${e.url}/object/${r}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(P(s)&&s instanceof Yt){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}}getPublicUrl(t,e){const r=this._getFinalPath(t),s=[],n=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";n!==""&&s.push(n);const i=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});a!==""&&s.push(a);let o=s.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${o}`)}}}async remove(t){var e=this;try{return{data:await dr(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(P(r))return{data:null,error:r};throw r}}async list(t,e,r){var s=this;try{const n=T(T(T({},za),e),{},{prefix:t||""});return{data:await Q(s.fetch,`${s.url}/object/list/${s.bucketId}`,n,{headers:s.headers},r),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(P(n))return{data:null,error:n};throw n}}async listV2(t,e){var r=this;try{const s=T({},t);return{data:await Q(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,s,{headers:r.headers},e),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(P(s))return{data:null,error:s};throw s}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const ks="2.89.0",Ss={"X-Client-Info":`storage-js/${ks}`};var qa=class{constructor(t,e={},r,s){this.shouldThrowOnError=!1;const n=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase.")),this.url=n.href.replace(/\/$/,""),this.headers=T(T({},Ss),e),this.fetch=hr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const r=e.listBucketOptionsToQueryString(t);return{data:await He(e.fetch,`${e.url}/bucket${r}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(P(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await He(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(P(r))return{data:null,error:r};throw r}}async createBucket(t,e={public:!1}){var r=this;try{return{data:await Q(r.fetch,`${r.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(P(s))return{data:null,error:s};throw s}}async updateBucket(t,e){var r=this;try{return{data:await Zt(r.fetch,`${r.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(P(s))return{data:null,error:s};throw s}}async emptyBucket(t){var e=this;try{return{data:await Q(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(P(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await dr(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(P(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},Va=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=T(T({},Ss),e),this.fetch=hr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await Q(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(P(r))return{data:null,error:r};throw r}}async listBuckets(t){var e=this;try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const s=r.toString(),n=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return{data:await He(e.fetch,n,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(P(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await dr(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(P(r))return{data:null,error:r};throw r}}from(t){var e=this;if(!Na(t))throw new _t("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new Ca({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(n,i){const a=n[i];return typeof a!="function"?a:async(...o)=>{try{return{data:await a.apply(n,o),error:null}}catch(l){if(s)throw l;return{data:null,error:l}}}}})}};const fr={"X-Client-Info":`storage-js/${ks}`,"Content-Type":"application/json"};var Ts=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function H(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var Nt=class extends Ts{constructor(t,e,r){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Ha=class extends Ts{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const gr=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Ka=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Ar=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Wa=async(t,e,r)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(r!=null&&r.noResolveJson)){const s=t.status||500,n=t;if(typeof n.json=="function")n.json().then(i=>{const a=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||s+"";e(new Nt(Ar(i),s,a))}).catch(()=>{const i=s+"";e(new Nt(n.statusText||`HTTP ${s} error`,s,i))});else{const i=s+"";e(new Nt(n.statusText||`HTTP ${s} error`,s,i))}}else e(new Ha(Ar(t),t))},Ja=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return s?(Ka(s)?(n.headers=T({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,T(T({},n),r)):n};async function Ga(t,e,r,s,n,i){return new Promise((a,o)=>{t(r,Ja(e,s,n,i)).then(l=>{if(!l.ok)throw l;if(s!=null&&s.noResolveJson)return l;const c=l.headers.get("content-type");return!c||!c.includes("application/json")?{}:l.json()}).then(l=>a(l)).catch(l=>Wa(l,o,s))})}async function K(t,e,r,s,n){return Ga(t,"POST",e,s,n,r)}var Ya=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=T(T({},fr),e),this.fetch=gr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await K(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(H(r))return{data:null,error:r};throw r}}async getIndex(t,e){var r=this;try{return{data:await K(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(H(s))return{data:null,error:s};throw s}}async listIndexes(t){var e=this;try{return{data:await K(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(H(r))return{data:null,error:r};throw r}}async deleteIndex(t,e){var r=this;try{return{data:await K(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers})||{},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(H(s))return{data:null,error:s};throw s}}},Qa=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=T(T({},fr),e),this.fetch=gr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await K(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(H(r))return{data:null,error:r};throw r}}async getVectors(t){var e=this;try{return{data:await K(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(H(r))return{data:null,error:r};throw r}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await K(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(H(r))return{data:null,error:r};throw r}}async queryVectors(t){var e=this;try{return{data:await K(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(H(r))return{data:null,error:r};throw r}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await K(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(H(r))return{data:null,error:r};throw r}}},Za=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=T(T({},fr),e),this.fetch=gr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await K(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(H(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await K(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(H(r))return{data:null,error:r};throw r}}async listBuckets(t={}){var e=this;try{return{data:await K(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(H(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await K(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(H(r))return{data:null,error:r};throw r}}},Xa=class extends Za{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new eo(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,r=this;return e().call(r,t)}async getBucket(t){var e=()=>super.getBucket,r=this;return e().call(r,t)}async listBuckets(t={}){var e=()=>super.listBuckets,r=this;return e().call(r,t)}async deleteBucket(t){var e=()=>super.deleteBucket,r=this;return e().call(r,t)}},eo=class extends Ya{constructor(t,e,r,s){super(t,e,s),this.vectorBucketName=r}async createIndex(t){var e=()=>super.createIndex,r=this;return e().call(r,T(T({},t),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,r=this;return e().call(r,T(T({},t),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,r=this;return e().call(r,r.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,r=this;return e().call(r,r.vectorBucketName,t)}index(t){return new to(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},to=class extends Qa{constructor(t,e,r,s,n){super(t,e,n),this.vectorBucketName=r,this.indexName=s}async putVectors(t){var e=()=>super.putVectors,r=this;return e().call(r,T(T({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(t){var e=()=>super.getVectors,r=this;return e().call(r,T(T({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,r=this;return e().call(r,T(T({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,r=this;return e().call(r,T(T({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,r=this;return e().call(r,T(T({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},ro=class extends qa{constructor(t,e={},r,s){super(t,e,r,s)}from(t){return new Fa(this.url,this.headers,t,this.fetch)}get vectors(){return new Xa(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Va(this.url+"/iceberg",this.headers,this.fetch)}};const js="2.89.0",Ce=30*1e3,Xt=3,It=Xt*Ce,so="http://localhost:9999",no="supabase.auth.token",io={"X-Client-Info":`gotrue-js/${js}`},er="X-Supabase-Api-Version",Cs={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ao=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,oo=10*60*1e3;class Ke extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function x(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class lo extends Ke{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function co(t){return x(t)&&t.name==="AuthApiError"}class we extends Ke{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class ne extends Ke{constructor(e,r,s,n){super(e,s,n),this.name=r,this.status=s}}class V extends ne{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function uo(t){return x(t)&&t.name==="AuthSessionMissingError"}class xe extends ne{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class st extends ne{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class nt extends ne{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ho(t){return x(t)&&t.name==="AuthImplicitGrantRedirectError"}class Or extends ne{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class fo extends ne{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class tr extends ne{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Pt(t){return x(t)&&t.name==="AuthRetryableFetchError"}class Nr extends ne{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class rr extends ne{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const ut="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ir=` 	
\r=`.split(""),go=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Ir.length;e+=1)t[Ir[e].charCodeAt(0)]=-2;for(let e=0;e<ut.length;e+=1)t[ut[e].charCodeAt(0)]=e;return t})();function Pr(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(ut[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(ut[s]),e.queuedBits-=6}}function Rs(t,e,r){const s=go[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function $r(t){const e=[],r=a=>{e.push(String.fromCodePoint(a))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=a=>{wo(a,s,r)};for(let a=0;a<t.length;a+=1)Rs(t.charCodeAt(a),n,i);return e.join("")}function po(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function mo(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}po(s,e)}}function wo(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Oe(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)Rs(t.charCodeAt(n),r,s);return new Uint8Array(e)}function yo(t){const e=[];return mo(t,r=>e.push(r)),new Uint8Array(e)}function ye(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};return t.forEach(n=>Pr(n,r,s)),Pr(null,r,s),e.join("")}function vo(t){return Math.round(Date.now()/1e3)+t}function bo(){return Symbol("auth-callback")}const F=()=>typeof window<"u"&&typeof document<"u",fe={tested:!1,writable:!1},As=()=>{if(!F())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(fe.tested)return fe.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),fe.tested=!0,fe.writable=!0}catch{fe.tested=!0,fe.writable=!1}return fe.writable};function _o(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const Os=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),xo=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Re=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},ge=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},z=async(t,e)=>{await t.removeItem(e)};class xt{constructor(){this.promise=new xt.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}xt.promiseConstructor=Promise;function $t(t){const e=t.split(".");if(e.length!==3)throw new rr("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!ao.test(e[s]))throw new rr("JWT not in base64url format");return{header:JSON.parse($r(e[0])),payload:JSON.parse($r(e[1])),signature:Oe(e[2]),raw:{header:e[0],payload:e[1]}}}async function Eo(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function ko(t,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await t(i);if(!e(i,null,a)){s(a);return}}catch(a){if(!e(i,a)){n(a);return}}})()})}function So(t){return("0"+t.toString(16)).substr(-2)}function To(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let i=0;i<56;i++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,So).join("")}async function jo(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function Co(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await jo(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ee(t,e,r=!1){const s=To();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await Re(t,`${e}-code-verifier`,n);const i=await Co(s);return[i,s===i?"plain":"s256"]}const Ro=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Ao(t){const e=t.headers.get(er);if(!e||!e.match(Ro))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Oo(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function No(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Io=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ke(t){if(!Io.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ut(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Po(t,e){return new Proxy(t,{get:(r,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const i=s.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,n)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,s,n)}})}function Ur(t){return JSON.parse(JSON.stringify(t))}const pe=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),$o=[502,503,504];async function Dr(t){var e;if(!xo(t))throw new tr(pe(t),0);if($o.includes(t.status))throw new tr(pe(t),t.status);let r;try{r=await t.json()}catch(i){throw new we(pe(i),i)}let s;const n=Ao(t);if(n&&n.getTime()>=Cs["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new Nr(pe(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new V}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new Nr(pe(r),t.status,r.weak_password.reasons);throw new lo(pe(r),t.status||500,s)}const Uo=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function S(t,e,r,s){var n;const i=Object.assign({},s==null?void 0:s.headers);i[er]||(i[er]=Cs["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const a=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(a.redirect_to=s.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Do(t,e,r+o,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function Do(t,e,r,s,n,i){const a=Uo(e,s,n,i);let o;try{o=await t(r,Object.assign({},a))}catch(l){throw console.error(l),new tr(pe(l),0)}if(o.ok||await Dr(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(l){await Dr(l)}}function Y(t){var e;let r=null;Mo(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=vo(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function Lr(t){const e=Y(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function oe(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Lo(t){return{data:t,error:null}}function Bo(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i}=t,a=bt(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function Br(t){return t}function Mo(t){return t.access_token&&t.refresh_token&&t.expires_in}const Dt=["global","local","others"];class zo{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=Os(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=Dt[0]){if(Dt.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Dt.join(", ")}`);try{return await S(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(x(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await S(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:oe})}catch(s){if(x(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=bt(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await S(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Bo,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(x(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await S(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:oe})}catch(r){if(x(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,i,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await S(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Br});if(u.error)throw u.error;const g=await u.json(),d=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(p=>{const w=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(p.split(";")[1].split("=")[1]);c[`${_}Page`]=w}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},g),c),error:null}}catch(c){if(x(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){ke(e);try{return await S(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:oe})}catch(r){if(x(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){ke(e);try{return await S(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:oe})}catch(s){if(x(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){ke(e);try{return await S(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:oe})}catch(s){if(x(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){ke(e.userId);try{const{data:r,error:s}=await S(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(x(r))return{data:null,error:r};throw r}}async _deleteFactor(e){ke(e.userId),ke(e.id);try{return{data:await S(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(x(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,s,n,i,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await S(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Br});if(u.error)throw u.error;const g=await u.json(),d=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(p=>{const w=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(p.split(";")[1].split("=")[1]);c[`${_}Page`]=w}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},g),c),error:null}}catch(c){if(x(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(e){try{return await S(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(x(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await S(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(x(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await S(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(x(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await S(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(x(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await S(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(x(r))return{data:null,error:r};throw r}}}function Mr(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const Se={debug:!!(globalThis&&As()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ns extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Fo extends Ns{}async function qo(t,e,r){Se.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Se.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){Se.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{Se.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw Se.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Fo(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Se.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Vo(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Is(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function Ho(t){return parseInt(t,16)}function Ko(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function Wo(t){var e;const{chainId:r,domain:s,expirationTime:n,issuedAt:i=new Date,nonce:a,notBefore:o,requestId:l,resources:c,scheme:u,uri:g,version:d}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!g)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(d!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${d}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const f=Is(t.address),p=u?`${u}://${s}`:s,w=t.statement?`${t.statement}
`:"",_=`${p} wants you to sign in with your Ethereum account:
${f}

${w}`;let y=`URI: ${g}
Version: ${d}
Chain ID: ${r}${a?`
Nonce: ${a}`:""}
Issued At: ${i.toISOString()}`;if(n&&(y+=`
Expiration Time: ${n.toISOString()}`),o&&(y+=`
Not Before: ${o.toISOString()}`),l&&(y+=`
Request ID: ${l}`),c){let v=`
Resources:`;for(const m of c){if(!m||typeof m!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${m}`);v+=`
- ${m}`}y+=v}return`${_}
${y}`}class D extends Error{constructor({message:e,code:r,cause:s,name:n}){var i;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(i=n??(s instanceof Error?s.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class ht extends D{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function Jo({error:t,options:e}){var r,s,n;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new D({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new D({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new D({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new D({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new D({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new D({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new D({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new D({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const a=window.location.hostname;if(Ps(a)){if(i.rp.id!==a)return new D({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new D({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new D({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new D({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new D({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Go({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new D({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new D({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(Ps(s)){if(r.rpId!==s)return new D({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new D({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new D({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new D({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class Yo{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Qo=new Yo;function Zo(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:s}=t,n=bt(t,["challenge","user","excludeCredentials"]),i=Oe(e).buffer,a=Object.assign(Object.assign({},r),{id:Oe(r.id).buffer}),o=Object.assign(Object.assign({},n),{challenge:i,user:a});if(s&&s.length>0){o.excludeCredentials=new Array(s.length);for(let l=0;l<s.length;l++){const c=s[l];o.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:Oe(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function Xo(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,s=bt(t,["challenge","allowCredentials"]),n=Oe(e).buffer,i=Object.assign(Object.assign({},s),{challenge:n});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let a=0;a<r.length;a++){const o=r[a];i.allowCredentials[a]=Object.assign(Object.assign({},o),{id:Oe(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return i}function el(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:ye(new Uint8Array(t.response.attestationObject)),clientDataJSON:ye(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function tl(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,s=t.getClientExtensionResults(),n=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:ye(new Uint8Array(n.authenticatorData)),clientDataJSON:ye(new Uint8Array(n.clientDataJSON)),signature:ye(new Uint8Array(n.signature)),userHandle:n.userHandle?ye(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Ps(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function zr(){var t,e;return!!(F()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function rl(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new ht("Browser returned unexpected credential type",e)}:{data:null,error:new ht("Empty credential response",e)}}catch(e){return{data:null,error:Jo({error:e,options:t})}}}async function sl(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new ht("Browser returned unexpected credential type",e)}:{data:null,error:new ht("Empty credential response",e)}}catch(e){return{data:null,error:Go({error:e,options:t})}}}const nl={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},il={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function dt(...t){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of t)if(n)for(const i in n){const a=n[i];if(a!==void 0)if(Array.isArray(a))s[i]=a;else if(r(a))s[i]=a;else if(e(a)){const o=s[i];e(o)?s[i]=dt(o,a):s[i]=dt(a)}else s[i]=a}return s}function al(t,e){return dt(nl,t,e||{})}function ol(t,e){return dt(il,t,e||{})}class ll{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:s,signal:n},i){try{const{data:a,error:o}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!a)return{data:null,error:o};const l=n??Qo.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:c}=a.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${s}`),c.displayName||(c.displayName=c.name)}switch(a.webauthn.type){case"create":{const c=al(a.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:u,error:g}=await rl({publicKey:c,signal:l});return u?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:g}}case"request":{const c=ol(a.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:u,error:g}=await sl(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:c,signal:l}));return u?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:g}}}}catch(a){return x(a)?{data:null,error:a}:{data:null,error:new we("Unexpected error in challenge",a)}}}async _verify({challengeId:e,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!r)return{data:null,error:new Ke("rpId is required for WebAuthn authentication")};try{if(!zr())return{data:null,error:new we("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:s},signal:n},{request:i});if(!a)return{data:null,error:o};const{webauthn:l}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:s,credential_response:l.credential_response}})}catch(a){return x(a)?{data:null,error:a}:{data:null,error:new we("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!r)return{data:null,error:new Ke("rpId is required for WebAuthn registration")};try{if(!zr())return{data:null,error:new we("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(u=>{var g;return(g=u.data)===null||g===void 0?void 0:g.all.find(d=>d.factor_type==="webauthn"&&d.friendly_name===e&&d.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:o};const{data:l,error:c}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:n},{create:i});return l?this._verify({factorId:a.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:s,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(a){return x(a)?{data:null,error:a}:{data:null,error:new we("Unexpected error in register",a)}}}}Vo();const cl={url:so,storageKey:no,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:io,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Fr(t,e,r){return await r()}const Te={};class We{get jwks(){var e,r;return(r=(e=Te[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Te[this.storageKey]=Object.assign(Object.assign({},Te[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Te[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Te[this.storageKey]=Object.assign(Object.assign({},Te[this.storageKey]),{cachedAt:e})}constructor(e){var r,s,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},cl),e);if(this.storageKey=i.storageKey,this.instanceID=(r=We.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,We.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&F()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new zo({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Os(i.fetch),this.lock=i.lock||Fr,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:this.persistSession&&F()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=qo:this.lock=Fr,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new ll(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:As()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Mr(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Mr(this.memoryStorage)),F()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${js}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},s="none";if(F()&&(r=_o(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),F()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:i}=await this._getSessionFromURL(r,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),ho(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return x(r)?this._returnResult({error:r}):this._returnResult({error:new we("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,n;try{const i=await S(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:Y}),{data:a,error:o}=i;if(o||!a)return this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(x(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var r,s,n;try{let i;if("email"in e){const{email:u,password:g,options:d}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await Ee(this.storage,this.storageKey)),i=await S(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:g,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:p},xform:Y})}else if("phone"in e){const{phone:u,password:g,options:d}=e;i=await S(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:g,data:(s=d==null?void 0:d.data)!==null&&s!==void 0?s:{},channel:(n=d==null?void 0:d.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Y})}else throw new st("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return await z(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(await z(this.storage,`${this.storageKey}-code-verifier`),x(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:a,options:o}=e;r=await S(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Lr})}else if("phone"in e){const{phone:i,password:a,options:o}=e;r=await S(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Lr})}else throw new st("You must provide either an email or phone number and a password");const{data:s,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const i=new xe;return this._returnResult({data:{user:null,session:null},error:i})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(x(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,s,n,i,a,o,l,c,u,g,d;let f,p;if("message"in e)f=e.message,p=e.signature;else{const{chain:w,wallet:_,statement:y,options:v}=e;let m;if(F())if(typeof _=="object")m=_;else{const U=window;if("ethereum"in U&&typeof U.ethereum=="object"&&"request"in U.ethereum&&typeof U.ethereum.request=="function")m=U.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");m=_}const b=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href),C=await m.request({method:"eth_requestAccounts"}).then(U=>U).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!C||C.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const E=Is(C[0]);let R=(s=v==null?void 0:v.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!R){const U=await m.request({method:"eth_chainId"});R=Ho(U)}const N={domain:b.host,address:E,statement:y,uri:b.href,version:"1",chainId:R,nonce:(n=v==null?void 0:v.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(a=(i=v==null?void 0:v.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(o=v==null?void 0:v.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=v==null?void 0:v.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=v==null?void 0:v.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=v==null?void 0:v.signInWithEthereum)===null||u===void 0?void 0:u.resources};f=Wo(N),p=await m.request({method:"personal_sign",params:[Ko(f),E]})}try{const{data:w,error:_}=await S(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:f,signature:p},!((g=e.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(d=e.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:Y});if(_)throw _;if(!w||!w.session||!w.user){const y=new xe;return this._returnResult({data:{user:null,session:null},error:y})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:_})}catch(w){if(x(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(e){var r,s,n,i,a,o,l,c,u,g,d,f;let p,w;if("message"in e)p=e.message,w=e.signature;else{const{chain:_,wallet:y,statement:v,options:m}=e;let b;if(F())if(typeof y=="object")b=y;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))b=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(m!=null&&m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=y}const C=new URL((r=m==null?void 0:m.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const E=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},m==null?void 0:m.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),v?{statement:v}:null));let R;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")R=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)R=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)p=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),w=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${C.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(n=(s=m==null?void 0:m.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=m==null?void 0:m.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${m.signInWithSolana.notBefore}`]:[],...!((a=m==null?void 0:m.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${m.signInWithSolana.expirationTime}`]:[],...!((o=m==null?void 0:m.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${m.signInWithSolana.chainId}`]:[],...!((l=m==null?void 0:m.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${m.signInWithSolana.nonce}`]:[],...!((c=m==null?void 0:m.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${m.signInWithSolana.requestId}`]:[],...!((g=(u=m==null?void 0:m.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||g===void 0)&&g.length?["Resources",...m.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const E=await b.signMessage(new TextEncoder().encode(p),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=E}}try{const{data:_,error:y}=await S(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:ye(w)},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Y});if(y)throw y;if(!_||!_.session||!_.user){const v=new xe;return this._returnResult({data:{user:null,session:null},error:v})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:y})}catch(_){if(x(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async _exchangeCodeForSession(e){const r=await ge(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{if(!s&&this.flowType==="pkce")throw new fo;const{data:i,error:a}=await S(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Y});if(await z(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!i||!i.session||!i.user){const o=new xe;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:a})}catch(i){if(await z(this.storage,`${this.storageKey}-code-verifier`),x(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:r,provider:s,token:n,access_token:i,nonce:a}=e,o=await S(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Y}),{data:l,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const u=new xe;return this._returnResult({data:{user:null,session:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(r){if(x(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,s,n,i,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Ee(this.storage,this.storageKey));const{error:g}=await S(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:g})}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:u}=await S(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u})}throw new st("You must provide either an email or phone number.")}catch(o){if(await z(this.storage,`${this.storageKey}-code-verifier`),x(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(e){var r,s;try{let n,i;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:o}=await S(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:Y});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(n){if(x(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var r,s,n,i,a;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await Ee(this.storage,this.storageKey));const c=await S(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:Lo});return!((i=c.data)===null||i===void 0)&&i.url&&F()&&!(!((a=e.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await z(this.storage,`${this.storageKey}-code-verifier`),x(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new V;const{error:n}=await S(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(x(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:a}=await S(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:a,error:o}=await S(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o})}throw new st("You must provide either an email or phone number and a type")}catch(r){if(x(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await ge(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<It:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const a=await ge(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=Ut()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};e.user=Po(e.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(e){try{return e?await S(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:oe}):await this._useSession(async r=>{var s,n,i;const{data:a,error:o}=r;if(o)throw o;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new V}:await S(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:oe})})}catch(r){if(x(r))return uo(r)&&(await this._removeSession(),await z(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new V;const a=n.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await Ee(this.storage,this.storageKey));const{data:c,error:u}=await S(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:oe});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(s){if(await z(this.storage,`${this.storageKey}-code-verifier`),x(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new V;const r=Date.now()/1e3;let s=r,n=!0,i=null;const{payload:a}=$t(e.access_token);if(a.exp&&(s=a.exp,n=s<=r),n){const{data:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(x(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:a,error:o}=r;if(o)throw o;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new V;const{data:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(x(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!F())throw new nt("No browser detected.");if(e.error||e.error_description||e.error_code)throw new nt(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Or("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new nt("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Or("No code detected.");const{data:v,error:m}=await this._exchangeCodeForSession(e.code);if(m)throw m;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=e;if(!i||!o||!a||!c)throw new nt("No session defined in URL");const u=Math.round(Date.now()/1e3),g=parseInt(o);let d=u+g;l&&(d=parseInt(l));const f=d-u;f*1e3<=Ce&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${g}s`);const p=d-g;u-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,u):u-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,d,u);const{data:w,error:_}=await this._getUser(i);if(_)throw _;const y={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:g,expires_at:d,refresh_token:a,token_type:c,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:y,redirectType:e.type},error:null})}catch(s){if(x(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await ge(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return this._returnResult({error:i});const a=(s=n.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(co(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return e!=="others"&&(await this._removeSession(),await z(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=bo(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:i},error:a}=r;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await Ee(this.storage,this.storageKey,!0));try{return await S(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await z(this.storage,`${this.storageKey}-code-verifier`),x(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(x(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:s,error:n}=await this._useSession(async i=>{var a,o,l,c,u;const{data:g,error:d}=i;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await S(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=g.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return F()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(x(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var s;try{const{error:n,data:{session:i}}=r;if(n)throw n;const{options:a,provider:o,token:l,access_token:c,nonce:u}=e,g=await S(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=i==null?void 0:i.access_token)!==null&&s!==void 0?s:void 0,body:{provider:o,id_token:l,access_token:c,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Y}),{data:d,error:f}=g;return f?this._returnResult({data:{user:null,session:null},error:f}):!d||!d.session||!d.user?this._returnResult({data:{user:null,session:null},error:new xe}):(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("USER_UPDATED",d.session)),this._returnResult({data:d,error:f}))}catch(n){if(await z(this.storage,`${this.storageKey}-code-verifier`),x(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:a}=r;if(a)throw a;return await S(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(x(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await ko(async n=>(n>0&&await Eo(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await S(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Y})),(n,i)=>{const a=200*Math.pow(2,n);return i&&Pt(i)&&Date.now()+a-s<Ce})}catch(s){if(this._debug(r,"error",s),x(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),F()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await ge(this.storage,this.storageKey);if(n&&this.userStorage){let a=await ge(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:n.user},await Re(this.userStorage,this.storageKey+"-user",a)),n.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:Ut()}else if(n&&!n.user&&!n.user){const a=await ge(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(n.user=a.user,await z(this.storage,this.storageKey+"-user"),await Re(this.storage,this.storageKey,n)):n.user=Ut()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const i=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<It;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${It}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:a}=await this._callRefreshToken(n.refresh_token);a&&(console.error(a),Pt(a)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(n.access_token);!o&&(a!=null&&a.user)?(n.user=a.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(s,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new V;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new xt;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new V;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={data:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(n,"error",i),x(i)){const a={data:null,error:i};return Pt(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,r)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await z(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await Re(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const i=Ur(n);await Re(this.storage,this.storageKey,i)}else{const n=Ur(r);await Re(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await z(this.storage,this.storageKey),await z(this.storage,this.storageKey+"-code-verifier"),await z(this.storage,this.storageKey+"-user"),this.userStorage&&await z(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&F()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ce);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/Ce);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Ce}ms, refresh threshold is ${Xt} ticks`),n<=Xt&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Ns)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!F()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,a]=await Ee(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(o.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?this._returnResult({data:null,error:i}):await S(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(x(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:c}=await S(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(e.factorType==="totp"&&l.type==="totp"&&(!((n=l==null?void 0:l.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(x(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return this._returnResult({data:null,error:i});const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?el(e.webauthn.credential_response):tl(e.webauthn.credential_response)})}:{code:e.code}),{data:o,error:l}=await S(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(r){if(x(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return this._returnResult({data:null,error:i});const a=await S(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});if(a.error)return a;const{data:o}=a;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:Zo(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:Xo(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(x(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=r==null?void 0:r.factors)!==null&&e!==void 0?e:[])n.all.push(i),i.status==="verified"&&n[i.factor_type].push(i);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:s},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=$t(s.access_token);let a=null;i.aal&&(a=i.aal);let o=a;((r=(e=s.user.factors)===null||e===void 0?void 0:e.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(o="aal2");const c=i.amr||[];return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:c},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await S(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new V})})}catch(r){if(x(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new V});const a=await S(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&F()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(s){if(x(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new V});const a=await S(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&F()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(s){if(x(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;return s?this._returnResult({data:null,error:s}):r?await S(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new V})})}catch(e){if(x(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?(await S(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new V})})}catch(r){if(x(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(o=>o.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(o=>o.kid===e),s&&this.jwks_cached_at+oo>n)return s;const{data:i,error:a}=await S(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,s=i.keys.find(o=>o.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:f,error:p}=await this.getSession();if(p||!f.session)return this._returnResult({data:null,error:p});s=f.session.access_token}const{header:n,payload:i,signature:a,raw:{header:o,payload:l}}=$t(s);r!=null&&r.allowExpired||Oo(i.exp);const c=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:f}=await this.getUser(s);if(f)throw f;return{data:{claims:i,header:n,signature:a},error:null}}const u=No(n.alg),g=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,g,a,yo(`${o}.${l}`)))throw new rr("Invalid JWT signature");return{data:{claims:i,header:n,signature:a},error:null}}catch(s){if(x(s))return this._returnResult({data:null,error:s});throw s}}}We.nextInstanceID={};const ul=We,hl="2.89.0";let Le="";typeof Deno<"u"?Le="deno":typeof document<"u"?Le="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Le="react-native":Le="node";const dl={"X-Client-Info":`supabase-js-${Le}/${hl}`},fl={headers:dl},gl={schema:"public"},pl={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ml={};function Je(t){"@babel/helpers - typeof";return Je=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Je(t)}function wl(t,e){if(Je(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(Je(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yl(t){var e=wl(t,"string");return Je(e)=="symbol"?e:e+""}function vl(t,e,r){return(e=yl(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function $(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qr(Object(r),!0).forEach(function(s){vl(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qr(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}const bl=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),_l=()=>Headers,xl=(t,e,r)=>{const s=bl(r),n=_l();return async(i,a)=>{var o;const l=(o=await e())!==null&&o!==void 0?o:t;let c=new n(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(i,$($({},a),{},{headers:c}))}};function El(t){return t.endsWith("/")?t:t+"/"}function kl(t,e){var r,s;const{db:n,auth:i,realtime:a,global:o}=t,{db:l,auth:c,realtime:u,global:g}=e,d={db:$($({},l),n),auth:$($({},c),i),realtime:$($({},u),a),storage:{},global:$($($({},g),o),{},{headers:$($({},(r=g==null?void 0:g.headers)!==null&&r!==void 0?r:{}),(s=o==null?void 0:o.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?d.accessToken=t.accessToken:delete d.accessToken,d}function Sl(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(El(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Tl=class extends ul{constructor(t){super(t)}},jl=class{constructor(t,e,r){var s,n;this.supabaseUrl=t,this.supabaseKey=e;const i=Sl(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const a=`sb-${i.hostname.split(".")[0]}-auth-token`,o={db:gl,realtime:ml,auth:$($({},pl),{},{storageKey:a}),global:fl},l=kl(r??{},o);if(this.storageKey=(s=l.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(n=l.global.headers)!==null&&n!==void 0?n:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(u,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=l.auth)!==null&&c!==void 0?c:{},this.headers,l.global.fetch)}this.fetch=xl(e,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient($({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&this.accessToken().then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new ia(new URL("rest/v1",i).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new ro(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new ea(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,r;if(t.accessToken)return await t.accessToken();const{data:s}=await t.auth.getSession();return(e=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:s,userStorage:n,storageKey:i,flowType:a,lock:o,debug:l,throwOnError:c},u,g){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Tl({url:this.authUrl.href,headers:$($({},d),u),storageKey:i,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:s,userStorage:n,flowType:a,lock:o,debug:l,throwOnError:c,fetch:g,hasCustomAuthorizationHeader:Object.keys(this.headers).some(f=>f.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new xa(this.realtimeUrl.href,$($({},t),{},{params:$($({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Cl=(t,e,r)=>new jl(t,e,r);function Rl(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Rl()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Al="https://ccwrxgvddypgbbdmjsaw.supabase.co",Ol="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNjd3J4Z3ZkZHlwZ2JiZG1qc2F3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYzMjM5NTQsImV4cCI6MjA4MTg5OTk1NH0.9RsMSsYIwENQLvvgI2jXgZGJNfoy9iHvf_70_6aaClY",ve=Cl(Al,Ol),Nl={async uploadBackgroundImage(t){try{if(!t)throw new Error("No se seleccionó archivo");if(t.size>5*1024*1024)throw new Error("La imagen debe ser menor a 5MB");const e=t.name.split(".").pop(),r=`${Date.now()}_${Math.random().toString(36).substring(2)}.${e}`,s=`backgrounds/${r}`;console.log("📤 Subiendo imagen:",r);const{data:n,error:i}=await ve.storage.from("countdown-images").upload(s,t);if(i)throw i;const{data:{publicUrl:a}}=ve.storage.from("countdown-images").getPublicUrl(s);return console.log("✅ Imagen subida:",a),{success:!0,url:a,fileName:r,path:s}}catch(e){return console.error("❌ Error subiendo imagen:",e),{success:!1,error:e.message}}},async deleteImage(t){try{const{error:e}=await ve.storage.from("countdown-images").remove([t]);if(e)throw e;return{success:!0}}catch(e){return console.error("Error eliminando imagen:",e),{success:!1,error:e.message}}}},$s={async createCountdown(t,e=null){var r;try{console.log("📝 Creando countdown...");let s=null;if(e&&t.useImage){const l=await Nl.uploadBackgroundImage(e);l.success?s=l.url:(console.warn("⚠️ No se pudo subir imagen, usando URL directa"),s=t.backgroundImage)}else t.useImage&&t.backgroundImage&&!t.backgroundImage.startsWith("data:")&&(s=t.backgroundImage);const n=`cd_${Date.now().toString(36)}_${Math.random().toString(36).substring(2,6)}`,i={title:t.title,target_date:this.formatDateForDB(t.targetDate),message:t.message||null,background_color:t.backgroundColor||"#4a148c",text_color:t.textColor||"#ffffff",background_image:s,progress_icon:t.progressIcon||"FaBirthdayCake",public_url:n,custom_data:{start_date:this.formatDateForDB(t.startDate),use_image:!!t.useImage}};console.log("📤 Insertando en BD:",i);const{data:a,error:o}=await ve.from("countdowns").insert([i]).select().single();if(o)throw console.error("❌ Error de Supabase:",o),new Error(`Error al crear countdown: ${o.message}`);return console.log("✅ Countdown creado:",a),{id:a.id,public_url:a.public_url,title:a.title,targetDate:a.target_date,startDate:((r=a.custom_data)==null?void 0:r.start_date)||t.startDate,message:a.message,backgroundColor:a.background_color,textColor:a.text_color,progressIcon:a.progress_icon||"FaHourglassHalf",backgroundImage:a.background_image,useImage:!!a.background_image,views:a.views||0,created_at:a.created_at}}catch(s){throw console.error("💥 Error en createCountdown:",s),s}},async getCountdown(t){var e;try{console.log("🔍 Buscando countdown:",t);let r=ve.from("countdowns").select("*");/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)?r=r.eq("id",t):r=r.eq("public_url",t);const{data:n,error:i}=await r.single();if(i)throw i;return await this.incrementViews(n.id,n.views),{id:n.id,public_url:n.public_url,title:n.title,targetDate:n.target_date,startDate:((e=n.custom_data)==null?void 0:e.start_date)||n.created_at,message:n.message,backgroundColor:n.background_color||"#4a148c",textColor:n.text_color||"#ffffff",progressIcon:n.progress_icon||"FaHourglassHalf",backgroundImage:n.background_image,useImage:!!n.background_image,views:(n.views||0)+1,created_at:n.created_at,custom_data:n.custom_data||{}}}catch(r){throw console.error("💥 Error en getCountdown:",r),r}},formatDateForDB(t){return t?t.includes("T")&&t.endsWith("Z")?t:t.includes("T")?new Date(t).toISOString():new Date(t+"T00:00:00.000Z").toISOString():new Date().toISOString()},async incrementViews(t,e=0){try{await ve.from("countdowns").update({views:e+1,updated_at:new Date().toISOString()}).eq("id",t)}catch(r){console.error("⚠️ Error al incrementar vistas:",r)}},async testConnection(){var t;try{const{data:e,error:r}=await ve.from("countdowns").select("count(*)");if(r)throw r;return{success:!0,count:((t=e[0])==null?void 0:t.count)||0}}catch(e){return{success:!1,error:e.message}}}},Il=Yi(),Pl=[{name:"Estrellas",url:"https://images.unsplash.com/photo-1519681393784-d120267933ba?w=800&auto=format&fit=crop"},{name:"Fiesta",url:"https://images.unsplash.com/photo-1530103862676-de8c9debad1d?w=800&auto=format&fit=crop"},{name:"Naturaleza",url:"https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=800&auto=format&fit=crop"},{name:"Navidad",url:"https://images.unsplash.com/photo-1544717305-2782549b5136?w=800&auto=format&fit=crop"},{name:"Abstracto",url:"https://images.unsplash.com/photo-1550684376-efcbd6e3f031?w=800&auto=format&fit=crop"},{name:"Reyes",url:"https://ccwrxgvddypgbbdmjsaw.supabase.co/storage/v1/object/public/countdown-images/backgrounds/1766347941172_1c9z4xkx0pt.jpg"}];function $l(){const t=Vs(),e=j.useRef(null),[r,s]=j.useState(!1),[n,i]=j.useState(""),[a,o]=j.useState(!1),[l,c]=j.useState(""),[u,g]=j.useState({title:"Cumpleaños",targetDate:new Date(Date.now()+864e5).toISOString().slice(0,16),startDate:new Date().toISOString().slice(0,10),message:"¡Falta poco para tu día especial!",backgroundColor:"#4a148c",textColor:"#ffffff",backgroundImage:"",progressIcon:"https://cdn-icons-png.flaticon.com/512/3195/3195411.png",useImage:!1}),[d,f]=j.useState(null),[p,w]=j.useState(""),[_,y]=j.useState({days:0,hours:0,minutes:0,seconds:0}),[v,m]=j.useState(0);j.useEffect(()=>{const k=()=>{const A=new Date(u.targetDate),G=new Date(u.startDate),be=new Date,De=A-be;if(De<=0){y({days:0,hours:0,minutes:0,seconds:0}),m(100);return}const Us=Math.floor(De/(1e3*60*60*24)),Ds=Math.floor(De%(1e3*60*60*24)/(1e3*60*60)),Ls=Math.floor(De%(1e3*60*60)/(1e3*60)),Bs=Math.floor(De%(1e3*60)/1e3);y({days:Us,hours:Ds,minutes:Ls,seconds:Bs});const Ms=A-G,zs=be-G,Fs=Math.min(Math.max(zs/Ms*100,0),100);m(Fs)};k();const I=setInterval(k,1e3);return()=>clearInterval(I)},[u.targetDate,u.startDate]),j.useEffect(()=>()=>{p.startsWith("blob:")&&URL.revokeObjectURL(p)},[p]);const b=async k=>{k.preventDefault(),s(!0);try{console.log("🚀 Creando countdown...");const I=await $s.createCountdown(u,d);console.log("Respuesta del servicio:",I);const A=`https://dvdstv89.github.io/countdown-qr-app/#/c/${I.public_url}`;localStorage.setItem("last_countdown_url",A),localStorage.setItem("last_countdown_id",I.public_url);const G=await Ne.toDataURL(A,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"}});i(G),o(!0),q.success("✅ Countdown creado exitosamente!"),p.startsWith("blob:")&&(URL.revokeObjectURL(p),w(""),f(null))}catch(I){console.error("❌ Error:",I),q.error(`Error: ${I.message}`);const A=`local_${Date.now().toString(36)}`,G=`https://dvdstv89.github.io/countdown-qr-app/#/c/${A}`,be=await Ne.toDataURL(G,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"}});i(be),o(!0),localStorage.setItem(`countdown_${A}`,JSON.stringify({id:A,public_url:A,...u,backgroundImage:p||u.backgroundImage,url:G,created:new Date().toISOString()})),q.success("Countdown guardado localmente")}finally{s(!1)}},C=k=>{const I=k.target.files[0];if(!I)return;if(I.size>5*1024*1024){q.error("La imagen es muy grande (máximo 5MB)");return}if(!["image/jpeg","image/png","image/webp","image/gif"].includes(I.type)){q.error("Formato no válido. Usa JPG, PNG, WebP o GIF");return}const G=URL.createObjectURL(I);w(G),f(I),g(be=>({...be,backgroundImage:G,useImage:!0})),q.success("Imagen cargada para subir")},E=()=>{p.startsWith("blob:")&&URL.revokeObjectURL(p),w(""),f(null),g(k=>({...k,backgroundImage:"",useImage:!1})),e.current&&(e.current.value=""),q.success("Imagen removida")},R=k=>{g(I=>({...I,backgroundImage:k,useImage:!0})),w(""),f(null),e.current&&(e.current.value="")},N=()=>{if(!n){q.error("Primero genera un QR");return}const k=document.createElement("a");k.download=`countdown-${u.title.replace(/\s+/g,"-")}-${Date.now()}.png`,k.href=n,k.click(),q.success("QR descargado")},U=async k=>{try{return await navigator.clipboard.writeText(k),q.success("✅ Enlace copiado!"),!0}catch(I){console.error("Error usando clipboard:",I);const A=document.createElement("textarea");A.value=k,A.style.position="fixed",A.style.left="-999999px",A.style.top="-999999px",document.body.appendChild(A),A.focus(),A.select();try{return document.execCommand("copy"),q.success("✅ Enlace copiado!"),!0}catch(G){return console.error("Fallback también falló:",G),q.error("❌ No se pudo copiar el enlace"),!1}finally{document.body.removeChild(A)}}},J=()=>{if(!l){q.error("Primero crea un countdown");return}U(l)};return h.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[h.jsxs("div",{className:"mb-8",children:[h.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Crear Countdown"}),h.jsx("p",{className:"text-gray-600",children:"Personaliza cada detalle de tu cuenta regresiva"})]}),h.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[h.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8",children:h.jsxs("form",{onSubmit:b,className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Título del Evento *"}),h.jsx("input",{type:"text",value:u.title,onChange:k=>g({...u,title:k.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",placeholder:"Ej: Cumpleaños de David",required:!0})]}),h.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha del Evento *"}),h.jsx("input",{type:"datetime-local",value:u.targetDate,onChange:k=>g({...u,targetDate:k.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha de Inicio *"}),h.jsx("input",{type:"date",value:u.startDate,onChange:k=>g({...u,startDate:k.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",required:!0}),h.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Para calcular el progreso"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje Personalizado"}),h.jsx("textarea",{value:u.message,onChange:k=>g({...u,message:k.target.value}),rows:"3",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition resize-none",placeholder:"¡Falta poco para tu día especial!",maxLength:200}),h.jsxs("p",{className:"text-xs text-gray-500 mt-1 text-right",children:[u.message.length,"/200 caracteres"]})]}),h.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color de Fondo"}),h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("input",{type:"color",value:u.backgroundColor,onChange:k=>g({...u,backgroundColor:k.target.value}),className:"w-12 h-12 rounded-lg cursor-pointer border border-gray-300 hover:border-purple-400 transition"}),h.jsxs("div",{children:[h.jsx("span",{className:"text-sm text-gray-600 font-mono",children:u.backgroundColor}),h.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click para cambiar"})]})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color de Texto"}),h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("input",{type:"color",value:u.textColor,onChange:k=>g({...u,textColor:k.target.value}),className:"w-12 h-12 rounded-lg cursor-pointer border border-gray-300 hover:border-purple-400 transition"}),h.jsxs("div",{children:[h.jsx("span",{className:"text-sm text-gray-600 font-mono",children:u.textColor}),h.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click para cambiar"})]})]})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Icono de Progreso"}),h.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-3",children:Il.map(k=>h.jsxs("button",{type:"button",onClick:()=>g({...u,progressIcon:k.key}),className:`p-3 rounded-lg border-2 transition-all transform hover:scale-105 ${u.progressIcon===k.key?"border-purple-500 bg-purple-50 scale-105 ring-1 ring-purple-300":"border-gray-200 hover:border-purple-300 hover:bg-gray-50"}`,children:[h.jsx("div",{className:"w-8 h-8 mx-auto flex items-center justify-center text-xl",children:h.jsx(Ht,{iconKey:k.key,color:"#4a148c",size:"1.5em"})}),h.jsx("span",{className:"text-xs mt-1 block text-gray-700",children:k.name})]},k.key))})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Imagen de Fondo"}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsxs("button",{type:"button",onClick:()=>{g({...u,useImage:!1,backgroundImage:""}),E()},className:`px-3 py-1 rounded text-sm transition ${u.useImage?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-purple-100 text-purple-700 border border-purple-300"}`,children:[h.jsx(Yn,{className:"inline mr-1"})," Solo color"]}),h.jsxs("button",{type:"button",onClick:()=>g({...u,useImage:!0}),className:`px-3 py-1 rounded text-sm transition ${u.useImage?"bg-purple-100 text-purple-700 border border-purple-300":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[h.jsx(ts,{className:"inline mr-1"})," Con imagen"]})]})]}),u.useImage?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-4",children:Pl.map(k=>h.jsxs("button",{type:"button",onClick:()=>R(k.url),className:`rounded-lg overflow-hidden border-2 transition-all transform hover:scale-[1.02] ${u.backgroundImage===k.url?"border-purple-500 ring-2 ring-purple-300 scale-[1.02]":"border-gray-200 hover:border-purple-300"}`,children:[h.jsx("img",{src:k.url,alt:k.name,className:"w-full h-24 object-cover",loading:"lazy"}),h.jsx("div",{className:"p-2 text-xs text-center bg-white text-gray-700",children:k.name})]},k.url))}),h.jsxs("div",{className:"mt-4",children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"O sube tu propia imagen:"}),h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsxs("label",{className:"flex-1 cursor-pointer",children:[h.jsxs("div",{className:"px-4 py-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-purple-400 transition-colors text-center group",children:[h.jsx(si,{className:"inline mr-2 text-gray-400 group-hover:text-purple-500 text-lg mb-1"}),h.jsx("span",{className:"text-gray-600 group-hover:text-purple-600",children:"Haz clic para subir imagen"}),h.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG o WebP (max 5MB)"})]}),h.jsx("input",{ref:e,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:C,className:"hidden"})]}),d&&h.jsx("button",{type:"button",onClick:E,className:"p-3 text-red-500 hover:bg-red-50 rounded-lg transition",title:"Eliminar imagen personalizada",children:h.jsx(ri,{})})]})]}),p&&h.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[h.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Vista previa (se subirá a la nube):"}),h.jsxs("div",{className:"h-32 rounded overflow-hidden border relative",children:[h.jsx("img",{src:p,alt:"Preview personalizada",className:"w-full h-full object-cover"}),h.jsx("div",{className:"absolute bottom-2 right-2 bg-black/70 text-white text-xs px-2 py-1 rounded",children:d==null?void 0:d.name})]}),h.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["📏 Tamaño: ",((d==null?void 0:d.size)/1024/1024).toFixed(2)," MB"]})]}),u.backgroundImage&&!p&&u.backgroundImage!==""&&h.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[h.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Imagen seleccionada:"}),h.jsx("div",{className:"h-32 rounded overflow-hidden border",children:h.jsx("img",{src:u.backgroundImage,alt:"Preview seleccionada",className:"w-full h-full object-cover"})}),h.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"🖼️ Imagen predeterminada"})]})]}):h.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:h.jsx("p",{className:"text-sm text-gray-600",children:'🎨 Usando solo color de fondo. Para agregar una imagen, selecciona "Con imagen".'})})]}),h.jsx("button",{type:"submit",disabled:r,className:"w-full py-4 px-6 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold rounded-lg shadow-lg hover:from-purple-700 hover:to-pink-700 transform hover:-translate-y-1 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:transform-none",children:r?h.jsxs("span",{className:"flex items-center justify-center",children:[h.jsxs("svg",{className:"animate-spin h-5 w-5 mr-3",viewBox:"0 0 24 24",children:[h.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),h.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Guardando en la nube..."]}):"🎯 Generar Countdown y QR"})]})}),h.jsxs("div",{className:"space-y-8",children:[h.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Vista Previa"}),h.jsx("div",{className:"rounded-xl overflow-hidden shadow-lg mb-6 min-h-[400px] flex flex-col justify-center relative",style:{background:u.useImage&&u.backgroundImage?`linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${u.backgroundImage}) center/cover`:u.backgroundColor},children:h.jsxs("div",{className:"p-8 flex-1 flex flex-col justify-center relative z-10",style:{color:u.textColor},children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("h3",{className:"text-3xl font-bold mb-4 drop-shadow-lg",children:u.title}),h.jsx("p",{className:"text-xl opacity-90 drop-shadow",children:u.message})]}),h.jsx("div",{className:"flex flex-wrap justify-center gap-4 mb-8",children:Object.entries(_).map(([k,I])=>h.jsxs("div",{className:"text-center bg-black/40 backdrop-blur-sm rounded-lg p-4 min-w-[80px] border border-white/20",children:[h.jsx("div",{className:"text-3xl font-bold",children:I.toString().padStart(2,"0")}),h.jsx("div",{className:"text-sm uppercase opacity-90 mt-1",children:k})]},k))}),h.jsxs("div",{className:"relative mb-4 px-4",children:[h.jsx("div",{className:"h-4 bg-black/40 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-white/60 rounded-full transition-all duration-1000",style:{width:`${v}%`}})}),u.progressIcon&&h.jsx("div",{className:"absolute top-1/2 transform -translate-y-1/2 -translate-x-1/2 transition-all duration-1000",style:{left:`${v}%`},children:h.jsx("div",{className:"w-10 h-10 filter drop-shadow-lg",children:h.jsx(Ht,{iconKey:u.progressIcon,color:u.textColor,size:"2.5em",animate:!0})})})]}),h.jsxs("div",{className:"text-center text-sm opacity-90",children:["Progreso: ",h.jsxs("span",{className:"font-bold text-lg",children:[v.toFixed(1),"%"]})]})]})}),h.jsxs("div",{className:"text-center text-gray-600 space-y-2",children:[h.jsxs("p",{className:"flex items-center justify-center gap-2",children:[h.jsx("span",{className:"text-lg",children:"📱"})," Esta vista se verá en cualquier teléfono"]}),h.jsxs("p",{className:"flex items-center justify-center gap-2",children:[h.jsx("span",{className:"text-lg",children:"🔄"})," El contador se actualiza en tiempo real"]}),u.useImage?h.jsxs("p",{className:"flex items-center justify-center gap-2 text-purple-600 font-medium",children:[h.jsx("span",{className:"text-lg",children:"🖼️"})," ",p?"Con imagen personalizada":"Con imagen predeterminada"]}):h.jsxs("p",{className:"flex items-center justify-center gap-2 text-purple-600 font-medium",children:[h.jsx("span",{className:"text-lg",children:"🎨"})," Usando solo color de fondo"]})]})]}),a&&n&&h.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Código QR Generado"}),h.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[h.jsxs("div",{className:"relative",children:[h.jsx("img",{src:n,alt:"QR Code",className:"border-4 border-white shadow-lg rounded-lg w-64 h-64"}),h.jsx("div",{className:"absolute -top-2 -right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:"✓"})]}),l&&h.jsxs("div",{className:"w-full max-w-md",children:[h.jsxs("p",{className:"text-sm text-gray-600 mb-2 font-medium flex items-center gap-2",children:[h.jsx(Gn,{})," Enlace generado:"]}),h.jsxs("div",{className:"flex items-center bg-gray-50 p-3 rounded-lg border border-gray-200",children:[h.jsx("code",{className:"flex-1 text-sm text-blue-600 break-all font-mono",children:l}),h.jsx("button",{onClick:()=>U(l),className:"ml-2 px-3 py-1.5 text-xs bg-blue-100 text-blue-600 rounded hover:bg-blue-200 transition font-medium",children:"Copiar"})]})]}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 w-full max-w-md",children:[h.jsxs("button",{onClick:N,className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all flex items-center justify-center gap-2",children:[h.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Descargar QR"]}),h.jsxs("button",{onClick:J,disabled:!l,className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white font-semibold rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[h.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copiar Enlace"]})]}),h.jsxs("div",{className:"text-center text-gray-600 space-y-3 pt-4 border-t",children:[h.jsxs("div",{className:"space-y-1",children:[h.jsxs("p",{className:"flex items-center justify-center gap-2",children:[h.jsx("span",{className:"text-lg",children:"📱"})," Escanea este QR con la cámara de tu teléfono"]}),h.jsxs("p",{className:"flex items-center justify-center gap-2",children:[h.jsx("span",{className:"text-lg",children:"🔗"})," O comparte el enlace directamente"]})]}),h.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-100",children:[h.jsxs("p",{className:"text-green-700 font-medium flex items-center justify-center gap-2",children:[h.jsx("span",{className:"text-lg",children:"✅"})," Datos guardados en la nube"]}),h.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Tu countdown está disponible en cualquier dispositivo"})]}),h.jsxs("div",{className:"flex justify-center gap-4 pt-2",children:[h.jsx("button",{onClick:()=>t(`/c/${l.split("/").pop()}`),className:"px-4 py-2 text-sm bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition font-medium",children:"Ver Countdown"}),h.jsx("button",{onClick:()=>{l&&window.open(l,"_blank")},className:"px-4 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition font-medium",children:"Abrir en Nueva Pestaña"})]})]})]})]})]})]}),h.jsx("div",{className:"mt-12 pt-8 border-t border-gray-200",children:h.jsxs("div",{className:"grid md:grid-cols-3 gap-6 text-center md:text-left",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"🌐 Acceso Universal"}),h.jsx("p",{className:"text-sm text-gray-600",children:"Tu countdown está disponible en cualquier dispositivo con internet"})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"📊 Estadísticas"}),h.jsx("p",{className:"text-sm text-gray-600",children:"Podrás ver cuántas personas han visto tu countdown"})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"🔄 Actualización en Tiempo Real"}),h.jsx("p",{className:"text-sm text-gray-600",children:"Los visitantes ven el contador actualizado al segundo"})]})]})})]})}function Ul(){const{id:t}=Hs(),[e,r]=j.useState(null),[s,n]=j.useState({}),[i,a]=j.useState(0),[o,l]=j.useState(!0),[c,u]=j.useState(null);if(j.useEffect(()=>{(async()=>{try{l(!0);const f=await $s.getCountdown(t);r(f),u(null)}catch(f){console.error("Error cargando countdown:",f),u("No se pudo cargar el countdown desde la nube");try{const p=localStorage.getItem(`countdown_${t}`);if(p){const w=JSON.parse(p);r(w),q.success("Cargado desde copia local")}}catch(p){console.error("Error cargando localmente:",p)}}finally{l(!1)}})()},[t]),j.useEffect(()=>{if(!e)return;const d=()=>{const p=new Date(e.targetDate),w=new Date(e.startDate),_=new Date,y=p-_;if(y<=0){n({days:0,hours:0,minutes:0,seconds:0,hasEnded:!0}),a(100);return}const v=Math.floor(y/(1e3*60*60*24)),m=Math.floor(y%(1e3*60*60*24)/(1e3*60*60)),b=Math.floor(y%(1e3*60*60)/(1e3*60)),C=Math.floor(y%(1e3*60)/1e3);n({days:v,hours:m,minutes:b,seconds:C,hasEnded:!1});const E=p-w,R=_-w,N=Math.min(Math.max(R/E*100,0),100);a(N)};d();const f=setInterval(d,1e3);return()=>clearInterval(f)},[e]),o)return h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-500 to-pink-500",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto"}),h.jsx("p",{className:"mt-4 text-white",children:"Cargando countdown desde la nube..."})]})});if(c&&!e)return h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-500 to-pink-500",children:h.jsxs("div",{className:"bg-white/10 backdrop-blur-sm p-8 rounded-2xl text-center max-w-md",children:[h.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"⚠️ Error"}),h.jsx("p",{className:"text-white mb-6",children:c}),h.jsx("button",{onClick:()=>window.location.href="/",className:"px-6 py-3 bg-white text-purple-600 font-bold rounded-lg hover:bg-gray-100",children:"Volver al inicio"})]})});const g=new Date(e.targetDate).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return h.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-6",style:{background:e.useImage&&e.backgroundImage?`url(${e.backgroundImage}) center/cover no-repeat`:e.backgroundColor,color:e.textColor},children:[h.jsxs("div",{className:"max-w-4xl w-full text-center space-y-10",children:[e.views>0&&h.jsxs("div",{className:"absolute top-4 right-4 bg-black/30 backdrop-blur-sm px-4 py-2 rounded-full text-sm",children:["👁️ ",e.views," vistas"]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("h1",{className:"text-5xl md:text-7xl font-bold drop-shadow-lg",children:e.title}),h.jsx("p",{className:"text-2xl md:text-3xl opacity-90 drop-shadow",children:e.message})]}),h.jsx("div",{className:"flex flex-wrap justify-center gap-4 md:gap-8",children:Object.entries({days:"Días",hours:"Horas",minutes:"Minutos",seconds:"Segundos"}).map(([d,f])=>{var p;return h.jsxs("div",{className:"bg-black/20 backdrop-blur-md rounded-2xl p-6 min-w-[140px]",children:[h.jsx("div",{className:"text-6xl md:text-7xl font-bold mb-2",children:((p=s[d])==null?void 0:p.toString().padStart(2,"0"))||"00"}),h.jsx("div",{className:"text-xl uppercase tracking-wider",children:f})]},d)})}),h.jsxs("div",{className:"relative py-8 px-4 max-w-2xl mx-auto",children:[h.jsx("div",{className:"h-4 bg-black/30 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-white/60 rounded-full transition-all duration-1000",style:{width:`${i}%`}})}),e.progressIcon&&h.jsx("div",{className:"absolute top-1/2 transform -translate-y-1/2 -translate-x-1/2 transition-all duration-1000",style:{left:`${i}%`},children:h.jsx("div",{className:"w-20 h-20 filter drop-shadow-2xl",children:h.jsx(Ht,{iconKey:e.progressIcon,color:e.textColor,size:"5em",animate:!0})})}),h.jsxs("div",{className:"flex justify-between text-sm mt-3",children:[h.jsx("span",{children:"Inicio"}),h.jsxs("span",{className:"font-bold text-lg",children:[i.toFixed(1),"%"]}),h.jsx("span",{children:"Evento"})]})]}),h.jsx("div",{className:"mt-12 pt-8 border-t border-white/20 max-w-2xl mx-auto w-full",children:h.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[h.jsxs("div",{className:"text-left flex-1",children:[h.jsx("h3",{className:"text-2xl font-bold mb-2",children:"📅 Fecha del Evento"}),h.jsx("p",{className:"text-xl",children:g})]}),h.jsx("div",{children:h.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(window.location.href),alert("¡Enlace copiado al portapapeles!")},className:"px-8 py-4 bg-white/20 hover:bg-white/30 rounded-xl transition-all border border-white/30 flex items-center space-x-3 text-xl font-semibold hover:scale-105 active:scale-95",children:[h.jsx(ei,{className:"text-2xl"}),h.jsx("span",{children:"Compartir"})]})})]})}),s.hasEnded&&h.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/70 backdrop-blur-sm z-50",children:h.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-pink-600 p-12 rounded-3xl text-center max-w-2xl mx-6",children:[h.jsx("div",{className:"text-8xl mb-6",children:"🎉"}),h.jsx("h2",{className:"text-5xl font-bold mb-4",children:"¡EL EVENTO HA LLEGADO!"}),h.jsx("p",{className:"text-2xl",children:"¡Es hora de celebrar!"})]})})]}),h.jsx("div",{className:"absolute bottom-4 right-4 text-white/40 text-sm",children:"Countdown QR Generator"})]})}function Dl(){return h.jsx("nav",{className:"bg-white shadow-lg",children:h.jsx("div",{className:"container mx-auto px-4 py-3",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs(it,{to:"/",className:"flex items-center space-x-3 text-2xl font-bold text-purple-700",children:[h.jsx(nr,{className:"text-purple-600"}),h.jsx("span",{children:"Countdown QR"})]}),h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsxs(it,{to:"/",className:"flex items-center space-x-2 px-4 py-2 rounded-lg hover:bg-purple-50 transition-colors",children:[h.jsx(Jn,{}),h.jsx("span",{children:"Inicio"})]}),h.jsxs(it,{to:"/create",className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all",children:[h.jsx(Qn,{}),h.jsx("span",{children:"Crear Countdown"})]})]})]})})})}function Ll(){return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50",children:[h.jsx(Dl,{}),h.jsx("main",{className:"container mx-auto px-4 py-8",children:h.jsxs(Ks,{children:[h.jsx(Et,{path:"/",element:h.jsx(ni,{})}),h.jsx(Et,{path:"/create",element:h.jsx($l,{})}),h.jsx(Et,{path:"/c/:id",element:h.jsx(Ul,{})})]})}),h.jsx(Fn,{position:"top-right"})]})}Lt.createRoot(document.getElementById("root")).render(h.jsx(ce.StrictMode,{children:h.jsx(Ws,{children:h.jsx(Ll,{})})}));
