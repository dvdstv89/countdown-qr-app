import{r as k,a as En,R as L,L as ue,u as fs,b as gs,c as kn,d as jn,e as Xe,H as Sn}from"./vendor-BWDVdfVw.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();var ms={exports:{}},Nt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cn=k,Nn=Symbol.for("react.element"),Tn=Symbol.for("react.fragment"),In=Object.prototype.hasOwnProperty,Rn=Cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,An={key:!0,ref:!0,__self:!0,__source:!0};function ps(t,e,r){var s,n={},a=null,i=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(i=e.ref);for(s in e)In.call(e,s)&&!An.hasOwnProperty(s)&&(n[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)n[s]===void 0&&(n[s]=e[s]);return{$$typeof:Nn,type:t,key:a,ref:i,props:n,_owner:Rn.current}}Nt.Fragment=Tn;Nt.jsx=ps;Nt.jsxs=ps;ms.exports=Nt;var c=ms.exports,er={},Pr=En;er.createRoot=Pr.createRoot,er.hydrateRoot=Pr.hydrateRoot;let On={data:""},Pn=t=>{if(typeof window=="object"){let e=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(t||document.head).appendChild(e),e.firstChild}return t||On},Dn=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,$n=/\/\*[^]*?\*\/|  +/g,Dr=/\n+/g,ge=(t,e)=>{let r="",s="",n="";for(let a in t){let i=t[a];a[0]=="@"?a[1]=="i"?r=a+" "+i+";":s+=a[1]=="f"?ge(i,a):a+"{"+ge(i,a[1]=="k"?"":e)+"}":typeof i=="object"?s+=ge(i,e?e.replace(/([^,])+/g,l=>a.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,o=>/&/.test(o)?o.replace(/&/g,l):l?l+" "+o:o)):a):i!=null&&(a=/^--/.test(a)?a:a.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=ge.p?ge.p(a,i):a+":"+i+";")}return r+(e&&n?e+"{"+n+"}":n)+s},le={},ws=t=>{if(typeof t=="object"){let e="";for(let r in t)e+=r+ws(t[r]);return e}return t},Ln=(t,e,r,s,n)=>{let a=ws(t),i=le[a]||(le[a]=(o=>{let u=0,d=11;for(;u<o.length;)d=101*d+o.charCodeAt(u++)>>>0;return"go"+d})(a));if(!le[i]){let o=a!==t?t:(u=>{let d,h,f=[{}];for(;d=Dn.exec(u.replace($n,""));)d[4]?f.shift():d[3]?(h=d[3].replace(Dr," ").trim(),f.unshift(f[0][h]=f[0][h]||{})):f[0][d[1]]=d[2].replace(Dr," ").trim();return f[0]})(t);le[i]=ge(n?{["@keyframes "+i]:o}:o,r?"":"."+i)}let l=r&&le.g?le.g:null;return r&&(le.g=le[i]),((o,u,d,h)=>{h?u.data=u.data.replace(h,o):u.data.indexOf(o)===-1&&(u.data=d?o+u.data:u.data+o)})(le[i],e,s,l),i},Un=(t,e,r)=>t.reduce((s,n,a)=>{let i=e[a];if(i&&i.call){let l=i(r),o=l&&l.props&&l.props.className||/^go/.test(l)&&l;i=o?"."+o:l&&typeof l=="object"?l.props?"":ge(l,""):l===!1?"":l}return s+n+(i??"")},"");function Tt(t){let e=this||{},r=t.call?t(e.p):t;return Ln(r.unshift?r.raw?Un(r,[].slice.call(arguments,1),e.p):r.reduce((s,n)=>Object.assign(s,n&&n.call?n(e.p):n),{}):r,Pn(e.target),e.g,e.o,e.k)}let bs,tr,rr;Tt.bind({g:1});let de=Tt.bind({k:1});function Bn(t,e,r,s){ge.p=e,bs=t,tr=r,rr=s}function be(t,e){let r=this||{};return function(){let s=arguments;function n(a,i){let l=Object.assign({},a),o=l.className||n.className;r.p=Object.assign({theme:tr&&tr()},l),r.o=/ *go\d+/.test(o),l.className=Tt.apply(r,s)+(o?" "+o:"");let u=t;return t[0]&&(u=l.as||t,delete l.as),rr&&u[0]&&rr(l),bs(u,l)}return n}}var Mn=t=>typeof t=="function",xt=(t,e)=>Mn(t)?t(e):t,zn=(()=>{let t=0;return()=>(++t).toString()})(),ys=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),Fn=20,vr="default",vs=(t,e)=>{let{toastLimit:r}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,r)};case 1:return{...t,toasts:t.toasts.map(i=>i.id===e.toast.id?{...i,...e.toast}:i)};case 2:let{toast:s}=e;return vs(t,{type:t.toasts.find(i=>i.id===s.id)?1:0,toast:s});case 3:let{toastId:n}=e;return{...t,toasts:t.toasts.map(i=>i.id===n||n===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(i=>i.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let a=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+a}))}}},vt=[],xs={toasts:[],pausedAt:void 0,settings:{toastLimit:Fn}},ie={},_s=(t,e=vr)=>{ie[e]=vs(ie[e]||xs,t),vt.forEach(([r,s])=>{r===e&&s(ie[e])})},Es=t=>Object.keys(ie).forEach(e=>_s(t,e)),Hn=t=>Object.keys(ie).find(e=>ie[e].toasts.some(r=>r.id===t)),It=(t=vr)=>e=>{_s(e,t)},Vn={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},qn=(t={},e=vr)=>{let[r,s]=k.useState(ie[e]||xs),n=k.useRef(ie[e]);k.useEffect(()=>(n.current!==ie[e]&&s(ie[e]),vt.push([e,s]),()=>{let i=vt.findIndex(([l])=>l===e);i>-1&&vt.splice(i,1)}),[e]);let a=r.toasts.map(i=>{var l,o,u;return{...t,...t[i.type],...i,removeDelay:i.removeDelay||((l=t[i.type])==null?void 0:l.removeDelay)||(t==null?void 0:t.removeDelay),duration:i.duration||((o=t[i.type])==null?void 0:o.duration)||(t==null?void 0:t.duration)||Vn[i.type],style:{...t.style,...(u=t[i.type])==null?void 0:u.style,...i.style}}});return{...r,toasts:a}},Kn=(t,e="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...r,id:(r==null?void 0:r.id)||zn()}),ut=t=>(e,r)=>{let s=Kn(e,t,r);return It(s.toasterId||Hn(s.id))({type:2,toast:s}),s.id},K=(t,e)=>ut("blank")(t,e);K.error=ut("error");K.success=ut("success");K.loading=ut("loading");K.custom=ut("custom");K.dismiss=(t,e)=>{let r={type:3,toastId:t};e?It(e)(r):Es(r)};K.dismissAll=t=>K.dismiss(void 0,t);K.remove=(t,e)=>{let r={type:4,toastId:t};e?It(e)(r):Es(r)};K.removeAll=t=>K.remove(void 0,t);K.promise=(t,e,r)=>{let s=K.loading(e.loading,{...r,...r==null?void 0:r.loading});return typeof t=="function"&&(t=t()),t.then(n=>{let a=e.success?xt(e.success,n):void 0;return a?K.success(a,{id:s,...r,...r==null?void 0:r.success}):K.dismiss(s),n}).catch(n=>{let a=e.error?xt(e.error,n):void 0;a?K.error(a,{id:s,...r,...r==null?void 0:r.error}):K.dismiss(s)}),t};var Wn=1e3,Gn=(t,e="default")=>{let{toasts:r,pausedAt:s}=qn(t,e),n=k.useRef(new Map).current,a=k.useCallback((h,f=Wn)=>{if(n.has(h))return;let g=setTimeout(()=>{n.delete(h),i({type:4,toastId:h})},f);n.set(h,g)},[]);k.useEffect(()=>{if(s)return;let h=Date.now(),f=r.map(g=>{if(g.duration===1/0)return;let m=(g.duration||0)+g.pauseDuration-(h-g.createdAt);if(m<0){g.visible&&K.dismiss(g.id);return}return setTimeout(()=>K.dismiss(g.id,e),m)});return()=>{f.forEach(g=>g&&clearTimeout(g))}},[r,s,e]);let i=k.useCallback(It(e),[e]),l=k.useCallback(()=>{i({type:5,time:Date.now()})},[i]),o=k.useCallback((h,f)=>{i({type:1,toast:{id:h,height:f}})},[i]),u=k.useCallback(()=>{s&&i({type:6,time:Date.now()})},[s,i]),d=k.useCallback((h,f)=>{let{reverseOrder:g=!1,gutter:m=8,defaultPosition:p}=f||{},b=r.filter(w=>(w.position||p)===(h.position||p)&&w.height),y=b.findIndex(w=>w.id===h.id),v=b.filter((w,x)=>x<y&&w.visible).length;return b.filter(w=>w.visible).slice(...g?[v+1]:[0,v]).reduce((w,x)=>w+(x.height||0)+m,0)},[r]);return k.useEffect(()=>{r.forEach(h=>{if(h.dismissed)a(h.id,h.removeDelay);else{let f=n.get(h.id);f&&(clearTimeout(f),n.delete(h.id))}})},[r,a]),{toasts:r,handlers:{updateHeight:o,startPause:l,endPause:u,calculateOffset:d}}},Jn=de`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Qn=de`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Yn=de`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Xn=be("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Jn} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Qn} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Yn} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Zn=de`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,ea=be("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${Zn} 1s linear infinite;
`,ta=de`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,ra=de`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,sa=be("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${ta} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${ra} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,na=be("div")`
  position: absolute;
`,aa=be("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,ia=de`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,oa=be("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${ia} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,la=({toast:t})=>{let{icon:e,type:r,iconTheme:s}=t;return e!==void 0?typeof e=="string"?k.createElement(oa,null,e):e:r==="blank"?null:k.createElement(aa,null,k.createElement(ea,{...s}),r!=="loading"&&k.createElement(na,null,r==="error"?k.createElement(Xn,{...s}):k.createElement(sa,{...s})))},ca=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,ua=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,da="0%{opacity:0;} 100%{opacity:1;}",ha="0%{opacity:1;} 100%{opacity:0;}",fa=be("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,ga=be("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,ma=(t,e)=>{let r=t.includes("top")?1:-1,[s,n]=ys()?[da,ha]:[ca(r),ua(r)];return{animation:e?`${de(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${de(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},pa=k.memo(({toast:t,position:e,style:r,children:s})=>{let n=t.height?ma(t.position||e||"top-center",t.visible):{opacity:0},a=k.createElement(la,{toast:t}),i=k.createElement(ga,{...t.ariaProps},xt(t.message,t));return k.createElement(fa,{className:t.className,style:{...n,...r,...t.style}},typeof s=="function"?s({icon:a,message:i}):k.createElement(k.Fragment,null,a,i))});Bn(k.createElement);var wa=({id:t,className:e,style:r,onHeightUpdate:s,children:n})=>{let a=k.useCallback(i=>{if(i){let l=()=>{let o=i.getBoundingClientRect().height;s(t,o)};l(),new MutationObserver(l).observe(i,{subtree:!0,childList:!0,characterData:!0})}},[t,s]);return k.createElement("div",{ref:a,className:e,style:r},n)},ba=(t,e)=>{let r=t.includes("top"),s=r?{top:0}:{bottom:0},n=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:ys()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(r?1:-1)}px)`,...s,...n}},ya=Tt`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,ft=16,va=({reverseOrder:t,position:e="top-center",toastOptions:r,gutter:s,children:n,toasterId:a,containerStyle:i,containerClassName:l})=>{let{toasts:o,handlers:u}=Gn(r,a);return k.createElement("div",{"data-rht-toaster":a||"",style:{position:"fixed",zIndex:9999,top:ft,left:ft,right:ft,bottom:ft,pointerEvents:"none",...i},className:l,onMouseEnter:u.startPause,onMouseLeave:u.endPause},o.map(d=>{let h=d.position||e,f=u.calculateOffset(d,{reverseOrder:t,gutter:s,defaultPosition:e}),g=ba(h,f);return k.createElement(wa,{id:d.id,key:d.id,onHeightUpdate:u.updateHeight,className:d.visible?ya:"",style:g},d.type==="custom"?xt(d.message,d):n?n(d):k.createElement(pa,{toast:d,position:h}))}))},D=K,ks={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},$r=L.createContext&&L.createContext(ks),we=function(){return we=Object.assign||function(t){for(var e,r=1,s=arguments.length;r<s;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},we.apply(this,arguments)},xa=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};function js(t){return t&&t.map(function(e,r){return L.createElement(e.tag,we({key:r},e.attr),js(e.child))})}function U(t){return function(e){return L.createElement(_a,we({attr:we({},t.attr)},e),js(t.child))}}function _a(t){var e=function(r){var s=t.attr,n=t.size,a=t.title,i=xa(t,["attr","size","title"]),l=n||r.size||"1em",o;return r.className&&(o=r.className),t.className&&(o=(o?o+" ":"")+t.className),L.createElement("svg",we({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,s,i,{className:o,style:we(we({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),a&&L.createElement("title",null,a),t.children)};return $r!==void 0?L.createElement($r.Consumer,null,function(r){return e(r)}):e(ks)}function Ea(t){return U({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"}}]})(t)}function ka(t){return U({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 384c-28.02 0-31.26-32-74.5-32-43.43 0-46.825 32-74.75 32-27.695 0-31.454-32-74.75-32-42.842 0-47.218 32-74.5 32-28.148 0-31.202-32-74.75-32-43.547 0-46.653 32-74.75 32v-80c0-26.5 21.5-48 48-48h16V112h64v144h64V112h64v144h64V112h64v144h16c26.5 0 48 21.5 48 48v80zm0 128H0v-96c43.356 0 46.767-32 74.75-32 27.951 0 31.253 32 74.75 32 42.843 0 47.217-32 74.5-32 28.148 0 31.201 32 74.75 32 43.357 0 46.767-32 74.75-32 27.488 0 31.252 32 74.5 32v96zM96 96c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40zm128 0c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40zm128 0c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40z"}}]})(t)}function ja(t){return U({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"}}]})(t)}function Sa(t){return U({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"}}]})(t)}function Lr(t){return U({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"}}]})(t)}function Ca(t){return U({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"}}]})(t)}function Ur(t){return U({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M432,320H400a16,16,0,0,0-16,16V448H64V128H208a16,16,0,0,0,16-16V80a16,16,0,0,0-16-16H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V336A16,16,0,0,0,432,320ZM488,0h-128c-21.37,0-32.05,25.91-17,41l35.73,35.73L135,320.37a24,24,0,0,0,0,34L157.67,377a24,24,0,0,0,34,0L435.28,133.32,471,169c15,15,41,4.5,41-17V24A24,24,0,0,0,488,0Z"}}]})(t)}function Na(t){return U({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M32 448c0 17.7 14.3 32 32 32h160V320H32v128zm256 32h160c17.7 0 32-14.3 32-32V320H288v160zm192-320h-42.1c6.2-12.1 10.1-25.5 10.1-40 0-48.5-39.5-88-88-88-41.6 0-68.5 21.3-103 68.3-34.5-47-61.4-68.3-103-68.3-48.5 0-88 39.5-88 88 0 14.5 3.8 27.9 10.1 40H32c-17.7 0-32 14.3-32 32v80c0 8.8 7.2 16 16 16h480c8.8 0 16-7.2 16-16v-80c0-17.7-14.3-32-32-32zm-326.1 0c-22.1 0-40-17.9-40-40s17.9-40 40-40c19.9 0 34.6 3.3 86.1 80h-86.1zm206.1 0h-86.1c51.4-76.5 65.7-80 86.1-80 22.1 0 40 17.9 40 40s-17.9 40-40 40z"}}]})(t)}function Ta(t){return U({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"}}]})(t)}function Ia(t){return U({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"}}]})(t)}function xr(t){return U({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M360 0H24C10.745 0 0 10.745 0 24v16c0 13.255 10.745 24 24 24 0 90.965 51.016 167.734 120.842 192C75.016 280.266 24 357.035 24 448c-13.255 0-24 10.745-24 24v16c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24v-16c0-13.255-10.745-24-24-24 0-90.965-51.016-167.734-120.842-192C308.984 231.734 360 154.965 360 64c13.255 0 24-10.745 24-24V24c0-13.255-10.745-24-24-24zm-75.078 384H99.08c17.059-46.797 52.096-80 92.92-80 40.821 0 75.862 33.196 92.922 80zm.019-256H99.078C91.988 108.548 88 86.748 88 64h208c0 22.805-3.987 44.587-11.059 64z"}}]})(t)}function Rt(t){return U({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"}}]})(t)}function Ss(t){return U({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"}}]})(t)}function Ra(t){return U({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M80 368H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm0-320H16A16 16 0 0 0 0 64v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16V64a16 16 0 0 0-16-16zm0 160H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm416 176H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"}}]})(t)}function _r(t){return U({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"}}]})(t)}function Aa(t){return U({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"}}]})(t)}function Cs(t){return U({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 224h192V32H0v192zM64 96h64v64H64V96zm192-64v192h192V32H256zm128 128h-64V96h64v64zM0 480h192V288H0v192zm64-128h64v64H64v-64zm352-64h32v128h-96v-32h-32v96h-64V288h96v32h64v-32zm0 160h32v32h-32v-32zm-64 0h32v32h-32v-32z"}}]})(t)}function Oa(t){return U({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505.12019,19.09375c-1.18945-5.53125-6.65819-11-12.207-12.1875C460.716,0,435.507,0,410.40747,0,307.17523,0,245.26909,55.20312,199.05238,128H94.83772c-16.34763.01562-35.55658,11.875-42.88664,26.48438L2.51562,253.29688A28.4,28.4,0,0,0,0,264a24.00867,24.00867,0,0,0,24.00582,24H127.81618l-22.47457,22.46875c-11.36521,11.36133-12.99607,32.25781,0,45.25L156.24582,406.625c11.15623,11.1875,32.15619,13.15625,45.27726,0l22.47457-22.46875V488a24.00867,24.00867,0,0,0,24.00581,24,28.55934,28.55934,0,0,0,10.707-2.51562l98.72834-49.39063c14.62888-7.29687,26.50776-26.5,26.50776-42.85937V312.79688c72.59753-46.3125,128.03493-108.40626,128.03493-211.09376C512.07526,76.5,512.07526,51.29688,505.12019,19.09375ZM384.04033,168A40,40,0,1,1,424.05,128,40.02322,40.02322,0,0,1,384.04033,168Z"}}]})(t)}function Pa(t){return U({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}}]})(t)}function Da(t){return U({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M352 320c-22.608 0-43.387 7.819-59.79 20.895l-102.486-64.054a96.551 96.551 0 0 0 0-41.683l102.486-64.054C308.613 184.181 329.392 192 352 192c53.019 0 96-42.981 96-96S405.019 0 352 0s-96 42.981-96 96c0 7.158.79 14.13 2.276 20.841L155.79 180.895C139.387 167.819 118.608 160 96 160c-53.019 0-96 42.981-96 96s42.981 96 96 96c22.608 0 43.387-7.819 59.79-20.895l102.486 64.054A96.301 96.301 0 0 0 256 416c0 53.019 42.981 96 96 96s96-42.981 96-96-42.981-96-96-96z"}}]})(t)}function $a(t){return U({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M510.9 152.3l-5.9-14.5c-3.3-8-12.6-11.9-20.8-8.7L456 140.6v-29c0-8.6-7.2-15.6-16-15.6h-16c-8.8 0-16 7-16 15.6v46.9c0 .5.3 1 .3 1.5l-56.4 23c-5.9-10-13.3-18.9-22-26.6 13.6-16.6 22-37.4 22-60.5 0-53-43-96-96-96s-96 43-96 96c0 23.1 8.5 43.9 22 60.5-8.7 7.7-16 16.6-22 26.6l-56.4-23c.1-.5.3-1 .3-1.5v-46.9C104 103 96.8 96 88 96H72c-8.8 0-16 7-16 15.6v29l-28.1-11.5c-8.2-3.2-17.5.7-20.8 8.7l-5.9 14.5c-3.3 8 .7 17.1 8.9 20.3l135.2 55.2c-.4 4-1.2 8-1.2 12.2 0 10.1 1.7 19.6 4.2 28.9C120.9 296.4 104 334.2 104 376c0 54 28.4 100.9 70.8 127.8 9.3 5.9 20.3 8.2 31.3 8.2h99.2c13.3 0 26.3-4.1 37.2-11.7 46.5-32.3 74.4-89.4 62.9-152.6-5.5-30.2-20.5-57.6-41.6-79 2.5-9.2 4.2-18.7 4.2-28.7 0-4.2-.8-8.1-1.2-12.2L502 172.6c8.1-3.1 12.1-12.2 8.9-20.3zM224 96c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm32 272c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm0-64c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm0-64c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm0-88s-16-23.2-16-32 7.2-16 16-16 16 7.2 16 16-16 32-16 32zm32-56c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"}}]})(t)}function Ns(t){return U({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"}}]})(t)}function Ts(t){return U({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"}}]})(t)}function Is(t){return U({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M296 384h-80c-13.3 0-24-10.7-24-24V192h-87.7c-17.8 0-26.7-21.5-14.1-34.1L242.3 5.7c7.5-7.5 19.8-7.5 27.3 0l152.2 152.2c12.6 12.6 3.7 34.1-14.1 34.1H320v168c0 13.3-10.7 24-24 24zm216-8v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h136v8c0 30.9 25.1 56 56 56h80c30.9 0 56-25.1 56-56v-8h136c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"}}]})(t)}function La(){return c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"max-w-4xl mx-auto",children:[c.jsxs("h1",{className:"text-5xl md:text-6xl font-bold text-gray-900 mb-6",children:["Crea Countdowns Personalizados",c.jsx("span",{className:"block text-purple-600",children:"con Códigos QR"})]}),c.jsx("p",{className:"text-xl text-gray-600 mb-10",children:"Genera cuenta regresivas únicas para cumpleaños, eventos especiales, Navidad... ¡Todo con un QR que puedes imprimir o compartir!"}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mb-12",children:[c.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-lg",children:[c.jsx("div",{className:"text-purple-600 mb-4",children:c.jsx(Cs,{className:"text-5xl mx-auto"})}),c.jsx("h3",{className:"text-2xl font-bold mb-3",children:"QR Generado Automáticamente"}),c.jsx("p",{className:"text-gray-600",children:"Cada countdown tiene su propio código QR único para compartir fácilmente."})]}),c.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-lg",children:[c.jsx("div",{className:"text-purple-600 mb-4",children:c.jsx(Rt,{className:"text-5xl mx-auto"})}),c.jsx("h3",{className:"text-2xl font-bold mb-3",children:"Personalización Completa"}),c.jsx("p",{className:"text-gray-600",children:"Elige colores, imágenes de fondo y iconos animados para la barra de progreso."})]})]}),c.jsx(ue,{to:"/create",className:"inline-block px-8 py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white text-xl font-bold rounded-full hover:from-purple-700 hover:to-pink-700 transform hover:-translate-y-1 transition-all duration-300 shadow-xl",children:"Comenzar a Crear →"}),c.jsxs("div",{className:"mt-16",children:[c.jsx("h2",{className:"text-3xl font-bold mb-8",children:"¿Cómo funciona?"}),c.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow",children:[c.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:"1"}),c.jsx("h4",{className:"font-bold mb-2",children:"Configura tu evento"}),c.jsx("p",{className:"text-gray-600",children:"Elige fecha, mensaje, colores e icono."})]}),c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow",children:[c.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:"2"}),c.jsx("h4",{className:"font-bold mb-2",children:"Genera el QR"}),c.jsx("p",{className:"text-gray-600",children:"Obtén automáticamente un código QR único."})]}),c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow",children:[c.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:"3"}),c.jsx("h4",{className:"font-bold mb-2",children:"Comparte"}),c.jsx("p",{className:"text-gray-600",children:"Envía el QR o enlace a quien quieras."})]})]})]})]})})}var He={},Ua=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},Rs={},te={};let Er;const Ba=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];te.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};te.getSymbolTotalCodewords=function(e){return Ba[e]};te.getBCHDigit=function(t){let e=0;for(;t!==0;)e++,t>>>=1;return e};te.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');Er=e};te.isKanjiModeEnabled=function(){return typeof Er<"u"};te.toSJIS=function(e){return Er(e)};var At={};(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function e(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+r)}}t.isValid=function(s){return s&&typeof s.bit<"u"&&s.bit>=0&&s.bit<4},t.from=function(s,n){if(t.isValid(s))return s;try{return e(s)}catch{return n}}})(At);function As(){this.buffer=[],this.length=0}As.prototype={get:function(t){const e=Math.floor(t/8);return(this.buffer[e]>>>7-t%8&1)===1},put:function(t,e){for(let r=0;r<e;r++)this.putBit((t>>>e-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var Ma=As;function dt(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}dt.prototype.set=function(t,e,r,s){const n=t*this.size+e;this.data[n]=r,s&&(this.reservedBit[n]=!0)};dt.prototype.get=function(t,e){return this.data[t*this.size+e]};dt.prototype.xor=function(t,e,r){this.data[t*this.size+e]^=r};dt.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var za=dt,Os={};(function(t){const e=te.getSymbolSize;t.getRowColCoords=function(s){if(s===1)return[];const n=Math.floor(s/7)+2,a=e(s),i=a===145?26:Math.ceil((a-13)/(2*n-2))*2,l=[a-7];for(let o=1;o<n-1;o++)l[o]=l[o-1]-i;return l.push(6),l.reverse()},t.getPositions=function(s){const n=[],a=t.getRowColCoords(s),i=a.length;for(let l=0;l<i;l++)for(let o=0;o<i;o++)l===0&&o===0||l===0&&o===i-1||l===i-1&&o===0||n.push([a[l],a[o]]);return n}})(Os);var Ps={};const Fa=te.getSymbolSize,Br=7;Ps.getPositions=function(e){const r=Fa(e);return[[0,0],[r-Br,0],[0,r-Br]]};var Ds={};(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};t.isValid=function(n){return n!=null&&n!==""&&!isNaN(n)&&n>=0&&n<=7},t.from=function(n){return t.isValid(n)?parseInt(n,10):void 0},t.getPenaltyN1=function(n){const a=n.size;let i=0,l=0,o=0,u=null,d=null;for(let h=0;h<a;h++){l=o=0,u=d=null;for(let f=0;f<a;f++){let g=n.get(h,f);g===u?l++:(l>=5&&(i+=e.N1+(l-5)),u=g,l=1),g=n.get(f,h),g===d?o++:(o>=5&&(i+=e.N1+(o-5)),d=g,o=1)}l>=5&&(i+=e.N1+(l-5)),o>=5&&(i+=e.N1+(o-5))}return i},t.getPenaltyN2=function(n){const a=n.size;let i=0;for(let l=0;l<a-1;l++)for(let o=0;o<a-1;o++){const u=n.get(l,o)+n.get(l,o+1)+n.get(l+1,o)+n.get(l+1,o+1);(u===4||u===0)&&i++}return i*e.N2},t.getPenaltyN3=function(n){const a=n.size;let i=0,l=0,o=0;for(let u=0;u<a;u++){l=o=0;for(let d=0;d<a;d++)l=l<<1&2047|n.get(u,d),d>=10&&(l===1488||l===93)&&i++,o=o<<1&2047|n.get(d,u),d>=10&&(o===1488||o===93)&&i++}return i*e.N3},t.getPenaltyN4=function(n){let a=0;const i=n.data.length;for(let o=0;o<i;o++)a+=n.data[o];return Math.abs(Math.ceil(a*100/i/5)-10)*e.N4};function r(s,n,a){switch(s){case t.Patterns.PATTERN000:return(n+a)%2===0;case t.Patterns.PATTERN001:return n%2===0;case t.Patterns.PATTERN010:return a%3===0;case t.Patterns.PATTERN011:return(n+a)%3===0;case t.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(a/3))%2===0;case t.Patterns.PATTERN101:return n*a%2+n*a%3===0;case t.Patterns.PATTERN110:return(n*a%2+n*a%3)%2===0;case t.Patterns.PATTERN111:return(n*a%3+(n+a)%2)%2===0;default:throw new Error("bad maskPattern:"+s)}}t.applyMask=function(n,a){const i=a.size;for(let l=0;l<i;l++)for(let o=0;o<i;o++)a.isReserved(o,l)||a.xor(o,l,r(n,o,l))},t.getBestMask=function(n,a){const i=Object.keys(t.Patterns).length;let l=0,o=1/0;for(let u=0;u<i;u++){a(u),t.applyMask(u,n);const d=t.getPenaltyN1(n)+t.getPenaltyN2(n)+t.getPenaltyN3(n)+t.getPenaltyN4(n);t.applyMask(u,n),d<o&&(o=d,l=u)}return l}})(Ds);var Ot={};const pe=At,gt=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],mt=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Ot.getBlocksCount=function(e,r){switch(r){case pe.L:return gt[(e-1)*4+0];case pe.M:return gt[(e-1)*4+1];case pe.Q:return gt[(e-1)*4+2];case pe.H:return gt[(e-1)*4+3];default:return}};Ot.getTotalCodewordsCount=function(e,r){switch(r){case pe.L:return mt[(e-1)*4+0];case pe.M:return mt[(e-1)*4+1];case pe.Q:return mt[(e-1)*4+2];case pe.H:return mt[(e-1)*4+3];default:return}};var $s={},Pt={};const et=new Uint8Array(512),_t=new Uint8Array(256);(function(){let e=1;for(let r=0;r<255;r++)et[r]=e,_t[e]=r,e<<=1,e&256&&(e^=285);for(let r=255;r<512;r++)et[r]=et[r-255]})();Pt.log=function(e){if(e<1)throw new Error("log("+e+")");return _t[e]};Pt.exp=function(e){return et[e]};Pt.mul=function(e,r){return e===0||r===0?0:et[_t[e]+_t[r]]};(function(t){const e=Pt;t.mul=function(s,n){const a=new Uint8Array(s.length+n.length-1);for(let i=0;i<s.length;i++)for(let l=0;l<n.length;l++)a[i+l]^=e.mul(s[i],n[l]);return a},t.mod=function(s,n){let a=new Uint8Array(s);for(;a.length-n.length>=0;){const i=a[0];for(let o=0;o<n.length;o++)a[o]^=e.mul(n[o],i);let l=0;for(;l<a.length&&a[l]===0;)l++;a=a.slice(l)}return a},t.generateECPolynomial=function(s){let n=new Uint8Array([1]);for(let a=0;a<s;a++)n=t.mul(n,new Uint8Array([1,e.exp(a)]));return n}})($s);const Ls=$s;function kr(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}kr.prototype.initialize=function(e){this.degree=e,this.genPoly=Ls.generateECPolynomial(this.degree)};kr.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(e.length+this.degree);r.set(e);const s=Ls.mod(r,this.genPoly),n=this.degree-s.length;if(n>0){const a=new Uint8Array(this.degree);return a.set(s,n),a}return s};var Ha=kr,Us={},ye={},jr={};jr.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var oe={};const Bs="[0-9]+",Va="[A-Z $%*+\\-./:]+";let st="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";st=st.replace(/u/g,"\\u");const qa="(?:(?![A-Z0-9 $%*+\\-./:]|"+st+`)(?:.|[\r
]))+`;oe.KANJI=new RegExp(st,"g");oe.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");oe.BYTE=new RegExp(qa,"g");oe.NUMERIC=new RegExp(Bs,"g");oe.ALPHANUMERIC=new RegExp(Va,"g");const Ka=new RegExp("^"+st+"$"),Wa=new RegExp("^"+Bs+"$"),Ga=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");oe.testKanji=function(e){return Ka.test(e)};oe.testNumeric=function(e){return Wa.test(e)};oe.testAlphanumeric=function(e){return Ga.test(e)};(function(t){const e=jr,r=oe;t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(a,i){if(!a.ccBits)throw new Error("Invalid mode: "+a);if(!e.isValid(i))throw new Error("Invalid version: "+i);return i>=1&&i<10?a.ccBits[0]:i<27?a.ccBits[1]:a.ccBits[2]},t.getBestModeForData=function(a){return r.testNumeric(a)?t.NUMERIC:r.testAlphanumeric(a)?t.ALPHANUMERIC:r.testKanji(a)?t.KANJI:t.BYTE},t.toString=function(a){if(a&&a.id)return a.id;throw new Error("Invalid mode")},t.isValid=function(a){return a&&a.bit&&a.ccBits};function s(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+n)}}t.from=function(a,i){if(t.isValid(a))return a;try{return s(a)}catch{return i}}})(ye);(function(t){const e=te,r=Ot,s=At,n=ye,a=jr,i=7973,l=e.getBCHDigit(i);function o(f,g,m){for(let p=1;p<=40;p++)if(g<=t.getCapacity(p,m,f))return p}function u(f,g){return n.getCharCountIndicator(f,g)+4}function d(f,g){let m=0;return f.forEach(function(p){const b=u(p.mode,g);m+=b+p.getBitsLength()}),m}function h(f,g){for(let m=1;m<=40;m++)if(d(f,m)<=t.getCapacity(m,g,n.MIXED))return m}t.from=function(g,m){return a.isValid(g)?parseInt(g,10):m},t.getCapacity=function(g,m,p){if(!a.isValid(g))throw new Error("Invalid QR Code version");typeof p>"u"&&(p=n.BYTE);const b=e.getSymbolTotalCodewords(g),y=r.getTotalCodewordsCount(g,m),v=(b-y)*8;if(p===n.MIXED)return v;const w=v-u(p,g);switch(p){case n.NUMERIC:return Math.floor(w/10*3);case n.ALPHANUMERIC:return Math.floor(w/11*2);case n.KANJI:return Math.floor(w/13);case n.BYTE:default:return Math.floor(w/8)}},t.getBestVersionForData=function(g,m){let p;const b=s.from(m,s.M);if(Array.isArray(g)){if(g.length>1)return h(g,b);if(g.length===0)return 1;p=g[0]}else p=g;return o(p.mode,p.getLength(),b)},t.getEncodedBits=function(g){if(!a.isValid(g)||g<7)throw new Error("Invalid QR Code version");let m=g<<12;for(;e.getBCHDigit(m)-l>=0;)m^=i<<e.getBCHDigit(m)-l;return g<<12|m}})(Us);var Ms={};const sr=te,zs=1335,Ja=21522,Mr=sr.getBCHDigit(zs);Ms.getEncodedBits=function(e,r){const s=e.bit<<3|r;let n=s<<10;for(;sr.getBCHDigit(n)-Mr>=0;)n^=zs<<sr.getBCHDigit(n)-Mr;return(s<<10|n)^Ja};var Fs={};const Qa=ye;function Ve(t){this.mode=Qa.NUMERIC,this.data=t.toString()}Ve.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};Ve.prototype.getLength=function(){return this.data.length};Ve.prototype.getBitsLength=function(){return Ve.getBitsLength(this.data.length)};Ve.prototype.write=function(e){let r,s,n;for(r=0;r+3<=this.data.length;r+=3)s=this.data.substr(r,3),n=parseInt(s,10),e.put(n,10);const a=this.data.length-r;a>0&&(s=this.data.substr(r),n=parseInt(s,10),e.put(n,a*3+1))};var Ya=Ve;const Xa=ye,Mt=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function qe(t){this.mode=Xa.ALPHANUMERIC,this.data=t}qe.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};qe.prototype.getLength=function(){return this.data.length};qe.prototype.getBitsLength=function(){return qe.getBitsLength(this.data.length)};qe.prototype.write=function(e){let r;for(r=0;r+2<=this.data.length;r+=2){let s=Mt.indexOf(this.data[r])*45;s+=Mt.indexOf(this.data[r+1]),e.put(s,11)}this.data.length%2&&e.put(Mt.indexOf(this.data[r]),6)};var Za=qe;const ei=ye;function Ke(t){this.mode=ei.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}Ke.getBitsLength=function(e){return e*8};Ke.prototype.getLength=function(){return this.data.length};Ke.prototype.getBitsLength=function(){return Ke.getBitsLength(this.data.length)};Ke.prototype.write=function(t){for(let e=0,r=this.data.length;e<r;e++)t.put(this.data[e],8)};var ti=Ke;const ri=ye,si=te;function We(t){this.mode=ri.KANJI,this.data=t}We.getBitsLength=function(e){return e*13};We.prototype.getLength=function(){return this.data.length};We.prototype.getBitsLength=function(){return We.getBitsLength(this.data.length)};We.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let r=si.toSJIS(this.data[e]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),t.put(r,13)}};var ni=We,Hs={exports:{}};(function(t){var e={single_source_shortest_paths:function(r,s,n){var a={},i={};i[s]=0;var l=e.PriorityQueue.make();l.push(s,0);for(var o,u,d,h,f,g,m,p,b;!l.empty();){o=l.pop(),u=o.value,h=o.cost,f=r[u]||{};for(d in f)f.hasOwnProperty(d)&&(g=f[d],m=h+g,p=i[d],b=typeof i[d]>"u",(b||p>m)&&(i[d]=m,l.push(d,m),a[d]=u))}if(typeof n<"u"&&typeof i[n]>"u"){var y=["Could not find a path from ",s," to ",n,"."].join("");throw new Error(y)}return a},extract_shortest_path_from_predecessor_list:function(r,s){for(var n=[],a=s;a;)n.push(a),r[a],a=r[a];return n.reverse(),n},find_path:function(r,s,n){var a=e.single_source_shortest_paths(r,s,n);return e.extract_shortest_path_from_predecessor_list(a,n)},PriorityQueue:{make:function(r){var s=e.PriorityQueue,n={},a;r=r||{};for(a in s)s.hasOwnProperty(a)&&(n[a]=s[a]);return n.queue=[],n.sorter=r.sorter||s.default_sorter,n},default_sorter:function(r,s){return r.cost-s.cost},push:function(r,s){var n={value:r,cost:s};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=e})(Hs);var ai=Hs.exports;(function(t){const e=ye,r=Ya,s=Za,n=ti,a=ni,i=oe,l=te,o=ai;function u(y){return unescape(encodeURIComponent(y)).length}function d(y,v,w){const x=[];let j;for(;(j=y.exec(w))!==null;)x.push({data:j[0],index:j.index,mode:v,length:j[0].length});return x}function h(y){const v=d(i.NUMERIC,e.NUMERIC,y),w=d(i.ALPHANUMERIC,e.ALPHANUMERIC,y);let x,j;return l.isKanjiModeEnabled()?(x=d(i.BYTE,e.BYTE,y),j=d(i.KANJI,e.KANJI,y)):(x=d(i.BYTE_KANJI,e.BYTE,y),j=[]),v.concat(w,x,j).sort(function(R,O){return R.index-O.index}).map(function(R){return{data:R.data,mode:R.mode,length:R.length}})}function f(y,v){switch(v){case e.NUMERIC:return r.getBitsLength(y);case e.ALPHANUMERIC:return s.getBitsLength(y);case e.KANJI:return a.getBitsLength(y);case e.BYTE:return n.getBitsLength(y)}}function g(y){return y.reduce(function(v,w){const x=v.length-1>=0?v[v.length-1]:null;return x&&x.mode===w.mode?(v[v.length-1].data+=w.data,v):(v.push(w),v)},[])}function m(y){const v=[];for(let w=0;w<y.length;w++){const x=y[w];switch(x.mode){case e.NUMERIC:v.push([x,{data:x.data,mode:e.ALPHANUMERIC,length:x.length},{data:x.data,mode:e.BYTE,length:x.length}]);break;case e.ALPHANUMERIC:v.push([x,{data:x.data,mode:e.BYTE,length:x.length}]);break;case e.KANJI:v.push([x,{data:x.data,mode:e.BYTE,length:u(x.data)}]);break;case e.BYTE:v.push([{data:x.data,mode:e.BYTE,length:u(x.data)}])}}return v}function p(y,v){const w={},x={start:{}};let j=["start"];for(let S=0;S<y.length;S++){const R=y[S],O=[];for(let $=0;$<R.length;$++){const W=R[$],E=""+S+$;O.push(E),w[E]={node:W,lastCount:0},x[E]={};for(let _=0;_<j.length;_++){const C=j[_];w[C]&&w[C].node.mode===W.mode?(x[C][E]=f(w[C].lastCount+W.length,W.mode)-f(w[C].lastCount,W.mode),w[C].lastCount+=W.length):(w[C]&&(w[C].lastCount=W.length),x[C][E]=f(W.length,W.mode)+4+e.getCharCountIndicator(W.mode,v))}}j=O}for(let S=0;S<j.length;S++)x[j[S]].end=0;return{map:x,table:w}}function b(y,v){let w;const x=e.getBestModeForData(y);if(w=e.from(v,x),w!==e.BYTE&&w.bit<x.bit)throw new Error('"'+y+'" cannot be encoded with mode '+e.toString(w)+`.
 Suggested mode is: `+e.toString(x));switch(w===e.KANJI&&!l.isKanjiModeEnabled()&&(w=e.BYTE),w){case e.NUMERIC:return new r(y);case e.ALPHANUMERIC:return new s(y);case e.KANJI:return new a(y);case e.BYTE:return new n(y)}}t.fromArray=function(v){return v.reduce(function(w,x){return typeof x=="string"?w.push(b(x,null)):x.data&&w.push(b(x.data,x.mode)),w},[])},t.fromString=function(v,w){const x=h(v,l.isKanjiModeEnabled()),j=m(x),S=p(j,w),R=o.find_path(S.map,"start","end"),O=[];for(let $=1;$<R.length-1;$++)O.push(S.table[R[$]].node);return t.fromArray(g(O))},t.rawSplit=function(v){return t.fromArray(h(v,l.isKanjiModeEnabled()))}})(Fs);const Dt=te,zt=At,ii=Ma,oi=za,li=Os,ci=Ps,nr=Ds,ar=Ot,ui=Ha,Et=Us,di=Ms,hi=ye,Ft=Fs;function fi(t,e){const r=t.size,s=ci.getPositions(e);for(let n=0;n<s.length;n++){const a=s[n][0],i=s[n][1];for(let l=-1;l<=7;l++)if(!(a+l<=-1||r<=a+l))for(let o=-1;o<=7;o++)i+o<=-1||r<=i+o||(l>=0&&l<=6&&(o===0||o===6)||o>=0&&o<=6&&(l===0||l===6)||l>=2&&l<=4&&o>=2&&o<=4?t.set(a+l,i+o,!0,!0):t.set(a+l,i+o,!1,!0))}}function gi(t){const e=t.size;for(let r=8;r<e-8;r++){const s=r%2===0;t.set(r,6,s,!0),t.set(6,r,s,!0)}}function mi(t,e){const r=li.getPositions(e);for(let s=0;s<r.length;s++){const n=r[s][0],a=r[s][1];for(let i=-2;i<=2;i++)for(let l=-2;l<=2;l++)i===-2||i===2||l===-2||l===2||i===0&&l===0?t.set(n+i,a+l,!0,!0):t.set(n+i,a+l,!1,!0)}}function pi(t,e){const r=t.size,s=Et.getEncodedBits(e);let n,a,i;for(let l=0;l<18;l++)n=Math.floor(l/3),a=l%3+r-8-3,i=(s>>l&1)===1,t.set(n,a,i,!0),t.set(a,n,i,!0)}function Ht(t,e,r){const s=t.size,n=di.getEncodedBits(e,r);let a,i;for(a=0;a<15;a++)i=(n>>a&1)===1,a<6?t.set(a,8,i,!0):a<8?t.set(a+1,8,i,!0):t.set(s-15+a,8,i,!0),a<8?t.set(8,s-a-1,i,!0):a<9?t.set(8,15-a-1+1,i,!0):t.set(8,15-a-1,i,!0);t.set(s-8,8,1,!0)}function wi(t,e){const r=t.size;let s=-1,n=r-1,a=7,i=0;for(let l=r-1;l>0;l-=2)for(l===6&&l--;;){for(let o=0;o<2;o++)if(!t.isReserved(n,l-o)){let u=!1;i<e.length&&(u=(e[i]>>>a&1)===1),t.set(n,l-o,u),a--,a===-1&&(i++,a=7)}if(n+=s,n<0||r<=n){n-=s,s=-s;break}}}function bi(t,e,r){const s=new ii;r.forEach(function(o){s.put(o.mode.bit,4),s.put(o.getLength(),hi.getCharCountIndicator(o.mode,t)),o.write(s)});const n=Dt.getSymbolTotalCodewords(t),a=ar.getTotalCodewordsCount(t,e),i=(n-a)*8;for(s.getLengthInBits()+4<=i&&s.put(0,4);s.getLengthInBits()%8!==0;)s.putBit(0);const l=(i-s.getLengthInBits())/8;for(let o=0;o<l;o++)s.put(o%2?17:236,8);return yi(s,t,e)}function yi(t,e,r){const s=Dt.getSymbolTotalCodewords(e),n=ar.getTotalCodewordsCount(e,r),a=s-n,i=ar.getBlocksCount(e,r),l=s%i,o=i-l,u=Math.floor(s/i),d=Math.floor(a/i),h=d+1,f=u-d,g=new ui(f);let m=0;const p=new Array(i),b=new Array(i);let y=0;const v=new Uint8Array(t.buffer);for(let R=0;R<i;R++){const O=R<o?d:h;p[R]=v.slice(m,m+O),b[R]=g.encode(p[R]),m+=O,y=Math.max(y,O)}const w=new Uint8Array(s);let x=0,j,S;for(j=0;j<y;j++)for(S=0;S<i;S++)j<p[S].length&&(w[x++]=p[S][j]);for(j=0;j<f;j++)for(S=0;S<i;S++)w[x++]=b[S][j];return w}function vi(t,e,r,s){let n;if(Array.isArray(t))n=Ft.fromArray(t);else if(typeof t=="string"){let u=e;if(!u){const d=Ft.rawSplit(t);u=Et.getBestVersionForData(d,r)}n=Ft.fromString(t,u||40)}else throw new Error("Invalid data");const a=Et.getBestVersionForData(n,r);if(!a)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=a;else if(e<a)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+a+`.
`);const i=bi(e,r,n),l=Dt.getSymbolSize(e),o=new oi(l);return fi(o,e),gi(o),mi(o,e),Ht(o,r,0),e>=7&&pi(o,e),wi(o,i),isNaN(s)&&(s=nr.getBestMask(o,Ht.bind(null,o,r))),nr.applyMask(s,o),Ht(o,r,s),{modules:o,version:e,errorCorrectionLevel:r,maskPattern:s,segments:n}}Rs.create=function(e,r){if(typeof e>"u"||e==="")throw new Error("No input text");let s=zt.M,n,a;return typeof r<"u"&&(s=zt.from(r.errorCorrectionLevel,zt.M),n=Et.from(r.version),a=nr.from(r.maskPattern),r.toSJISFunc&&Dt.setToSJISFunction(r.toSJISFunc)),vi(e,n,s,a)};var Vs={},Sr={};(function(t){function e(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let s=r.slice().replace("#","").split("");if(s.length<3||s.length===5||s.length>8)throw new Error("Invalid hex color: "+r);(s.length===3||s.length===4)&&(s=Array.prototype.concat.apply([],s.map(function(a){return[a,a]}))),s.length===6&&s.push("F","F");const n=parseInt(s.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:n&255,hex:"#"+s.slice(0,6).join("")}}t.getOptions=function(s){s||(s={}),s.color||(s.color={});const n=typeof s.margin>"u"||s.margin===null||s.margin<0?4:s.margin,a=s.width&&s.width>=21?s.width:void 0,i=s.scale||4;return{width:a,scale:a?4:i,margin:n,color:{dark:e(s.color.dark||"#000000ff"),light:e(s.color.light||"#ffffffff")},type:s.type,rendererOpts:s.rendererOpts||{}}},t.getScale=function(s,n){return n.width&&n.width>=s+n.margin*2?n.width/(s+n.margin*2):n.scale},t.getImageWidth=function(s,n){const a=t.getScale(s,n);return Math.floor((s+n.margin*2)*a)},t.qrToImageData=function(s,n,a){const i=n.modules.size,l=n.modules.data,o=t.getScale(i,a),u=Math.floor((i+a.margin*2)*o),d=a.margin*o,h=[a.color.light,a.color.dark];for(let f=0;f<u;f++)for(let g=0;g<u;g++){let m=(f*u+g)*4,p=a.color.light;if(f>=d&&g>=d&&f<u-d&&g<u-d){const b=Math.floor((f-d)/o),y=Math.floor((g-d)/o);p=h[l[b*i+y]?1:0]}s[m++]=p.r,s[m++]=p.g,s[m++]=p.b,s[m]=p.a}}})(Sr);(function(t){const e=Sr;function r(n,a,i){n.clearRect(0,0,a.width,a.height),a.style||(a.style={}),a.height=i,a.width=i,a.style.height=i+"px",a.style.width=i+"px"}function s(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(a,i,l){let o=l,u=i;typeof o>"u"&&(!i||!i.getContext)&&(o=i,i=void 0),i||(u=s()),o=e.getOptions(o);const d=e.getImageWidth(a.modules.size,o),h=u.getContext("2d"),f=h.createImageData(d,d);return e.qrToImageData(f.data,a,o),r(h,u,d),h.putImageData(f,0,0),u},t.renderToDataURL=function(a,i,l){let o=l;typeof o>"u"&&(!i||!i.getContext)&&(o=i,i=void 0),o||(o={});const u=t.render(a,i,o),d=o.type||"image/png",h=o.rendererOpts||{};return u.toDataURL(d,h.quality)}})(Vs);var qs={};const xi=Sr;function zr(t,e){const r=t.a/255,s=e+'="'+t.hex+'"';return r<1?s+" "+e+'-opacity="'+r.toFixed(2).slice(1)+'"':s}function Vt(t,e,r){let s=t+e;return typeof r<"u"&&(s+=" "+r),s}function _i(t,e,r){let s="",n=0,a=!1,i=0;for(let l=0;l<t.length;l++){const o=Math.floor(l%e),u=Math.floor(l/e);!o&&!a&&(a=!0),t[l]?(i++,l>0&&o>0&&t[l-1]||(s+=a?Vt("M",o+r,.5+u+r):Vt("m",n,0),n=0,a=!1),o+1<e&&t[l+1]||(s+=Vt("h",i),i=0)):n++}return s}qs.render=function(e,r,s){const n=xi.getOptions(r),a=e.modules.size,i=e.modules.data,l=a+n.margin*2,o=n.color.light.a?"<path "+zr(n.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",u="<path "+zr(n.color.dark,"stroke")+' d="'+_i(i,a,n.margin)+'"/>',d='viewBox="0 0 '+l+" "+l+'"',f='<svg xmlns="http://www.w3.org/2000/svg" '+(n.width?'width="'+n.width+'" height="'+n.width+'" ':"")+d+' shape-rendering="crispEdges">'+o+u+`</svg>
`;return typeof s=="function"&&s(null,f),f};const Ei=Ua,ir=Rs,Ks=Vs,ki=qs;function Cr(t,e,r,s,n){const a=[].slice.call(arguments,1),i=a.length,l=typeof a[i-1]=="function";if(!l&&!Ei())throw new Error("Callback required as last argument");if(l){if(i<2)throw new Error("Too few arguments provided");i===2?(n=r,r=e,e=s=void 0):i===3&&(e.getContext&&typeof n>"u"?(n=s,s=void 0):(n=s,s=r,r=e,e=void 0))}else{if(i<1)throw new Error("Too few arguments provided");return i===1?(r=e,e=s=void 0):i===2&&!e.getContext&&(s=r,r=e,e=void 0),new Promise(function(o,u){try{const d=ir.create(r,s);o(t(d,e,s))}catch(d){u(d)}})}try{const o=ir.create(r,s);n(null,t(o,e,s))}catch(o){n(o)}}He.create=ir.create;He.toCanvas=Cr.bind(null,Ks.render);He.toDataURL=Cr.bind(null,Ks.renderToDataURL);He.toString=Cr.bind(null,function(t,e,r){return ki.render(t,r)});function ji(t){return U({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M2 22l14-5-9-9zM14.53 12.53l5.59-5.59a1.25 1.25 0 011.77 0l.59.59 1.06-1.06-.59-.59a2.758 2.758 0 00-3.89 0l-5.59 5.59 1.06 1.06zM10.06 6.88l-.59.59 1.06 1.06.59-.59a2.758 2.758 0 000-3.89l-.59-.59-1.06 1.07.59.59c.48.48.48 1.28 0 1.76zM17.06 11.88l-1.59 1.59 1.06 1.06 1.59-1.59a1.25 1.25 0 011.77 0l1.61 1.61 1.06-1.06-1.61-1.61a2.758 2.758 0 00-3.89 0zM15.06 5.88l-3.59 3.59 1.06 1.06 3.59-3.59a2.758 2.758 0 000-3.89l-1.59-1.59-1.06 1.06 1.59 1.59c.48.49.48 1.29 0 1.77z"}}]})(t)}function Si(t){return U({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M122.7 23.32l1.7 21.87-16.7 14.25 21.4 5.17 8.4 20.25L149 66.18l21.8-1.75-14.2-16.71 5.1-21.32-20.3 8.35-18.7-11.43zM464 32a16 16 0 0 0-16 16 16 16 0 0 0 16 16 16 16 0 0 0 16-16 16 16 0 0 0-16-16zM239.8 42.5a16 16 0 0 0-16 16 16 16 0 0 0 16 16 16 16 0 0 0 16-16 16 16 0 0 0-16-16zm183.9 6.84c-9.2 1.74-17.7 7.18-25.9 14.28-7.6 6.53-14.7 14.66-20.7 23.45-18.8 3.01-37.6 10.67-50.2 21.13-16.1 13.2-30.4 35.8-38.2 59.1-7.4 3.1-14.4 6.8-20.1 10.8-15.5 10.9-23.5 31.8-29.4 50-5.9 18.3-8.8 34.3-8.8 34.3l17.8 3.2s2.7-15 8.1-31.9c5.5-16.9 14.8-35.3 22.7-40.8 1.3-.9 3-1.9 4.5-2.8-.6 5.7-.6 11.4.3 16.8 1.8 11.4 8 22.3 19 28.2 7.8 4.2 16.6 3.2 24 .2 7.4-3.1 14-8.2 19.7-14.2 5.7-6 10.4-13.1 13.2-20.6 2.8-7.5 3.8-16 .2-23.9h-.1c-3.9-8.4-11.4-13.8-19.4-16.1-8-2.3-16.6-2.2-25.2-.9-1.5.2-2.9.7-4.4 1 7.4-15.8 18-30.7 27.5-38.6 6.2-5.1 16.6-10 27.7-13.6-1.4 3.8-2.5 7.6-3 11.5-1.6 10.5.7 21.9 9.1 29.7 6.1 5.6 14.3 6.5 21.5 5.3 7.1-1.2 14-4.4 20.2-8.5 6.2-4.2 11.7-9.4 15.6-15.5 3.9-6.1 6.5-13.9 4-21.7v-.1c-3.3-10.07-11.5-16.99-20.6-20.27-3.9-1.4-8-2.19-12.2-2.66 2.9-3.26 5.9-6.31 8.9-8.92 6.8-5.84 13.7-9.5 17.6-10.23l-3.4-17.68zM174.8 84.39l-15.2 9.56 34.5 55.25-56.4 2.9 26.5 57.8 16.4-7.6-15.5-33.6 60.6-3.1-50.9-81.21zm216.4 19.31c6.1-.1 11.5.6 15.5 2.1 5.4 1.9 8.1 4.3 9.5 8.8.4 1.1.2 3.3-1.9 6.6-2.2 3.4-6.1 7.2-10.5 10.2-4.5 3-9.5 5.1-13.2 5.7-3.8.7-5.5 0-6.3-.7-3.5-3.2-4.5-7.2-3.5-13.9.8-5.4 3.3-11.9 7-18.6 1.2 0 2.3-.2 3.4-.2zM94.99 123a16 16 0 0 0-16 16 16 16 0 0 0 16 16A16 16 0 0 0 111 139a16 16 0 0 0-16.01-16zm356.11 37.2l-14.4 16.6-21.8-1.8 11.4 18.8-8.5 20.2 21.4-5 16.6 14.3 1.9-21.9 18.7-11.4-20.2-8.5-5.1-21.3zm-123.5 16.5c2.9.1 5.6.5 7.7 1.1 4.3 1.2 6.6 3 8.2 6.4.9 1.9 1 5.4-.7 10-1.7 4.7-5.2 10.1-9.4 14.6s-9.3 8.1-13.5 9.8c-4.2 1.7-6.8 1.6-8.5.7h-.1c-5.8-3.2-8.6-7.8-9.7-15.2-1-6.3-.3-14.3 1.8-22.9 4.9-1.7 9.8-3.1 14.5-3.8 3.5-.5 6.7-.7 9.7-.7zm-202.4 51.9c-7.2-.2-11.7 1.5-14.5 4.3-2.8 2.8-4.5 7.3-4.3 14.5.2 7.3 2.6 16.9 7.2 27.6 9.2 21.5 27.3 47.4 51.6 71.8 24.3 24.3 50.3 42.3 71.8 51.5 10.6 4.6 20.2 7 27.5 7.2 7.3.3 11.7-1.5 14.5-4.3 2.8-2.8 4.6-7.2 4.3-14.5-.2-7.3-2.6-16.9-7.2-27.6-9.2-21.4-27.2-47.4-51.5-71.7-24.3-24.4-50.3-42.4-71.8-51.6-10.7-4.6-20.3-7-27.6-7.2zm232 31.3l-33 54-29.1-27.9-12.4 13 45.1 43.3 33.8-55.2 38.7 32.3 89.3-38.2-7-16.6-79.3 34-46.1-38.7zM93.43 272.6l-17.64 57.9c41.41 49.1 89.71 76.7 142.11 94.7l21.6-6.6c-3.1-1.1-6.4-2.4-9.7-3.8-24.4-10.4-51.7-29.6-77.3-55.3-25.7-25.7-44.9-53-55.34-77.4-1.41-3.2-2.65-6.4-3.73-9.5zm-23.82 78.2l-14.01 46c28.89 27 59 39.2 90.6 50.2l43.4-13.2c-43.2-17.6-84-43.3-119.99-83zM368 352a16 16 0 0 0-16 16 16 16 0 0 0 16 16 16 16 0 0 0 16-16 16 16 0 0 0-16-16zM49.81 415.9l-20.29 66.6 88.28-26.9c-22.77-9.1-45.78-20.7-67.99-39.7z"}}]})(t)}function Ci(t){return U({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M23 7a8.44 8.44 0 0 0-5 1.31c-.36-.41-.73-.82-1.12-1.21l-.29-.27.14-.12a3.15 3.15 0 0 0 .9-3.49A3.9 3.9 0 0 0 14 1v2a2 2 0 0 1 1.76 1c.17.4 0 .84-.47 1.31l-.23.21a16.71 16.71 0 0 0-3.41-2.2c-2.53-1.14-3.83-.61-4.47 0a2.18 2.18 0 0 0-.46.68l-.18.53L5.1 8.87C6.24 11.71 9 16.76 15 18.94l5-1.66a1 1 0 0 0 .43-.31l.21-.18c1.43-1.44.51-4.21-1.41-6.9A6.63 6.63 0 0 1 23 9zm-3.79 8.37h-.06c-.69.37-3.55-.57-6.79-3.81-.34-.34-.66-.67-.95-1-.1-.11-.19-.23-.29-.35l-.53-.64-.28-.39c-.14-.19-.28-.38-.4-.56s-.16-.26-.24-.39-.22-.34-.31-.51-.13-.24-.19-.37-.17-.28-.23-.42-.09-.23-.14-.34-.11-.27-.15-.4S8.6 6 8.58 5.9s-.06-.24-.08-.34a2 2 0 0 1 0-.24 1.15 1.15 0 0 1 0-.26l.11-.31c.17-.18.91-.23 2.23.37a13.83 13.83 0 0 1 2.49 1.54A4.17 4.17 0 0 1 12 7v2a6.43 6.43 0 0 0 3-.94l.49.46c.44.43.83.86 1.19 1.27A5.31 5.31 0 0 0 16 13.2l2-.39a3.23 3.23 0 0 1 0-1.14c1.29 1.97 1.53 3.39 1.21 3.7zM4.4 11l-2.23 6.7A3.28 3.28 0 0 0 5.28 22a3.21 3.21 0 0 0 1-.17l6.52-2.17A18.7 18.7 0 0 1 4.4 11z"}}]})(t)}const Ni={FaBirthdayCake:ka,GiPartyPopper:Si,FaGift:Na,FaHourglassHalf:xr,FaHeart:Ta,FaRocket:Oa,MdCelebration:ji,FaSnowman:$a,BiSolidParty:Ci},Ge=({iconKey:t="FaHourglassHalf",color:e="currentColor",size:r="1.5em",className:s="",animate:n=!1})=>{const a=Ni[t]||xr;return c.jsx("div",{className:`inline-flex items-center justify-center ${n?"animate-float":""} ${s}`,children:c.jsx(a,{style:{color:e,fontSize:r}})})},Ws=()=>[{name:"Pastel",key:"FaBirthdayCake",type:"birthday"},{name:"Fiesta",key:"GiPartyPopper",type:"party"},{name:"Regalo",key:"FaGift",type:"gift"},{name:"Reloj",key:"FaHourglassHalf",type:"hourglass"},{name:"Corazón",key:"FaHeart",type:"love"},{name:"Cohete",key:"FaRocket",type:"rocket"},{name:"Celebración",key:"MdCelebration",type:"celebration"},{name:"Navidad",key:"FaSnowman",type:"christmas"},{name:"Evento",key:"BiSolidParty",type:"event"}];function $t(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r}function Ti(t,e,r,s){function n(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function l(d){try{u(s.next(d))}catch(h){i(h)}}function o(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(l,o)}u((s=s.apply(t,e||[])).next())})}const Ii=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Nr extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class Ri extends Nr{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Fr extends Nr{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Hr extends Nr{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var or;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(or||(or={}));class Ai{constructor(e,{headers:r={},customFetch:s,region:n=or.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=Ii(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Ti(this,arguments,void 0,function*(r,s={}){var n;let a,i;try{const{headers:l,method:o,body:u,signal:d,timeout:h}=s;let f={},{region:g}=s;g||(g=this.region);const m=new URL(`${this.url}/${r}`);g&&g!=="any"&&(f["x-region"]=g,m.searchParams.set("forceFunctionRegion",g));let p;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",p=u):typeof u=="string"?(f["Content-Type"]="text/plain",p=u):typeof FormData<"u"&&u instanceof FormData?p=u:(f["Content-Type"]="application/json",p=JSON.stringify(u)):p=u;let b=d;h&&(i=new AbortController,a=setTimeout(()=>i.abort(),h),d?(b=i.signal,d.addEventListener("abort",()=>i.abort())):b=i.signal);const y=yield this.fetch(m.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:p,signal:b}).catch(j=>{throw new Ri(j)}),v=y.headers.get("x-relay-error");if(v&&v==="true")throw new Fr(y);if(!y.ok)throw new Hr(y);let w=((n=y.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),x;return w==="application/json"?x=yield y.json():w==="application/octet-stream"||w==="application/pdf"?x=yield y.blob():w==="text/event-stream"?x=y:w==="multipart/form-data"?x=yield y.formData():x=yield y.text(),{data:x,error:null,response:y}}catch(l){return{data:null,error:l,response:l instanceof Hr||l instanceof Fr?l.context:void 0}}finally{a&&clearTimeout(a)}})}}var Oi=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},Pi=class{constructor(t){var e,r;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(r=t.isMaybeSingle)!==null&&r!==void 0?r:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{let i=null,l=null,o=null,u=a.status,d=a.statusText;if(a.ok){var h,f;if(r.method!=="HEAD"){var g;const y=await a.text();y===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((g=r.headers.get("Accept"))===null||g===void 0)&&g.includes("application/vnd.pgrst.plan+text"))?l=y:l=JSON.parse(y))}const p=(h=r.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),b=(f=a.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");p&&b&&b.length>1&&(o=parseInt(b[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(l)&&(l.length>1?(i={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,o=null,u=406,d="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var m;const p=await a.text();try{i=JSON.parse(p),Array.isArray(i)&&a.status===404&&(l=[],i=null,u=200,d="OK")}catch{a.status===404&&p===""?(u=204,d="No Content"):i={message:p}}if(i&&r.isMaybeSingle&&(!(i==null||(m=i.details)===null||m===void 0)&&m.includes("0 rows"))&&(i=null,u=200,d="OK"),i&&r.shouldThrowOnError)throw new Oi(i)}return{error:i,data:l,count:o,status:u,statusText:d}});return this.shouldThrowOnError||(n=n.catch(a=>{var i;let l="";const o=a==null?void 0:a.cause;if(o){var u,d,h,f;const m=(u=o==null?void 0:o.message)!==null&&u!==void 0?u:"",p=(d=o==null?void 0:o.code)!==null&&d!==void 0?d:"";l=`${(h=a==null?void 0:a.name)!==null&&h!==void 0?h:"FetchError"}: ${a==null?void 0:a.message}`,l+=`

Caused by: ${(f=o==null?void 0:o.name)!==null&&f!==void 0?f:"Error"}: ${m}`,p&&(l+=` (${p})`),o!=null&&o.stack&&(l+=`
${o.stack}`)}else{var g;l=(g=a==null?void 0:a.stack)!==null&&g!==void 0?g:""}return{error:{message:`${(i=a==null?void 0:a.name)!==null&&i!==void 0?i:"FetchError"}: ${a==null?void 0:a.message}`,details:l,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),n.then(t,e)}returns(){return this}overrideTypes(){return this}},Di=class extends Pi{select(t){let e=!1;const r=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:s,referencedTable:n=s}={}){const a=n?`${n}.order`:"order",i=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${i?`${i},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:r=e}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:r,referencedTable:s=r}={}){const n=typeof s>"u"?"offset":`${s}.offset`,a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${t}`),this.url.searchParams.set(a,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:s=!1,wal:n=!1,format:a="text"}={}){var i;const l=[t?"analyze":null,e?"verbose":null,r?"settings":null,s?"buffers":null,n?"wal":null].filter(Boolean).join("|"),o=(i=this.headers.get("Accept"))!==null&&i!==void 0?i:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${o}"; options=${l};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Vr=new RegExp("[,()]");var Le=class extends Di{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const r=Array.from(new Set(e)).map(s=>typeof s=="string"&&Vr.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}notIn(t,e){const r=Array.from(new Set(e)).map(s=>typeof s=="string"&&Vr.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`not.in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:s}={}){let n="";s==="plain"?n="pl":s==="phrase"?n="ph":s==="websearch"&&(n="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${n}fts${a}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e,referencedTable:r=e}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}},$i=class{constructor(t,{headers:e={},schema:r,fetch:s}){this.url=t,this.headers=new Headers(e),this.schema=r,this.fetch=s}select(t,e){const{head:r=!1,count:s}=e??{},n=r?"HEAD":"GET";let a=!1;const i=(t??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",i),s&&this.headers.append("Prefer",`count=${s}`),new Le({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:r=!0}={}){var s;const n="POST";if(e&&this.headers.append("Prefer",`count=${e}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const a=t.reduce((i,l)=>i.concat(Object.keys(l)),[]);if(a.length>0){const i=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",i.join(","))}}return new Le({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:s,defaultToNull:n=!0}={}){var a;const i="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),s&&this.headers.append("Prefer",`count=${s}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((o,u)=>o.concat(Object.keys(u)),[]);if(l.length>0){const o=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",o.join(","))}}return new Le({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(t,{count:e}={}){var r;const s="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new Le({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:t}={}){var e;const r="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Le({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},Li=class Gs{constructor(e,{headers:r={},schema:s,fetch:n}={}){this.url=e,this.headers=new Headers(r),this.schemaName=s,this.fetch=n}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new $i(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Gs(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:s=!1,get:n=!1,count:a}={}){var i;let l;const o=new URL(`${this.url}/rpc/${e}`);let u;s||n?(l=s?"HEAD":"GET",Object.entries(r).filter(([h,f])=>f!==void 0).map(([h,f])=>[h,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([h,f])=>{o.searchParams.append(h,f)})):(l="POST",u=r);const d=new Headers(this.headers);return a&&d.set("Prefer",`count=${a}`),new Le({method:l,url:o,headers:d,schema:this.schemaName,body:u,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};class Ui{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,n=parseInt(s.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const s=this.getWebSocketConstructor();return new s(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Bi="2.89.0",Mi=`realtime-js/${Bi}`,Js="1.0.0",zi="2.0.0",qr=Js,lr=1e4,Fi=1e3,Hi=100;var fe;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(fe||(fe={}));var q;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(q||(q={}));var ne;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ne||(ne={}));var cr;(function(t){t.websocket="websocket"})(cr||(cr={}));var Ee;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ee||(Ee={}));class Vi{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,s;const n=(s=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var r,s;const n=(s=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:{},i=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,i)}_encodeUserBroadcastPush(e,r,s){var n,a;const i=e.topic,l=(n=e.ref)!==null&&n!==void 0?n:"",o=(a=e.join_ref)!==null&&a!==void 0?a:"",u=e.payload.event,d=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},h=Object.keys(d).length===0?"":JSON.stringify(d);if(o.length>255)throw new Error(`joinRef length ${o.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`topic length ${i.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+o.length+l.length+i.length+u.length+h.length,g=new ArrayBuffer(this.HEADER_LENGTH+f);let m=new DataView(g),p=0;m.setUint8(p++,this.KINDS.userBroadcastPush),m.setUint8(p++,o.length),m.setUint8(p++,l.length),m.setUint8(p++,i.length),m.setUint8(p++,u.length),m.setUint8(p++,h.length),m.setUint8(p++,r),Array.from(o,y=>m.setUint8(p++,y.charCodeAt(0))),Array.from(l,y=>m.setUint8(p++,y.charCodeAt(0))),Array.from(i,y=>m.setUint8(p++,y.charCodeAt(0))),Array.from(u,y=>m.setUint8(p++,y.charCodeAt(0))),Array.from(h,y=>m.setUint8(p++,y.charCodeAt(0)));var b=new Uint8Array(g.byteLength+s.byteLength);return b.set(new Uint8Array(g),0),b.set(new Uint8Array(s),g.byteLength),b.buffer}decode(e,r){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return r(s)}if(typeof e=="string"){const s=JSON.parse(e),[n,a,i,l,o]=s;return r({join_ref:n,ref:a,topic:i,event:l,payload:o})}return r({})}_binaryDecode(e){const r=new DataView(e),s=r.getUint8(0),n=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,n)}}_decodeUserBroadcast(e,r,s){const n=r.getUint8(1),a=r.getUint8(2),i=r.getUint8(3),l=r.getUint8(4);let o=this.HEADER_LENGTH+4;const u=s.decode(e.slice(o,o+n));o=o+n;const d=s.decode(e.slice(o,o+a));o=o+a;const h=s.decode(e.slice(o,o+i));o=o+i;const f=e.slice(o,e.byteLength),g=l===this.JSON_ENCODING?JSON.parse(s.decode(f)):f,m={type:this.BROADCAST_EVENT,event:d,payload:g};return i>0&&(m.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:m}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e==null?void 0:e.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>r.includes(s)))}}class Qs{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var B;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(B||(B={}));const Kr=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((a,i)=>(a[i]=qi(i,t,e,n),a),{}):{}},qi=(t,e,r,s)=>{const n=e.find(l=>l.name===t),a=n==null?void 0:n.type,i=r[t];return a&&!s.includes(a)?Ys(a,i):ur(i)},Ys=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return Ji(e,r)}switch(t){case B.bool:return Ki(e);case B.float4:case B.float8:case B.int2:case B.int4:case B.int8:case B.numeric:case B.oid:return Wi(e);case B.json:case B.jsonb:return Gi(e);case B.timestamp:return Qi(e);case B.abstime:case B.date:case B.daterange:case B.int4range:case B.int8range:case B.money:case B.reltime:case B.text:case B.time:case B.timestamptz:case B.timetz:case B.tsrange:case B.tstzrange:return ur(e);default:return ur(e)}},ur=t=>t,Ki=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Wi=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Gi=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},Ji=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let a;const i=t.slice(1,r);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(l=>Ys(e,l))}return t},Qi=t=>typeof t=="string"?t.replace(" ","T"):t,Xs=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class qt{constructor(e,r,s={},n=lr){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Wr;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Wr||(Wr={}));class tt{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:a,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=tt.syncState(this.state,n,a,i),this.pendingDiffs.forEach(o=>{this.state=tt.syncDiff(this.state,o,a,i)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},n=>{const{onJoin:a,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=tt.syncDiff(this.state,n,a,i),l())}),this.onJoin((n,a,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:i})}),this.onLeave((n,a,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const a=this.cloneDeep(e),i=this.transformState(r),l={},o={};return this.map(a,(u,d)=>{i[u]||(o[u]=d)}),this.map(i,(u,d)=>{const h=a[u];if(h){const f=d.map(b=>b.presence_ref),g=h.map(b=>b.presence_ref),m=d.filter(b=>g.indexOf(b.presence_ref)<0),p=h.filter(b=>f.indexOf(b.presence_ref)<0);m.length>0&&(l[u]=m),p.length>0&&(o[u]=p)}else l[u]=d}),this.syncDiff(a,{joins:l,leaves:o},s,n)}static syncDiff(e,r,s,n){const{joins:a,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(a,(l,o)=>{var u;const d=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(o),d.length>0){const h=e[l].map(g=>g.presence_ref),f=d.filter(g=>h.indexOf(g.presence_ref)<0);e[l].unshift(...f)}s(l,d,o)}),this.map(i,(l,o)=>{let u=e[l];if(!u)return;const d=o.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[l]=u,n(l,u,o),u.length===0&&delete e[l]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Gr;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Gr||(Gr={}));var rt;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(rt||(rt={}));var ce;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(ce||(ce={}));class Me{constructor(e,r={config:{}},s){var n,a;if(this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=q.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new qt(this,ne.join,this.params,this.timeout),this.rejoinTimer=new Qs(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=q.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=q.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=q.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=q.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=q.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ne.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new tt(this),this.broadcastEndpointURL=Xs(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var s,n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==q.closed){const{config:{broadcast:i,presence:l,private:o}}=this.params,u=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(g=>g.filter))!==null&&n!==void 0?n:[],d=!!this.bindings[rt.PRESENCE]&&this.bindings[rt.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,h={},f={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:u,private:o};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(g=>e==null?void 0:e(ce.CHANNEL_ERROR,g)),this._onClose(()=>e==null?void 0:e(ce.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:g})=>{var m;if(this.socket._isManualToken()||this.socket.setAuth(),g===void 0){e==null||e(ce.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,b=(m=p==null?void 0:p.length)!==null&&m!==void 0?m:0,y=[];for(let v=0;v<b;v++){const w=p[v],{filter:{event:x,schema:j,table:S,filter:R}}=w,O=g&&g[v];if(O&&O.event===x&&Me.isFilterValueEqual(O.schema,j)&&Me.isFilterValueEqual(O.table,S)&&Me.isFilterValueEqual(O.filter,R))y.push(Object.assign(Object.assign({},w),{id:O.id}));else{this.unsubscribe(),this.state=q.errored,e==null||e(ce.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(ce.SUBSCRIBED);return}}).receive("error",g=>{this.state=q.errored,e==null||e(ce.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(ce.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this.state===q.joined&&e===rt.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,r,s)}async httpSend(e,r,s={}){var n;if(r==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const i={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(l.status===202)return{success:!0};let o=l.statusText;try{const u=await l.json();o=u.error||u.message||o}catch{}return Promise.reject(new Error(o))}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:i}=e,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=u.body)===null||n===void 0?void 0:n.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,l,o;const u=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((o=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||o===void 0)&&o.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=q.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ne.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new qt(this,ne.leave,{},e),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=q.closed,this.bindings={}}async _fetchWithTimeout(e,r,s){const n=new AbortController,a=setTimeout(()=>n.abort(),s),i=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(a),i}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new qt(this,e,r,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Hi){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,a;const i=e.toLocaleLowerCase(),{close:l,error:o,leave:u,join:d}=ne;if(s&&[l,o,u,d].indexOf(i)>=0&&s!==this._joinRef())return;let f=this._onMessage(i,r,s);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(g=>{var m,p,b;return((m=g.filter)===null||m===void 0?void 0:m.event)==="*"||((b=(p=g.filter)===null||p===void 0?void 0:p.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===i}).map(g=>g.callback(f,s)):(a=this.bindings[i])===null||a===void 0||a.filter(g=>{var m,p,b,y,v,w;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in g){const x=g.id,j=(m=g.filter)===null||m===void 0?void 0:m.event;return x&&((p=r.ids)===null||p===void 0?void 0:p.includes(x))&&(j==="*"||(j==null?void 0:j.toLocaleLowerCase())===((b=r.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const x=(v=(y=g==null?void 0:g.filter)===null||y===void 0?void 0:y.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return x==="*"||x===((w=r==null?void 0:r.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===i}).map(g=>{if(typeof f=="object"&&"ids"in f){const m=f.data,{schema:p,table:b,commit_timestamp:y,type:v,errors:w}=m;f=Object.assign(Object.assign({},{schema:p,table:b,commit_timestamp:y,eventType:v,new:{},old:{},errors:w}),this._getPayloadRecords(m))}g.callback(f,s)})}_isClosed(){return this.state===q.closed}_isJoined(){return this.state===q.joined}_isJoining(){return this.state===q.joining}_isLeaving(){return this.state===q.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),a={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&Me.isEqual(n.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}static isFilterValueEqual(e,r){return(e??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ne.close,{},e)}_onError(e){this._on(ne.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=q.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Kr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Kr(e.columns,e.old_record)),r}}const Kt=()=>{},pt={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Yi=[1e3,2e3,5e3,1e4],Xi=1e4,Zi=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class eo{constructor(e,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=lr,this.transport=null,this.heartbeatIntervalMs=pt.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Kt,this.ref=0,this.reconnectTimer=null,this.vsn=qr,this.logger=Kt,this.conn=null,this.sendBuffer=[],this.serializer=new Vi,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...a)=>n(...a):(...a)=>fetch(...a),!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${cr.websocket}`,this.httpEndpoint=Xs(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Ui.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case fe.connecting:return Ee.Connecting;case fe.open:return Ee.Open;case fe.closing:return Ee.Closing;default:return Ee.Closed}}isConnected(){return this.connectionState()===Ee.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(a=>a.topic===s);if(n)return n;{const a=new Me(`realtime:${e}`,r,this);return this.channels.push(a),a}}push(e){const{topic:r,event:s,payload:n,ref:a}=e,i=()=>{this.encode(e,l=>{var o;(o=this.conn)===null||o===void 0||o.send(l)})};this.log("push",`${r} ${s} (${a})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Fi,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},pt.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:n,payload:a,ref:i}=r,l=i?`(${i})`:"",o=a.status||"";this.log("receive",`${o} ${s} ${n} ${l}`.trim(),a),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(n,a,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===fe.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===fe.open||this.conn.readyState===fe.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(ne.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([Zi],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r,s=!1;if(e)r=e,s=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),r=this.accessTokenValue}else r=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:Mi};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(ne.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(r)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new Qs(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},pt.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,s,n,a,i,l,o,u,d,h,f,g;switch(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:lr,this.heartbeatIntervalMs=(n=e==null?void 0:e.heartbeatIntervalMs)!==null&&n!==void 0?n:pt.HEARTBEAT_INTERVAL,this.worker=(a=e==null?void 0:e.worker)!==null&&a!==void 0?a:!1,this.accessToken=(i=e==null?void 0:e.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:Kt,this.vsn=(o=e==null?void 0:e.vsn)!==null&&o!==void 0?o:qr,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:m=>Yi[m-1]||Xi,this.vsn){case Js:this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(m,p)=>p(JSON.stringify(m)),this.decode=(h=e==null?void 0:e.decode)!==null&&h!==void 0?h:(m,p)=>p(JSON.parse(m));break;case zi:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(g=e==null?void 0:e.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var nt=class extends Error{constructor(t,e){var r;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((r=e.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function to(t,e,r){const s=new URL(e,t);if(r)for(const[n,a]of Object.entries(r))a!==void 0&&s.searchParams.set(n,a);return s.toString()}async function ro(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function so(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:n,body:a,headers:i}){const l=to(t.baseUrl,s,n),o=await ro(t.auth),u=await e(l,{method:r,headers:{...a?{"Content-Type":"application/json"}:{},...o,...i},body:a?JSON.stringify(a):void 0}),d=await u.text(),h=(u.headers.get("content-type")||"").includes("application/json"),f=h&&d?JSON.parse(d):d;if(!u.ok){const g=h?f:void 0,m=g==null?void 0:g.error;throw new nt((m==null?void 0:m.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:m==null?void 0:m.type,icebergCode:m==null?void 0:m.code,details:g})}return{status:u.status,headers:u.headers,data:f}}}}function wt(t){return t.join("")}var no=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:wt(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${wt(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${wt(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${wt(t.namespace)}`}),!0}catch(e){if(e instanceof nt&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof nt&&r.status===409)return;throw r}}};function Re(t){return t.join("")}var ao=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Re(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Re(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Re(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Re(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Re(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Re(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof nt&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof nt&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},io=class{constructor(t){var s;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=so({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(s=t.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new no(this.client,e),this.tableOps=new ao(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},Lt=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function z(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var oo=class extends Lt{constructor(t,e,r){super(t),this.name="StorageApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},dr=class extends Lt{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const Tr=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),lo=()=>Response,hr=t=>{if(Array.isArray(t))return t.map(r=>hr(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[n]=hr(s)}),e},co=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},uo=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function at(t){"@babel/helpers - typeof";return at=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},at(t)}function ho(t,e){if(at(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(at(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fo(t){var e=ho(t,"string");return at(e)=="symbol"?e:e+""}function go(t,e,r){return(e=fo(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Jr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function I(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Jr(Object(r),!0).forEach(function(s){go(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Jr(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}const Wt=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},mo=async(t,e,r)=>{t instanceof await lo()&&!(r!=null&&r.noResolveJson)?t.json().then(s=>{const n=t.status||500,a=(s==null?void 0:s.statusCode)||n+"";e(new oo(Wt(s),n,a))}).catch(s=>{e(new dr(Wt(s),s))}):e(new dr(Wt(t),t))},po=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?n:(co(s)?(n.headers=I({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,e!=null&&e.duplex&&(n.duplex=e.duplex),I(I({},n),r))};async function ht(t,e,r,s,n,a){return new Promise((i,l)=>{t(r,po(e,s,n,a)).then(o=>{if(!o.ok)throw o;return s!=null&&s.noResolveJson?o:o.json()}).then(o=>i(o)).catch(o=>mo(o,l,s))})}async function it(t,e,r,s){return ht(t,"GET",e,r,s)}async function se(t,e,r,s,n){return ht(t,"POST",e,s,n,r)}async function fr(t,e,r,s,n){return ht(t,"PUT",e,s,n,r)}async function wo(t,e,r,s){return ht(t,"HEAD",e,I(I({},r),{},{noResolveJson:!0}),s)}async function Ir(t,e,r,s,n){return ht(t,"DELETE",e,s,n,r)}var bo=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(z(e))return{data:null,error:e};throw e}}};let Zs;Zs=Symbol.toStringTag;var yo=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[Zs]="BlobDownloadBuilder",this.promise=null}asStream(){return new bo(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(z(e))return{data:null,error:e};throw e}}};const vo={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Qr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var xo=class{constructor(t,e={},r,s){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=r,this.fetch=Tr(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,r,s){var n=this;try{let a;const i=I(I({},Qr),s);let l=I(I({},n.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const o=i.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),o&&a.append("metadata",n.encodeMetadata(o)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.has("cacheControl")||a.append("cacheControl",i.cacheControl),o&&!a.has("metadata")&&a.append("metadata",n.encodeMetadata(o))):(a=r,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,o&&(l["x-metadata"]=n.toBase64(n.encodeMetadata(o))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!i.duplex&&(i.duplex="half")),s!=null&&s.headers&&(l=I(I({},l),s.headers));const u=n._removeEmptyFolders(e),d=n._getFinalPath(u),h=await(t=="PUT"?fr:se)(n.fetch,`${n.url}/object/${d}`,a,I({headers:l},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(z(a))return{data:null,error:a};throw a}}async upload(t,e,r){return this.uploadOrUpdate("POST",t,e,r)}async uploadToSignedUrl(t,e,r,s){var n=this;const a=n._removeEmptyFolders(t),i=n._getFinalPath(a),l=new URL(n.url+`/object/upload/sign/${i}`);l.searchParams.set("token",e);try{let o;const u=I({upsert:Qr.upsert},s),d=I(I({},n.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&r instanceof Blob?(o=new FormData,o.append("cacheControl",u.cacheControl),o.append("",r)):typeof FormData<"u"&&r instanceof FormData?(o=r,o.append("cacheControl",u.cacheControl)):(o=r,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType),{data:{path:a,fullPath:(await fr(n.fetch,l.toString(),o,{headers:d})).Key},error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(z(o))return{data:null,error:o};throw o}}async createSignedUploadUrl(t,e){var r=this;try{let s=r._getFinalPath(t);const n=I({},r.headers);e!=null&&e.upsert&&(n["x-upsert"]="true");const a=await se(r.fetch,`${r.url}/object/upload/sign/${s}`,{},{headers:n}),i=new URL(r.url+a.url),l=i.searchParams.get("token");if(!l)throw new Lt("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:l},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(z(s))return{data:null,error:s};throw s}}async update(t,e,r){return this.uploadOrUpdate("PUT",t,e,r)}async move(t,e,r){var s=this;try{return{data:await se(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(z(n))return{data:null,error:n};throw n}}async copy(t,e,r){var s=this;try{return{data:{path:(await se(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:s.headers})).Key},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(z(n))return{data:null,error:n};throw n}}async createSignedUrl(t,e,r){var s=this;try{let n=s._getFinalPath(t),a=await se(s.fetch,`${s.url}/object/sign/${n}`,I({expiresIn:e},r!=null&&r.transform?{transform:r.transform}:{}),{headers:s.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${s.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(z(n))return{data:null,error:n};throw n}}async createSignedUrls(t,e,r){var s=this;try{const n=await se(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:t},{headers:s.headers}),a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(i=>I(I({},i),{},{signedUrl:i.signedURL?encodeURI(`${s.url}${i.signedURL}${a}`):null})),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(z(n))return{data:null,error:n};throw n}}download(t,e){const r=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),n=s?`?${s}`:"",a=this._getFinalPath(t),i=()=>it(this.fetch,`${this.url}/${r}/${a}${n}`,{headers:this.headers,noResolveJson:!0});return new yo(i,this.shouldThrowOnError)}async info(t){var e=this;const r=e._getFinalPath(t);try{return{data:hr(await it(e.fetch,`${e.url}/object/info/${r}`,{headers:e.headers})),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(z(s))return{data:null,error:s};throw s}}async exists(t){var e=this;const r=e._getFinalPath(t);try{return await wo(e.fetch,`${e.url}/object/${r}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(z(s)&&s instanceof dr){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}}getPublicUrl(t,e){const r=this._getFinalPath(t),s=[],n=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";n!==""&&s.push(n);const a=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",i=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});i!==""&&s.push(i);let l=s.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${l}`)}}}async remove(t){var e=this;try{return{data:await Ir(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(z(r))return{data:null,error:r};throw r}}async list(t,e,r){var s=this;try{const n=I(I(I({},vo),e),{},{prefix:t||""});return{data:await se(s.fetch,`${s.url}/object/list/${s.bucketId}`,n,{headers:s.headers},r),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(z(n))return{data:null,error:n};throw n}}async listV2(t,e){var r=this;try{const s=I({},t);return{data:await se(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,s,{headers:r.headers},e),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(z(s))return{data:null,error:s};throw s}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const en="2.89.0",tn={"X-Client-Info":`storage-js/${en}`};var _o=class{constructor(t,e={},r,s){this.shouldThrowOnError=!1;const n=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase.")),this.url=n.href.replace(/\/$/,""),this.headers=I(I({},tn),e),this.fetch=Tr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const r=e.listBucketOptionsToQueryString(t);return{data:await it(e.fetch,`${e.url}/bucket${r}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(z(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await it(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(z(r))return{data:null,error:r};throw r}}async createBucket(t,e={public:!1}){var r=this;try{return{data:await se(r.fetch,`${r.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(z(s))return{data:null,error:s};throw s}}async updateBucket(t,e){var r=this;try{return{data:await fr(r.fetch,`${r.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(z(s))return{data:null,error:s};throw s}}async emptyBucket(t){var e=this;try{return{data:await se(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(z(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await Ir(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(z(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},Eo=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=I(I({},tn),e),this.fetch=Tr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await se(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(z(r))return{data:null,error:r};throw r}}async listBuckets(t){var e=this;try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const s=r.toString(),n=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return{data:await it(e.fetch,n,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(z(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await Ir(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(z(r))return{data:null,error:r};throw r}}from(t){var e=this;if(!uo(t))throw new Lt("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new io({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(n,a){const i=n[a];return typeof i!="function"?i:async(...l)=>{try{return{data:await i.apply(n,l),error:null}}catch(o){if(s)throw o;return{data:null,error:o}}}}})}};const Rr={"X-Client-Info":`storage-js/${en}`,"Content-Type":"application/json"};var rn=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Z(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var Gt=class extends rn{constructor(t,e,r){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ko=class extends rn{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const Ar=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),jo=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Yr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),So=async(t,e,r)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(r!=null&&r.noResolveJson)){const s=t.status||500,n=t;if(typeof n.json=="function")n.json().then(a=>{const i=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||s+"";e(new Gt(Yr(a),s,i))}).catch(()=>{const a=s+"";e(new Gt(n.statusText||`HTTP ${s} error`,s,a))});else{const a=s+"";e(new Gt(n.statusText||`HTTP ${s} error`,s,a))}}else e(new ko(Yr(t),t))},Co=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return s?(jo(s)?(n.headers=I({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,I(I({},n),r)):n};async function No(t,e,r,s,n,a){return new Promise((i,l)=>{t(r,Co(e,s,n,a)).then(o=>{if(!o.ok)throw o;if(s!=null&&s.noResolveJson)return o;const u=o.headers.get("content-type");return!u||!u.includes("application/json")?{}:o.json()}).then(o=>i(o)).catch(o=>So(o,l,s))})}async function ee(t,e,r,s,n){return No(t,"POST",e,s,n,r)}var To=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=I(I({},Rr),e),this.fetch=Ar(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await ee(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Z(r))return{data:null,error:r};throw r}}async getIndex(t,e){var r=this;try{return{data:await ee(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Z(s))return{data:null,error:s};throw s}}async listIndexes(t){var e=this;try{return{data:await ee(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Z(r))return{data:null,error:r};throw r}}async deleteIndex(t,e){var r=this;try{return{data:await ee(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers})||{},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Z(s))return{data:null,error:s};throw s}}},Io=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=I(I({},Rr),e),this.fetch=Ar(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await ee(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Z(r))return{data:null,error:r};throw r}}async getVectors(t){var e=this;try{return{data:await ee(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Z(r))return{data:null,error:r};throw r}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await ee(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Z(r))return{data:null,error:r};throw r}}async queryVectors(t){var e=this;try{return{data:await ee(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Z(r))return{data:null,error:r};throw r}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await ee(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Z(r))return{data:null,error:r};throw r}}},Ro=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=I(I({},Rr),e),this.fetch=Ar(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await ee(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Z(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await ee(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Z(r))return{data:null,error:r};throw r}}async listBuckets(t={}){var e=this;try{return{data:await ee(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Z(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await ee(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Z(r))return{data:null,error:r};throw r}}},Ao=class extends Ro{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new Oo(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,r=this;return e().call(r,t)}async getBucket(t){var e=()=>super.getBucket,r=this;return e().call(r,t)}async listBuckets(t={}){var e=()=>super.listBuckets,r=this;return e().call(r,t)}async deleteBucket(t){var e=()=>super.deleteBucket,r=this;return e().call(r,t)}},Oo=class extends To{constructor(t,e,r,s){super(t,e,s),this.vectorBucketName=r}async createIndex(t){var e=()=>super.createIndex,r=this;return e().call(r,I(I({},t),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,r=this;return e().call(r,I(I({},t),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,r=this;return e().call(r,r.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,r=this;return e().call(r,r.vectorBucketName,t)}index(t){return new Po(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},Po=class extends Io{constructor(t,e,r,s,n){super(t,e,n),this.vectorBucketName=r,this.indexName=s}async putVectors(t){var e=()=>super.putVectors,r=this;return e().call(r,I(I({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(t){var e=()=>super.getVectors,r=this;return e().call(r,I(I({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,r=this;return e().call(r,I(I({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,r=this;return e().call(r,I(I({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,r=this;return e().call(r,I(I({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},Do=class extends _o{constructor(t,e={},r,s){super(t,e,r,s)}from(t){return new xo(this.url,this.headers,t,this.fetch)}get vectors(){return new Ao(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Eo(this.url+"/iceberg",this.headers,this.fetch)}};const sn="2.89.0",Ue=30*1e3,gr=3,Jt=gr*Ue,$o="http://localhost:9999",Lo="supabase.auth.token",Uo={"X-Client-Info":`gotrue-js/${sn}`},mr="X-Supabase-Api-Version",nn={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Bo=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Mo=10*60*1e3;class ot extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function N(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class zo extends ot{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function Fo(t){return N(t)&&t.name==="AuthApiError"}class ke extends ot{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class he extends ot{constructor(e,r,s,n){super(e,s,n),this.name=r,this.status=s}}class X extends he{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ho(t){return N(t)&&t.name==="AuthSessionMissingError"}class Ae extends he{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class bt extends he{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class yt extends he{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Vo(t){return N(t)&&t.name==="AuthImplicitGrantRedirectError"}class Xr extends he{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class qo extends he{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class pr extends he{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Qt(t){return N(t)&&t.name==="AuthRetryableFetchError"}class Zr extends he{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class wr extends he{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const kt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),es=` 	
\r=`.split(""),Ko=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<es.length;e+=1)t[es[e].charCodeAt(0)]=-2;for(let e=0;e<kt.length;e+=1)t[kt[e].charCodeAt(0)]=e;return t})();function ts(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(kt[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(kt[s]),e.queuedBits-=6}}function an(t,e,r){const s=Ko[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function rs(t){const e=[],r=i=>{e.push(String.fromCodePoint(i))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=i=>{Jo(i,s,r)};for(let i=0;i<t.length;i+=1)an(t.charCodeAt(i),n,a);return e.join("")}function Wo(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Go(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}Wo(s,e)}}function Jo(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Fe(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)an(t.charCodeAt(n),r,s);return new Uint8Array(e)}function Qo(t){const e=[];return Go(t,r=>e.push(r)),new Uint8Array(e)}function je(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};return t.forEach(n=>ts(n,r,s)),ts(null,r,s),e.join("")}function Yo(t){return Math.round(Date.now()/1e3)+t}function Xo(){return Symbol("auth-callback")}const J=()=>typeof window<"u"&&typeof document<"u",ve={tested:!1,writable:!1},on=()=>{if(!J())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ve.tested)return ve.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ve.tested=!0,ve.writable=!0}catch{ve.tested=!0,ve.writable=!1}return ve.writable};function Zo(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,a)=>{e[a]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const ln=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),el=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Be=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},xe=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},G=async(t,e)=>{await t.removeItem(e)};class Ut{constructor(){this.promise=new Ut.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Ut.promiseConstructor=Promise;function Yt(t){const e=t.split(".");if(e.length!==3)throw new wr("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!Bo.test(e[s]))throw new wr("JWT not in base64url format");return{header:JSON.parse(rs(e[0])),payload:JSON.parse(rs(e[1])),signature:Fe(e[2]),raw:{header:e[0],payload:e[1]}}}async function tl(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function rl(t,e){return new Promise((s,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await t(a);if(!e(a,null,i)){s(i);return}}catch(i){if(!e(a,i)){n(i);return}}})()})}function sl(t){return("0"+t.toString(16)).substr(-2)}function nl(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let a=0;a<56;a++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,sl).join("")}async function al(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function il(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await al(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Oe(t,e,r=!1){const s=nl();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await Be(t,`${e}-code-verifier`,n);const a=await il(s);return[a,s===a?"plain":"s256"]}const ol=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ll(t){const e=t.headers.get(mr);if(!e||!e.match(ol))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function cl(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function ul(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const dl=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Pe(t){if(!dl.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Xt(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function hl(t,e){return new Proxy(t,{get:(r,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const a=s.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,n)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,s,n)}})}function ss(t){return JSON.parse(JSON.stringify(t))}const _e=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),fl=[502,503,504];async function ns(t){var e;if(!el(t))throw new pr(_e(t),0);if(fl.includes(t.status))throw new pr(_e(t),t.status);let r;try{r=await t.json()}catch(a){throw new ke(_e(a),a)}let s;const n=ll(t);if(n&&n.getTime()>=nn["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new Zr(_e(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new X}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new Zr(_e(r),t.status,r.weak_password.reasons);throw new zo(_e(r),t.status||500,s)}const gl=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function T(t,e,r,s){var n;const a=Object.assign({},s==null?void 0:s.headers);a[mr]||(a[mr]=nn["2024-01-01"].name),s!=null&&s.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const i=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(i.redirect_to=s.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",o=await ml(t,e,r+l,{headers:a,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(o):{data:Object.assign({},o),error:null}}async function ml(t,e,r,s,n,a){const i=gl(e,s,n,a);let l;try{l=await t(r,Object.assign({},i))}catch(o){throw console.error(o),new pr(_e(o),0)}if(l.ok||await ns(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(o){await ns(o)}}function re(t){var e;let r=null;bl(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=Yo(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function as(t){const e=re(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function me(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function pl(t){return{data:t,error:null}}function wl(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:a}=t,i=$t(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:a},o=Object.assign({},i);return{data:{properties:l,user:o},error:null}}function is(t){return t}function bl(t){return t.access_token&&t.refresh_token&&t.expires_in}const Zt=["global","local","others"];class yl{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=ln(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=Zt[0]){if(Zt.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Zt.join(", ")}`);try{return await T(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(N(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await T(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:me})}catch(s){if(N(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=$t(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await T(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:wl,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(N(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await T(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:me})}catch(r){if(N(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,a,i,l,o;try{const u={nextPage:null,lastPage:0,total:0},d=await T(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:is});if(d.error)throw d.error;const h=await d.json(),f=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,g=(o=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&o!==void 0?o:[];return g.length>0&&(g.forEach(m=>{const p=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(m.split(";")[1].split("=")[1]);u[`${b}Page`]=p}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(N(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){Pe(e);try{return await T(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:me})}catch(r){if(N(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Pe(e);try{return await T(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:me})}catch(s){if(N(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){Pe(e);try{return await T(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:me})}catch(s){if(N(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Pe(e.userId);try{const{data:r,error:s}=await T(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(N(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Pe(e.userId),Pe(e.id);try{return{data:await T(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,s,n,a,i,l,o;try{const u={nextPage:null,lastPage:0,total:0},d=await T(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:is});if(d.error)throw d.error;const h=await d.json(),f=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,g=(o=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&o!==void 0?o:[];return g.length>0&&(g.forEach(m=>{const p=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(m.split(";")[1].split("=")[1]);u[`${b}Page`]=p}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(N(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await T(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(N(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await T(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(N(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await T(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(N(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await T(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await T(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(N(r))return{data:null,error:r};throw r}}}function os(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const De={debug:!!(globalThis&&on()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class cn extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class vl extends cn{}async function xl(t,e,r){De.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),De.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){De.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{De.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw De.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new vl(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(De.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function _l(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function un(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function El(t){return parseInt(t,16)}function kl(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function jl(t){var e;const{chainId:r,domain:s,expirationTime:n,issuedAt:a=new Date,nonce:i,notBefore:l,requestId:o,resources:u,scheme:d,uri:h,version:f}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const g=un(t.address),m=d?`${d}://${s}`:s,p=t.statement?`${t.statement}
`:"",b=`${m} wants you to sign in with your Ethereum account:
${g}

${p}`;let y=`URI: ${h}
Version: ${f}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${a.toISOString()}`;if(n&&(y+=`
Expiration Time: ${n.toISOString()}`),l&&(y+=`
Not Before: ${l.toISOString()}`),o&&(y+=`
Request ID: ${o}`),u){let v=`
Resources:`;for(const w of u){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);v+=`
- ${w}`}y+=v}return`${b}
${y}`}class V extends Error{constructor({message:e,code:r,cause:s,name:n}){var a;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(a=n??(s instanceof Error?s.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class jt extends V{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function Sl({error:t,options:e}){var r,s,n;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new V({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new V({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new V({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new V({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new V({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new V({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new V({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new V({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const i=window.location.hostname;if(dn(i)){if(a.rp.id!==i)return new V({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new V({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new V({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new V({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new V({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Cl({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new V({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new V({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(dn(s)){if(r.rpId!==s)return new V({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new V({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new V({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new V({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class Nl{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Tl=new Nl;function Il(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:s}=t,n=$t(t,["challenge","user","excludeCredentials"]),a=Fe(e).buffer,i=Object.assign(Object.assign({},r),{id:Fe(r.id).buffer}),l=Object.assign(Object.assign({},n),{challenge:a,user:i});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let o=0;o<s.length;o++){const u=s[o];l.excludeCredentials[o]=Object.assign(Object.assign({},u),{id:Fe(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function Rl(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,s=$t(t,["challenge","allowCredentials"]),n=Fe(e).buffer,a=Object.assign(Object.assign({},s),{challenge:n});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const l=r[i];a.allowCredentials[i]=Object.assign(Object.assign({},l),{id:Fe(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function Al(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:je(new Uint8Array(t.response.attestationObject)),clientDataJSON:je(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Ol(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,s=t.getClientExtensionResults(),n=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:je(new Uint8Array(n.authenticatorData)),clientDataJSON:je(new Uint8Array(n.clientDataJSON)),signature:je(new Uint8Array(n.signature)),userHandle:n.userHandle?je(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function dn(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function ls(){var t,e;return!!(J()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function Pl(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new jt("Browser returned unexpected credential type",e)}:{data:null,error:new jt("Empty credential response",e)}}catch(e){return{data:null,error:Sl({error:e,options:t})}}}async function Dl(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new jt("Browser returned unexpected credential type",e)}:{data:null,error:new jt("Empty credential response",e)}}catch(e){return{data:null,error:Cl({error:e,options:t})}}}const $l={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Ll={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function St(...t){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of t)if(n)for(const a in n){const i=n[a];if(i!==void 0)if(Array.isArray(i))s[a]=i;else if(r(i))s[a]=i;else if(e(i)){const l=s[a];e(l)?s[a]=St(l,i):s[a]=St(i)}else s[a]=i}return s}function Ul(t,e){return St($l,t,e||{})}function Bl(t,e){return St(Ll,t,e||{})}class Ml{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:s,signal:n},a){try{const{data:i,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!i)return{data:null,error:l};const o=n??Tl.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:u}=i.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${s}`),u.displayName||(u.displayName=u.name)}switch(i.webauthn.type){case"create":{const u=Ul(i.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:d,error:h}=await Pl({publicKey:u,signal:o});return d?{data:{factorId:e,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}case"request":{const u=Bl(i.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:d,error:h}=await Dl(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:u,signal:o}));return d?{data:{factorId:e,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}}}catch(i){return N(i)?{data:null,error:i}:{data:null,error:new ke("Unexpected error in challenge",i)}}}async _verify({challengeId:e,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},a){if(!r)return{data:null,error:new ot("rpId is required for WebAuthn authentication")};try{if(!ls())return{data:null,error:new ke("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:s},signal:n},{request:a});if(!i)return{data:null,error:l};const{webauthn:o}=i;return this._verify({factorId:e,challengeId:i.challengeId,webauthn:{type:o.type,rpId:r,rpOrigins:s,credential_response:o.credential_response}})}catch(i){return N(i)?{data:null,error:i}:{data:null,error:new ke("Unexpected error in authenticate",i)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},a){if(!r)return{data:null,error:new ot("rpId is required for WebAuthn registration")};try{if(!ls())return{data:null,error:new ke("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this._enroll({friendlyName:e});if(!i)return await this.client.mfa.listFactors().then(d=>{var h;return(h=d.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:l};const{data:o,error:u}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:n},{create:a});return o?this._verify({factorId:i.id,challengeId:o.challengeId,webauthn:{rpId:r,rpOrigins:s,type:o.webauthn.type,credential_response:o.webauthn.credential_response}}):{data:null,error:u}}catch(i){return N(i)?{data:null,error:i}:{data:null,error:new ke("Unexpected error in register",i)}}}}_l();const zl={url:$o,storageKey:Lo,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Uo,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function cs(t,e,r){return await r()}const $e={};class lt{get jwks(){var e,r;return(r=(e=$e[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){$e[this.storageKey]=Object.assign(Object.assign({},$e[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=$e[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){$e[this.storageKey]=Object.assign(Object.assign({},$e[this.storageKey]),{cachedAt:e})}constructor(e){var r,s,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},zl),e);if(this.storageKey=a.storageKey,this.instanceID=(r=lt.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,lt.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&J()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new yl({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=ln(a.fetch),this.lock=a.lock||cs,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:this.persistSession&&J()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=xl:this.lock=cs,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Ml(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:on()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=os(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=os(this.memoryStorage)),J()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${sn}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},s="none";if(J()&&(r=Zo(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),J()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:a}=await this._getSessionFromURL(r,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),Vo(a)){const o=(e=a.details)===null||e===void 0?void 0:e.code;if(o==="identity_already_exists"||o==="identity_not_found"||o==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return N(r)?this._returnResult({error:r}):this._returnResult({error:new ke("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,n;try{const a=await T(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:re}),{data:i,error:l}=a;if(l||!i)return this._returnResult({data:{user:null,session:null},error:l});const o=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",o)),this._returnResult({data:{user:u,session:o},error:null})}catch(a){if(N(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var r,s,n;try{let a;if("email"in e){const{email:d,password:h,options:f}=e;let g=null,m=null;this.flowType==="pkce"&&([g,m]=await Oe(this.storage,this.storageKey)),a=await T(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:g,code_challenge_method:m},xform:re})}else if("phone"in e){const{phone:d,password:h,options:f}=e;a=await T(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(n=f==null?void 0:f.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:re})}else throw new bt("You must provide either an email or phone number and a password");const{data:i,error:l}=a;if(l||!i)return await G(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const o=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",o)),this._returnResult({data:{user:u,session:o},error:null})}catch(a){if(await G(this.storage,`${this.storageKey}-code-verifier`),N(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let r;if("email"in e){const{email:a,password:i,options:l}=e;r=await T(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:as})}else if("phone"in e){const{phone:a,password:i,options:l}=e;r=await T(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:as})}else throw new bt("You must provide either an email or phone number and a password");const{data:s,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const a=new Ae;return this._returnResult({data:{user:null,session:null},error:a})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(N(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,s,n,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,s,n,a,i,l,o,u,d,h,f;let g,m;if("message"in e)g=e.message,m=e.signature;else{const{chain:p,wallet:b,statement:y,options:v}=e;let w;if(J())if(typeof b=="object")w=b;else{const $=window;if("ethereum"in $&&typeof $.ethereum=="object"&&"request"in $.ethereum&&typeof $.ethereum.request=="function")w=$.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=b}const x=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href),j=await w.request({method:"eth_requestAccounts"}).then($=>$).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!j||j.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const S=un(j[0]);let R=(s=v==null?void 0:v.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!R){const $=await w.request({method:"eth_chainId"});R=El($)}const O={domain:x.host,address:S,statement:y,uri:x.href,version:"1",chainId:R,nonce:(n=v==null?void 0:v.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(i=(a=v==null?void 0:v.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(l=v==null?void 0:v.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(o=v==null?void 0:v.signInWithEthereum)===null||o===void 0?void 0:o.notBefore,requestId:(u=v==null?void 0:v.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=v==null?void 0:v.signInWithEthereum)===null||d===void 0?void 0:d.resources};g=jl(O),m=await w.request({method:"personal_sign",params:[kl(g),S]})}try{const{data:p,error:b}=await T(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:g,signature:m},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:re});if(b)throw b;if(!p||!p.session||!p.user){const y=new Ae;return this._returnResult({data:{user:null,session:null},error:y})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:Object.assign({},p),error:b})}catch(p){if(N(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async signInWithSolana(e){var r,s,n,a,i,l,o,u,d,h,f,g;let m,p;if("message"in e)m=e.message,p=e.signature;else{const{chain:b,wallet:y,statement:v,options:w}=e;let x;if(J())if(typeof y=="object")x=y;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))x=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=y}const j=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in x&&x.signIn){const S=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),v?{statement:v}:null));let R;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")R=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)R=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)m=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),p=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in x)||typeof x.signMessage!="function"||!("publicKey"in x)||typeof x!="object"||!x.publicKey||!("toBase58"in x.publicKey)||typeof x.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${j.host} wants you to sign in with your Solana account:`,x.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(n=(s=w==null?void 0:w.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((u=w==null?void 0:w.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(d=w==null?void 0:w.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const S=await x.signMessage(new TextEncoder().encode(m),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=S}}try{const{data:b,error:y}=await T(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:je(p)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:re});if(y)throw y;if(!b||!b.session||!b.user){const v=new Ae;return this._returnResult({data:{user:null,session:null},error:v})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:y})}catch(b){if(N(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async _exchangeCodeForSession(e){const r=await xe(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{if(!s&&this.flowType==="pkce")throw new qo;const{data:a,error:i}=await T(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:re});if(await G(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!a||!a.session||!a.user){const l=new Ae;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:i})}catch(a){if(await G(this.storage,`${this.storageKey}-code-verifier`),N(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:r,provider:s,token:n,access_token:a,nonce:i}=e,l=await T(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:re}),{data:o,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!o||!o.session||!o.user){const d=new Ae;return this._returnResult({data:{user:null,session:null},error:d})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:o,error:u})}catch(r){if(N(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,s,n,a,i;try{if("email"in e){const{email:l,options:o}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Oe(this.storage,this.storageKey));const{error:h}=await T(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=o==null?void 0:o.data)!==null&&r!==void 0?r:{},create_user:(s=o==null?void 0:o.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:o==null?void 0:o.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:l,options:o}=e,{data:u,error:d}=await T(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=o==null?void 0:o.data)!==null&&n!==void 0?n:{},create_user:(a=o==null?void 0:o.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken},channel:(i=o==null?void 0:o.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new bt("You must provide either an email or phone number.")}catch(l){if(await G(this.storage,`${this.storageKey}-code-verifier`),N(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var r,s;try{let n,a;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,a=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:i,error:l}=await T(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:re});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const o=i.session,u=i.user;return o!=null&&o.access_token&&(await this._saveSession(o),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",o)),this._returnResult({data:{user:u,session:o},error:null})}catch(n){if(N(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var r,s,n,a,i;try{let l=null,o=null;this.flowType==="pkce"&&([l,o]=await Oe(this.storage,this.storageKey));const u=await T(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:o}),headers:this.headers,xform:pl});return!((a=u.data)===null||a===void 0)&&a.url&&J()&&!(!((i=e.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(l){if(await G(this.storage,`${this.storageKey}-code-verifier`),N(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new X;const{error:n}=await T(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(N(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:a}=e,{error:i}=await T(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in e){const{phone:s,type:n,options:a}=e,{data:i,error:l}=await T(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:l})}throw new bt("You must provide either an email or phone number and a type")}catch(r){if(N(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await xe(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Jt:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const i=await xe(this.userStorage,this.storageKey+"-user");i!=null&&i.user?e.user=i.user:e.user=Xt()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};e.user=hl(e.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(e){try{return e?await T(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:me}):await this._useSession(async r=>{var s,n,a;const{data:i,error:l}=r;if(l)throw l;return!(!((s=i.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new X}:await T(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:me})})}catch(r){if(N(r))return Ho(r)&&(await this._removeSession(),await G(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:a}=s;if(a)throw a;if(!n.session)throw new X;const i=n.session;let l=null,o=null;this.flowType==="pkce"&&e.email!=null&&([l,o]=await Oe(this.storage,this.storageKey));const{data:u,error:d}=await T(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:o}),jwt:i.access_token,xform:me});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(s){if(await G(this.storage,`${this.storageKey}-code-verifier`),N(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new X;const r=Date.now()/1e3;let s=r,n=!0,a=null;const{payload:i}=Yt(e.access_token);if(i.exp&&(s=i.exp,n=s<=r),n){const{data:l,error:o}=await this._callRefreshToken(e.refresh_token);if(o)return this._returnResult({data:{user:null,session:null},error:o});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:o}=await this._getUser(e.access_token);if(o)throw o;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(N(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:i,error:l}=r;if(l)throw l;e=(s=i.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new X;const{data:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(N(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!J())throw new yt("No browser detected.");if(e.error||e.error_description||e.error_code)throw new yt(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Xr("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new yt("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Xr("No code detected.");const{data:v,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:a,refresh_token:i,expires_in:l,expires_at:o,token_type:u}=e;if(!a||!l||!i||!u)throw new yt("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let f=d+h;o&&(f=parseInt(o));const g=f-d;g*1e3<=Ue&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${h}s`);const m=f-h;d-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,f,d):d-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,f,d);const{data:p,error:b}=await this._getUser(a);if(b)throw b;const y={provider_token:s,provider_refresh_token:n,access_token:a,expires_in:h,expires_at:f,refresh_token:i,token_type:u,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:y,redirectType:e.type},error:null})}catch(s){if(N(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await xe(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({error:a});const i=(s=n.session)===null||s===void 0?void 0:s.access_token;if(i){const{error:l}=await this.admin.signOut(i,e);if(l&&!(Fo(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await G(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=Xo(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:a},error:i}=r;if(i)throw i;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await Oe(this.storage,this.storageKey,!0));try{return await T(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(await G(this.storage,`${this.storageKey}-code-verifier`),N(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(N(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:s,error:n}=await this._useSession(async a=>{var i,l,o,u,d;const{data:h,error:f}=a;if(f)throw f;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:!0});return await T(this.fetch,"GET",g,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return J()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(N(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var s;try{const{error:n,data:{session:a}}=r;if(n)throw n;const{options:i,provider:l,token:o,access_token:u,nonce:d}=e,h=await T(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=a==null?void 0:a.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:o,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:re}),{data:f,error:g}=h;return g?this._returnResult({data:{user:null,session:null},error:g}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Ae}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:g}))}catch(n){if(await G(this.storage,`${this.storageKey}-code-verifier`),N(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:a,error:i}=r;if(i)throw i;return await T(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(N(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await rl(async n=>(n>0&&await tl(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await T(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:re})),(n,a)=>{const i=200*Math.pow(2,n);return a&&Qt(a)&&Date.now()+i-s<Ue})}catch(s){if(this._debug(r,"error",s),N(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),J()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await xe(this.storage,this.storageKey);if(n&&this.userStorage){let i=await xe(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:n.user},await Be(this.userStorage,this.storageKey+"-user",i)),n.user=(e=i==null?void 0:i.user)!==null&&e!==void 0?e:Xt()}else if(n&&!n.user&&!n.user){const i=await xe(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(n.user=i.user,await G(this.storage,this.storageKey+"-user"),await Be(this.storage,this.storageKey,n)):n.user=Xt()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const a=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Jt;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${Jt}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),Qt(i)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(n.access_token);!l&&(i!=null&&i.user)?(n.user=i.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(s,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new X;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Ut;const{data:a,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!a.session)throw new X;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(n,"error",a),N(a)){const i={data:null,error:a};return Qt(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(o){a.push(o)}});if(await Promise.all(i),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await G(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await Be(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const a=ss(n);await Be(this.storage,this.storageKey,a)}else{const n=ss(r);await Be(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await G(this.storage,this.storageKey),await G(this.storage,this.storageKey+"-code-verifier"),await G(this.storage,this.storageKey+"-user"),this.userStorage&&await G(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&J()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ue);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/Ue);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Ue}ms, refresh threshold is ${gr} ticks`),n<=gr&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof cn)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!J()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,i]=await Oe(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(l.toString())}if(s!=null&&s.queryParams){const a=new URLSearchParams(s.queryParams);n.push(a.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;return a?this._returnResult({data:null,error:a}):await T(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(N(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:o,error:u}=await T(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return u?this._returnResult({data:null,error:u}):(e.factorType==="totp"&&o.type==="totp"&&(!((n=o==null?void 0:o.totp)===null||n===void 0)&&n.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),this._returnResult({data:o,error:null}))})}catch(r){if(N(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?Al(e.webauthn.credential_response):Ol(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:o}=await T(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:i,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return o?this._returnResult({data:null,error:o}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:o}))})}catch(r){if(N(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=await T(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});if(i.error)return i;const{data:l}=i;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Il(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Rl(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(N(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=r==null?void 0:r.factors)!==null&&e!==void 0?e:[])n.all.push(a),a.status==="verified"&&n[a.factor_type].push(a);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:s},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Yt(s.access_token);let i=null;a.aal&&(i=a.aal);let l=i;((r=(e=s.user.factors)===null||e===void 0?void 0:e.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:i,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await T(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new X})})}catch(r){if(N(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!n)return this._returnResult({data:null,error:new X});const i=await T(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&J()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(N(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!n)return this._returnResult({data:null,error:new X});const i=await T(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&J()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(N(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;return s?this._returnResult({data:null,error:s}):r?await T(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new X})})}catch(e){if(N(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?(await T(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new X})})}catch(r){if(N(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(l=>l.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+Mo>n)return s;const{data:a,error:i}=await T(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=n,s=a.keys.find(l=>l.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:g,error:m}=await this.getSession();if(m||!g.session)return this._returnResult({data:null,error:m});s=g.session.access_token}const{header:n,payload:a,signature:i,raw:{header:l,payload:o}}=Yt(s);r!=null&&r.allowExpired||cl(a.exp);const u=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:g}=await this.getUser(s);if(g)throw g;return{data:{claims:a,header:n,signature:i},error:null}}const d=ul(n.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,i,Qo(`${l}.${o}`)))throw new wr("Invalid JWT signature");return{data:{claims:a,header:n,signature:i},error:null}}catch(s){if(N(s))return this._returnResult({data:null,error:s});throw s}}}lt.nextInstanceID={};const Fl=lt,Hl="2.89.0";let Ze="";typeof Deno<"u"?Ze="deno":typeof document<"u"?Ze="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ze="react-native":Ze="node";const Vl={"X-Client-Info":`supabase-js-${Ze}/${Hl}`},ql={headers:Vl},Kl={schema:"public"},Wl={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Gl={};function ct(t){"@babel/helpers - typeof";return ct=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ct(t)}function Jl(t,e){if(ct(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(ct(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ql(t){var e=Jl(t,"string");return ct(e)=="symbol"?e:e+""}function Yl(t,e,r){return(e=Ql(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function us(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function H(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?us(Object(r),!0).forEach(function(s){Yl(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):us(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}const Xl=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Zl=()=>Headers,ec=(t,e,r)=>{const s=Xl(r),n=Zl();return async(a,i)=>{var l;const o=(l=await e())!==null&&l!==void 0?l:t;let u=new n(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${o}`),s(a,H(H({},i),{},{headers:u}))}};function tc(t){return t.endsWith("/")?t:t+"/"}function rc(t,e){var r,s;const{db:n,auth:a,realtime:i,global:l}=t,{db:o,auth:u,realtime:d,global:h}=e,f={db:H(H({},o),n),auth:H(H({},u),a),realtime:H(H({},d),i),storage:{},global:H(H(H({},h),l),{},{headers:H(H({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function sc(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(tc(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var nc=class extends Fl{constructor(t){super(t)}},ac=class{constructor(t,e,r){var s,n;this.supabaseUrl=t,this.supabaseKey=e;const a=sc(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const i=`sb-${a.hostname.split(".")[0]}-auth-token`,l={db:Kl,realtime:Gl,auth:H(H({},Wl),{},{storageKey:i}),global:ql},o=rc(r??{},l);if(this.storageKey=(s=o.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(n=o.global.headers)!==null&&n!==void 0?n:{},o.accessToken)this.accessToken=o.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=o.auth)!==null&&u!==void 0?u:{},this.headers,o.global.fetch)}this.fetch=ec(e,this._getAccessToken.bind(this),o.global.fetch),this.realtime=this._initRealtimeClient(H({headers:this.headers,accessToken:this._getAccessToken.bind(this)},o.realtime)),this.accessToken&&this.accessToken().then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new Li(new URL("rest/v1",a).href,{headers:this.headers,schema:o.db.schema,fetch:this.fetch}),this.storage=new Do(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),o.accessToken||this._listenForAuthEvents()}get functions(){return new Ai(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,r;if(t.accessToken)return await t.accessToken();const{data:s}=await t.auth.getSession();return(e=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:s,userStorage:n,storageKey:a,flowType:i,lock:l,debug:o,throwOnError:u},d,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new nc({url:this.authUrl.href,headers:H(H({},f),d),storageKey:a,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:s,userStorage:n,flowType:i,lock:l,debug:o,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new eo(this.realtimeUrl.href,H(H({},t),{},{params:H(H({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const ic=(t,e,r)=>new ac(t,e,r);function oc(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}oc()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const lc="https://ccwrxgvddypgbbdmjsaw.supabase.co",cc="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNjd3J4Z3ZkZHlwZ2JiZG1qc2F3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYzMjM5NTQsImV4cCI6MjA4MTg5OTk1NH0.9RsMSsYIwENQLvvgI2jXgZGJNfoy9iHvf_70_6aaClY",ae=ic(lc,cc),ds={async uploadBackgroundImage(t){try{if(!t)throw new Error("No se seleccionó archivo");if(t.size>5*1024*1024)throw new Error("La imagen debe ser menor a 5MB");const e=t.name.split(".").pop(),r=`${Date.now()}_${Math.random().toString(36).substring(2)}.${e}`,s=`backgrounds/${r}`;console.log("📤 Subiendo imagen:",r);const{data:n,error:a}=await ae.storage.from("countdown-images").upload(s,t);if(a)throw a;const{data:{publicUrl:i}}=ae.storage.from("countdown-images").getPublicUrl(s);return console.log("✅ Imagen subida:",i),{success:!0,url:i,fileName:r,path:s}}catch(e){return console.error("❌ Error subiendo imagen:",e),{success:!1,error:e.message}}},async deleteImage(t){try{const{error:e}=await ae.storage.from("countdown-images").remove([t]);if(e)throw e;return{success:!0}}catch(e){return console.error("Error eliminando imagen:",e),{success:!1,error:e.message}}}},Se={async getAllCountdowns(){try{console.log("📋 Obteniendo todos los countdowns...");const{data:t,error:e}=await ae.from("countdowns").select("*").order("created_at",{ascending:!1});if(e)throw console.error("❌ Error al obtener countdowns:",e),e;return console.log(`✅ ${(t==null?void 0:t.length)||0} countdowns encontrados`),t.map(r=>{var s;return{id:r.id,public_url:r.public_url,title:r.title,targetDate:r.target_date,startDate:((s=r.custom_data)==null?void 0:s.start_date)||r.created_at,message:r.message,backgroundColor:r.background_color||"#4a148c",textColor:r.text_color||"#ffffff",progressIcon:r.progress_icon||"FaHourglassHalf",backgroundImage:r.background_image,useImage:!!r.background_image,views:r.views||0,created_at:r.created_at,custom_data:r.custom_data||{}}})}catch(t){console.error("💥 Error en getAllCountdowns:",t);try{const e=[];for(let r=0;r<localStorage.length;r++){const s=localStorage.key(r);if(s.startsWith("countdown_")){const n=JSON.parse(localStorage.getItem(s));e.push({...n,id:s.replace("countdown_","")})}}return e}catch(e){throw console.error("Error cargando localmente:",e),t}}},async createCountdown(t,e=null){var r;try{console.log("📝 Creando countdown...");let s=null;if(e&&t.useImage){const o=await ds.uploadBackgroundImage(e);o.success?s=o.url:(console.warn("⚠️ No se pudo subir imagen, usando URL directa"),s=t.backgroundImage)}else t.useImage&&t.backgroundImage&&!t.backgroundImage.startsWith("data:")&&(s=t.backgroundImage);const n=`cd_${Date.now().toString(36)}_${Math.random().toString(36).substring(2,6)}`,a={title:t.title,target_date:this.formatDateForDB(t.targetDate),message:t.message||null,background_color:t.backgroundColor||"#4a148c",text_color:t.textColor||"#ffffff",background_image:s,progress_icon:t.progressIcon||"FaHourglassHalf",public_url:n,views:0,custom_data:{start_date:this.formatDateForDB(t.startDate),use_image:!!t.useImage}};console.log("📤 Insertando en BD:",a);const{data:i,error:l}=await ae.from("countdowns").insert([a]).select().single();if(l)throw console.error("❌ Error de Supabase:",l),new Error(`Error al crear countdown: ${l.message}`);return console.log("✅ Countdown creado:",i),{id:i.id,public_url:i.public_url,title:i.title,targetDate:i.target_date,startDate:((r=i.custom_data)==null?void 0:r.start_date)||t.startDate,message:i.message,backgroundColor:i.background_color,textColor:i.text_color,progressIcon:i.progress_icon||"FaHourglassHalf",backgroundImage:i.background_image,useImage:!!i.background_image,views:i.views||0,created_at:i.created_at}}catch(s){throw console.error("💥 Error en createCountdown:",s),s}},async getCountdown(t){var e;try{console.log("🔍 Buscando countdown:",t);let r=ae.from("countdowns").select("*");/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)?r=r.eq("id",t):r=r.eq("public_url",t);const{data:n,error:a}=await r.single();if(a)throw a;return await this.incrementViews(n.id,n.views),{id:n.id,public_url:n.public_url,title:n.title,targetDate:n.target_date,startDate:((e=n.custom_data)==null?void 0:e.start_date)||n.created_at,message:n.message,backgroundColor:n.background_color||"#4a148c",textColor:n.text_color||"#ffffff",progressIcon:n.progress_icon||"FaHourglassHalf",backgroundImage:n.background_image,useImage:!!n.background_image,views:(n.views||0)+1,created_at:n.created_at,custom_data:n.custom_data||{}}}catch(r){throw console.error("💥 Error en getCountdown:",r),r}},async updateCountdown(t,e,r=null){var s;try{console.log("✏️ Actualizando countdown:",t);let n=e.backgroundImage;if(r&&e.useImage){const o=await ds.uploadBackgroundImage(r);o.success&&(n=o.url)}const a={title:e.title,target_date:this.formatDateForDB(e.targetDate),message:e.message||null,background_color:e.backgroundColor||"#4a148c",text_color:e.textColor||"#ffffff",background_image:n,progress_icon:e.progressIcon||"FaHourglassHalf",updated_at:new Date().toISOString(),custom_data:{...e.custom_data,start_date:this.formatDateForDB(e.startDate),use_image:!!e.useImage}};console.log("📤 Actualizando en BD:",a);const{data:i,error:l}=await ae.from("countdowns").update(a).eq("id",t).select().single();if(l)throw console.error("❌ Error de Supabase:",l),new Error(`Error al actualizar countdown: ${l.message}`);return localStorage.setItem(`countdown_${t}`,JSON.stringify({...e,backgroundImage:n})),console.log("✅ Countdown actualizado:",i),{id:i.id,public_url:i.public_url,title:i.title,targetDate:i.target_date,startDate:((s=i.custom_data)==null?void 0:s.start_date)||e.startDate,message:i.message,backgroundColor:i.background_color,textColor:i.text_color,progressIcon:i.progress_icon||"FaHourglassHalf",backgroundImage:i.background_image,useImage:!!i.background_image,views:i.views||0,created_at:i.created_at}}catch(n){console.error("💥 Error en updateCountdown:",n);try{return localStorage.setItem(`countdown_${t}`,JSON.stringify(e)),e}catch{throw n}}},async deleteCountdown(t){try{console.log("🗑️ Eliminando countdown:",t);const{error:e}=await ae.from("countdowns").delete().eq("id",t);if(e)throw console.error("❌ Error de Supabase:",e),new Error(`Error al eliminar countdown: ${e.message}`);return localStorage.removeItem(`countdown_${t}`),console.log("✅ Countdown eliminado"),!0}catch(e){console.error("💥 Error en deleteCountdown:",e);try{return localStorage.removeItem(`countdown_${t}`),!0}catch{throw e}}},formatDateForDB(t){return t?t.includes("T")&&t.endsWith("Z")?t:t.includes("T")?new Date(t).toISOString():new Date(t+"T00:00:00.000Z").toISOString():new Date().toISOString()},async incrementViews(t,e=0){try{await ae.from("countdowns").update({views:e+1,updated_at:new Date().toISOString()}).eq("id",t)}catch(r){console.error("⚠️ Error al incrementar vistas:",r)}},async testConnection(){var t;try{const{data:e,error:r}=await ae.from("countdowns").select("count(*)");if(r)throw r;return{success:!0,count:((t=e[0])==null?void 0:t.count)||0}}catch(e){return{success:!1,error:e.message}}}},uc=Ws(),dc=[{name:"Estrellas",url:"https://images.unsplash.com/photo-1519681393784-d120267933ba?w=800&auto=format&fit=crop"},{name:"Fiesta",url:"https://images.unsplash.com/photo-1530103862676-de8c9debad1d?w=800&auto=format&fit=crop"},{name:"Naturaleza",url:"https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=800&auto=format&fit=crop"},{name:"Navidad",url:"https://images.unsplash.com/photo-1544717305-2782549b5136?w=800&auto=format&fit=crop"},{name:"Abstracto",url:"https://images.unsplash.com/photo-1550684376-efcbd6e3f031?w=800&auto=format&fit=crop"},{name:"Reyes",url:"https://ccwrxgvddypgbbdmjsaw.supabase.co/storage/v1/object/public/countdown-images/backgrounds/1766347941172_1c9z4xkx0pt.jpg"}];function hc(){const t=fs(),e=k.useRef(null),[r,s]=k.useState(!1),[n,a]=k.useState(""),[i,l]=k.useState(!1),[o,u]=k.useState(""),[d,h]=k.useState({title:"Cumpleaños",targetDate:new Date(Date.now()+864e5).toISOString().slice(0,16),startDate:new Date().toISOString().slice(0,10),message:"¡Falta poco para tu día especial!",backgroundColor:"#4a148c",textColor:"#ffffff",backgroundImage:"",progressIcon:"https://cdn-icons-png.flaticon.com/512/3195/3195411.png",useImage:!1}),[f,g]=k.useState(null),[m,p]=k.useState(""),[b,y]=k.useState({days:0,hours:0,minutes:0,seconds:0}),[v,w]=k.useState(0);k.useEffect(()=>{const E=()=>{const C=new Date(d.targetDate),P=new Date(d.startDate),M=new Date,Q=C-M;if(Q<=0){y({days:0,hours:0,minutes:0,seconds:0}),w(100);return}const Y=Math.floor(Q/(1e3*60*60*24)),Ne=Math.floor(Q%(1e3*60*60*24)/(1e3*60*60)),Te=Math.floor(Q%(1e3*60*60)/(1e3*60)),Ie=Math.floor(Q%(1e3*60)/1e3);y({days:Y,hours:Ne,minutes:Te,seconds:Ie});const Je=C-P,Qe=M-P,Ye=Math.min(Math.max(Qe/Je*100,0),100);w(Ye)};E();const _=setInterval(E,1e3);return()=>clearInterval(_)},[d.targetDate,d.startDate]),k.useEffect(()=>()=>{m.startsWith("blob:")&&URL.revokeObjectURL(m)},[m]);const x=async E=>{E.preventDefault(),s(!0);try{console.log("🚀 Creando countdown...");const _=await Se.createCountdown(d,f);console.log("Respuesta del servicio:",_);const C=`https://dvdstv89.github.io/countdown-qr-app/#/c/${_.public_url}`;localStorage.setItem("last_countdown_url",C),localStorage.setItem("last_countdown_id",_.public_url),u(C);const P=await He.toDataURL(C,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"}});a(P),l(!0),D.success("✅ Countdown creado exitosamente!"),m.startsWith("blob:")&&(URL.revokeObjectURL(m),p(""),g(null))}catch(_){console.error("❌ Error:",_),D.error(`Error: ${_.message}`);const C=`local_${Date.now().toString(36)}`,P=`https://dvdstv89.github.io/countdown-qr-app/#/c/${C}`;u(P);const M=await He.toDataURL(P,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"}});a(M),l(!0),localStorage.setItem(`countdown_${C}`,JSON.stringify({id:C,public_url:C,...d,backgroundImage:m||d.backgroundImage,url:P,created:new Date().toISOString()})),D.success("Countdown guardado localmente")}finally{s(!1)}},j=E=>{const _=E.target.files[0];if(!_)return;if(_.size>5*1024*1024){D.error("La imagen es muy grande (máximo 5MB)");return}if(!["image/jpeg","image/png","image/webp","image/gif"].includes(_.type)){D.error("Formato no válido. Usa JPG, PNG, WebP o GIF");return}const P=URL.createObjectURL(_);p(P),g(_),h(M=>({...M,backgroundImage:P,useImage:!0})),D.success("Imagen cargada para subir")},S=()=>{m.startsWith("blob:")&&URL.revokeObjectURL(m),p(""),g(null),h(E=>({...E,backgroundImage:"",useImage:!1})),e.current&&(e.current.value=""),D.success("Imagen removida")},R=E=>{h(_=>({..._,backgroundImage:E,useImage:!0})),p(""),g(null),e.current&&(e.current.value="")},O=()=>{if(!n){D.error("Primero genera un QR");return}const E=document.createElement("a");E.download=`countdown-${d.title.replace(/\s+/g,"-")}-${Date.now()}.png`,E.href=n,E.click(),D.success("QR descargado")},$=async E=>{try{return await navigator.clipboard.writeText(E),D.success("✅ Enlace copiado!"),!0}catch(_){console.error("Error usando clipboard:",_);const C=document.createElement("textarea");C.value=E,C.style.position="fixed",C.style.left="-999999px",C.style.top="-999999px",document.body.appendChild(C),C.focus(),C.select();try{return document.execCommand("copy"),D.success("✅ Enlace copiado!"),!0}catch(P){return console.error("Fallback también falló:",P),D.error("❌ No se pudo copiar el enlace"),!1}finally{document.body.removeChild(C)}}},W=()=>{if(!o){D.error("Primero crea un countdown");return}$(o)};return c.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[c.jsxs("div",{className:"mb-8",children:[c.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Crear Countdown"}),c.jsx("p",{className:"text-gray-600",children:"Personaliza cada detalle de tu cuenta regresiva"})]}),c.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[c.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8",children:c.jsxs("form",{onSubmit:x,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Título del Evento *"}),c.jsx("input",{type:"text",value:d.title,onChange:E=>h({...d,title:E.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",placeholder:"Ej: Cumpleaños de ...",required:!0})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha del Evento *"}),c.jsx("input",{type:"datetime-local",value:d.targetDate,onChange:E=>h({...d,targetDate:E.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha de Inicio *"}),c.jsx("input",{type:"date",value:d.startDate,onChange:E=>h({...d,startDate:E.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",required:!0}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Para calcular el progreso"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje Personalizado"}),c.jsx("textarea",{value:d.message,onChange:E=>h({...d,message:E.target.value}),rows:"3",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition resize-none",placeholder:"¡Falta poco para tu día especial!",maxLength:200}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1 text-right",children:[d.message.length,"/200 caracteres"]})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color de Fondo"}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("input",{type:"color",value:d.backgroundColor,onChange:E=>h({...d,backgroundColor:E.target.value}),className:"w-12 h-12 rounded-lg cursor-pointer border border-gray-300 hover:border-purple-400 transition"}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-gray-600 font-mono",children:d.backgroundColor}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click para cambiar"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color de Texto"}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("input",{type:"color",value:d.textColor,onChange:E=>h({...d,textColor:E.target.value}),className:"w-12 h-12 rounded-lg cursor-pointer border border-gray-300 hover:border-purple-400 transition"}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-gray-600 font-mono",children:d.textColor}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click para cambiar"})]})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Icono de Progreso"}),c.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-3",children:uc.map(E=>c.jsxs("button",{type:"button",onClick:()=>h({...d,progressIcon:E.key}),className:`p-3 rounded-lg border-2 transition-all transform hover:scale-105 ${d.progressIcon===E.key?"border-purple-500 bg-purple-50 scale-105 ring-1 ring-purple-300":"border-gray-200 hover:border-purple-300 hover:bg-gray-50"}`,children:[c.jsx("div",{className:"w-8 h-8 mx-auto flex items-center justify-center text-xl",children:c.jsx(Ge,{iconKey:E.key,color:"#4a148c",size:"1.5em"})}),c.jsx("span",{className:"text-xs mt-1 block text-gray-700",children:E.name})]},E.key))})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Imagen de Fondo"}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("button",{type:"button",onClick:()=>{h({...d,useImage:!1,backgroundImage:""}),S()},className:`px-3 py-1 rounded text-sm transition ${d.useImage?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-purple-100 text-purple-700 border border-purple-300"}`,children:[c.jsx(_r,{className:"inline mr-1"})," Solo color"]}),c.jsxs("button",{type:"button",onClick:()=>h({...d,useImage:!0}),className:`px-3 py-1 rounded text-sm transition ${d.useImage?"bg-purple-100 text-purple-700 border border-purple-300":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[c.jsx(Rt,{className:"inline mr-1"})," Con imagen"]})]})]}),d.useImage?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-4",children:dc.map(E=>c.jsxs("button",{type:"button",onClick:()=>R(E.url),className:`rounded-lg overflow-hidden border-2 transition-all transform hover:scale-[1.02] ${d.backgroundImage===E.url?"border-purple-500 ring-2 ring-purple-300 scale-[1.02]":"border-gray-200 hover:border-purple-300"}`,children:[c.jsx("img",{src:E.url,alt:E.name,className:"w-full h-24 object-cover",loading:"lazy"}),c.jsx("div",{className:"p-2 text-xs text-center bg-white text-gray-700",children:E.name})]},E.url))}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"O sube tu propia imagen:"}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsxs("label",{className:"flex-1 cursor-pointer",children:[c.jsxs("div",{className:"px-4 py-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-purple-400 transition-colors text-center group",children:[c.jsx(Is,{className:"inline mr-2 text-gray-400 group-hover:text-purple-500 text-lg mb-1"}),c.jsx("span",{className:"text-gray-600 group-hover:text-purple-600",children:"Haz clic para subir imagen"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG o WebP (max 5MB)"})]}),c.jsx("input",{ref:e,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:j,className:"hidden"})]}),f&&c.jsx("button",{type:"button",onClick:S,className:"p-3 text-red-500 hover:bg-red-50 rounded-lg transition",title:"Eliminar imagen personalizada",children:c.jsx(Ns,{})})]})]}),m&&c.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Vista previa (se subirá a la nube):"}),c.jsxs("div",{className:"h-32 rounded overflow-hidden border relative",children:[c.jsx("img",{src:m,alt:"Preview personalizada",className:"w-full h-full object-cover"}),c.jsx("div",{className:"absolute bottom-2 right-2 bg-black/70 text-white text-xs px-2 py-1 rounded",children:f==null?void 0:f.name})]}),c.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["📏 Tamaño: ",((f==null?void 0:f.size)/1024/1024).toFixed(2)," MB"]})]}),d.backgroundImage&&!m&&d.backgroundImage!==""&&c.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Imagen seleccionada:"}),c.jsx("div",{className:"h-32 rounded overflow-hidden border",children:c.jsx("img",{src:d.backgroundImage,alt:"Preview seleccionada",className:"w-full h-full object-cover"})}),c.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"🖼️ Imagen predeterminada"})]})]}):c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:c.jsx("p",{className:"text-sm text-gray-600",children:'🎨 Usando solo color de fondo. Para agregar una imagen, selecciona "Con imagen".'})})]}),c.jsx("button",{type:"submit",disabled:r,className:"w-full py-4 px-6 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold rounded-lg shadow-lg hover:from-purple-700 hover:to-pink-700 transform hover:-translate-y-1 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:transform-none",children:r?c.jsxs("span",{className:"flex items-center justify-center",children:[c.jsxs("svg",{className:"animate-spin h-5 w-5 mr-3",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Guardando en la nube..."]}):"🎯 Generar Countdown y QR"})]})}),c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Vista Previa"}),c.jsx("div",{className:"rounded-xl overflow-hidden shadow-lg mb-6 min-h-[400px] flex flex-col justify-center relative",style:{background:d.useImage&&d.backgroundImage?`linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${d.backgroundImage}) center/cover`:d.backgroundColor},children:c.jsxs("div",{className:"p-8 flex-1 flex flex-col justify-center relative z-10",style:{color:d.textColor},children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h3",{className:"text-3xl font-bold mb-4 drop-shadow-lg",children:d.title}),c.jsx("p",{className:"text-xl opacity-90 drop-shadow",children:d.message})]}),c.jsx("div",{className:"flex flex-wrap justify-center gap-4 mb-8",children:Object.entries(b).map(([E,_])=>c.jsxs("div",{className:"text-center bg-black/40 backdrop-blur-sm rounded-lg p-4 min-w-[80px] border border-white/20",children:[c.jsx("div",{className:"text-3xl font-bold",children:_.toString().padStart(2,"0")}),c.jsx("div",{className:"text-sm uppercase opacity-90 mt-1",children:E})]},E))}),c.jsxs("div",{className:"relative mb-4 px-4",children:[c.jsx("div",{className:"h-4 bg-black/40 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-white/60 rounded-full transition-all duration-1000",style:{width:`${v}%`}})}),d.progressIcon&&c.jsx("div",{className:"absolute top-1/2 transform -translate-y-1/2 -translate-x-1/2 transition-all duration-1000",style:{left:`${v}%`},children:c.jsx("div",{className:"w-10 h-10 filter drop-shadow-lg",children:c.jsx(Ge,{iconKey:d.progressIcon,color:d.textColor,size:"2.5em",animate:!0})})})]}),c.jsxs("div",{className:"text-center text-sm opacity-90",children:["Progreso: ",c.jsxs("span",{className:"font-bold text-lg",children:[v.toFixed(1),"%"]})]})]})}),c.jsxs("div",{className:"text-center text-gray-600 space-y-2",children:[c.jsxs("p",{className:"flex items-center justify-center gap-2",children:[c.jsx("span",{className:"text-lg",children:"📱"})," Esta vista se verá en cualquier teléfono"]}),c.jsxs("p",{className:"flex items-center justify-center gap-2",children:[c.jsx("span",{className:"text-lg",children:"🔄"})," El contador se actualiza en tiempo real"]}),d.useImage?c.jsxs("p",{className:"flex items-center justify-center gap-2 text-purple-600 font-medium",children:[c.jsx("span",{className:"text-lg",children:"🖼️"})," ",m?"Con imagen personalizada":"Con imagen predeterminada"]}):c.jsxs("p",{className:"flex items-center justify-center gap-2 text-purple-600 font-medium",children:[c.jsx("span",{className:"text-lg",children:"🎨"})," Usando solo color de fondo"]})]})]}),i&&n&&c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Código QR Generado"}),c.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[c.jsxs("div",{className:"relative",children:[c.jsx("img",{src:n,alt:"QR Code",className:"border-4 border-white shadow-lg rounded-lg w-64 h-64"}),c.jsx("div",{className:"absolute -top-2 -right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:"✓"})]}),o&&c.jsxs("div",{className:"w-full max-w-md",children:[c.jsxs("p",{className:"text-sm text-gray-600 mb-2 font-medium flex items-center gap-2",children:[c.jsx(Ss,{})," Enlace generado:"]}),c.jsxs("div",{className:"flex items-center bg-gray-50 p-3 rounded-lg border border-gray-200",children:[c.jsx("code",{className:"flex-1 text-sm text-blue-600 break-all font-mono",children:o}),c.jsx("button",{onClick:()=>$(o),className:"ml-2 px-3 py-1.5 text-xs bg-blue-100 text-blue-600 rounded hover:bg-blue-200 transition font-medium",children:"Copiar"})]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 w-full max-w-md",children:[c.jsxs("button",{onClick:O,className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all flex items-center justify-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Descargar QR"]}),c.jsxs("button",{onClick:W,disabled:!o,className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white font-semibold rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copiar Enlace"]})]}),c.jsxs("div",{className:"text-center text-gray-600 space-y-3 pt-4 border-t",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsxs("p",{className:"flex items-center justify-center gap-2",children:[c.jsx("span",{className:"text-lg",children:"📱"})," Escanea este QR con la cámara de tu teléfono"]}),c.jsxs("p",{className:"flex items-center justify-center gap-2",children:[c.jsx("span",{className:"text-lg",children:"🔗"})," O comparte el enlace directamente"]})]}),c.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-100",children:[c.jsxs("p",{className:"text-green-700 font-medium flex items-center justify-center gap-2",children:[c.jsx("span",{className:"text-lg",children:"✅"})," Datos guardados en la nube"]}),c.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Tu countdown está disponible en cualquier dispositivo"})]}),c.jsxs("div",{className:"flex justify-center gap-4 pt-2",children:[c.jsx("button",{onClick:()=>t(`/c/${o.split("/").pop()}`),className:"px-4 py-2 text-sm bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition font-medium",children:"Ver Countdown"}),c.jsx("button",{onClick:()=>{o&&window.open(o,"_blank")},className:"px-4 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition font-medium",children:"Abrir en Nueva Pestaña"})]})]})]})]})]})]}),c.jsx("div",{className:"mt-12 pt-8 border-t border-gray-200",children:c.jsxs("div",{className:"grid md:grid-cols-3 gap-6 text-center md:text-left",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"🌐 Acceso Universal"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Tu countdown está disponible en cualquier dispositivo con internet"})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"📊 Estadísticas"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Podrás ver cuántas personas han visto tu countdown"})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"🔄 Actualización en Tiempo Real"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Los visitantes ven el contador actualizado al segundo"})]})]})})]})}function fc(){const{id:t}=gs(),[e,r]=k.useState(null),[s,n]=k.useState({}),[a,i]=k.useState(0),[l,o]=k.useState(!0),[u,d]=k.useState(null);if(k.useEffect(()=>{(async()=>{try{o(!0);const g=await Se.getCountdown(t);r(g),d(null)}catch(g){console.error("Error cargando countdown:",g),d("No se pudo cargar el countdown desde la nube");try{const m=localStorage.getItem(`countdown_${t}`);if(m){const p=JSON.parse(m);r(p),D.success("Cargado desde copia local")}}catch(m){console.error("Error cargando localmente:",m)}}finally{o(!1)}})()},[t]),k.useEffect(()=>{if(!e)return;const f=()=>{const m=new Date(e.targetDate),p=new Date(e.startDate),b=new Date,y=m-b;if(y<=0){n({days:0,hours:0,minutes:0,seconds:0,hasEnded:!0}),i(100);return}const v=Math.floor(y/(1e3*60*60*24)),w=Math.floor(y%(1e3*60*60*24)/(1e3*60*60)),x=Math.floor(y%(1e3*60*60)/(1e3*60)),j=Math.floor(y%(1e3*60)/1e3);n({days:v,hours:w,minutes:x,seconds:j,hasEnded:!1});const S=m-p,R=b-p,O=Math.min(Math.max(R/S*100,0),100);i(O)};f();const g=setInterval(f,1e3);return()=>clearInterval(g)},[e]),l)return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-500 to-pink-500",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto"}),c.jsx("p",{className:"mt-4 text-white",children:"Cargando countdown desde la nube..."})]})});if(u&&!e)return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-500 to-pink-500",children:c.jsxs("div",{className:"bg-white/10 backdrop-blur-sm p-8 rounded-2xl text-center max-w-md",children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"⚠️ Error"}),c.jsx("p",{className:"text-white mb-6",children:u}),c.jsx("button",{onClick:()=>window.location.href="/",className:"px-6 py-3 bg-white text-purple-600 font-bold rounded-lg hover:bg-gray-100",children:"Volver al inicio"})]})});const h=new Date(e.targetDate).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return c.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 md:p-6 relative",style:{background:e.useImage&&e.backgroundImage?`linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url(${e.backgroundImage}) center/cover no-repeat`:e.backgroundColor,color:e.textColor},children:c.jsxs("div",{className:"max-w-4xl w-full text-center space-y-8 md:space-y-10",children:[e.views>0&&c.jsxs("div",{className:"absolute top-4 right-4 bg-black/50 backdrop-blur-md px-4 py-2 rounded-full text-sm text-white/90 shadow-lg",children:["👁️ ",e.views," vistas"]}),c.jsxs("div",{className:"space-y-4 mb-6",children:[c.jsx("h1",{className:"text-4xl md:text-6xl font-bold drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)] px-4",children:e.title}),c.jsx("p",{className:"text-xl md:text-2xl opacity-95 drop-shadow-[0_2px_4px_rgba(0,0,0,0.6)] px-4",children:e.message})]}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-6 max-w-2xl mx-auto px-2",children:Object.entries({days:"Días",hours:"Horas",minutes:"Minutos",seconds:"Segundos"}).map(([f,g])=>{var m;return c.jsxs("div",{className:"bg-gradient-to-br from-black/40 to-black/20 backdrop-blur-lg rounded-2xl p-4 md:p-6 shadow-2xl border border-white/10",children:[c.jsx("div",{className:"text-4xl md:text-5xl font-bold mb-1 md:mb-2 font-mono tracking-tight",children:((m=s[f])==null?void 0:m.toString().padStart(2,"0"))||"00"}),c.jsx("div",{className:"text-sm md:text-base uppercase tracking-widest font-semibold opacity-90",children:g})]},f)})}),c.jsxs("div",{className:"relative py-6 md:py-8 px-2 max-w-2xl mx-auto w-full",children:[c.jsx("div",{className:"h-3 bg-black/40 backdrop-blur-sm rounded-full overflow-hidden shadow-inner",children:c.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500/80 to-purple-500/80 rounded-full transition-all duration-1000 shadow-lg",style:{width:`${a}%`}})}),e.progressIcon&&c.jsx("div",{className:"absolute top-1/2 transform -translate-y-1/2 -translate-x-1/2 transition-all duration-1000 z-10",style:{left:`${a}%`},children:c.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 filter drop-shadow-[0_0_20px_rgba(255,255,255,0.5)]",children:c.jsx(Ge,{iconKey:e.progressIcon,color:e.textColor,size:"4em",animate:!0})})})]}),c.jsx("div",{className:"mt-8 md:mt-12 pt-6 md:pt-8 border-t border-white/20 max-w-2xl mx-auto w-full",children:c.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 md:gap-6 px-2",children:[c.jsxs("div",{className:"bg-gradient-to-r from-black/50 to-black/30 backdrop-blur-md rounded-xl p-5 md:p-6 shadow-xl border border-white/10 flex-1",children:[c.jsx("h3",{className:"text-lg md:text-xl font-bold mb-2 text-white/90",children:"📅 Fecha del Evento"}),c.jsx("p",{className:"text-base md:text-lg text-white font-medium tracking-wide",children:h})]}),c.jsx("div",{children:c.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(window.location.href),alert("¡Enlace copiado al portapapeles!")},className:"px-6 py-3 md:px-8 md:py-4 bg-gradient-to-r from-white/25 to-white/15 backdrop-blur-lg rounded-xl transition-all duration-300 border border-white/30 flex items-center space-x-2 md:space-x-3 text-base md:text-xl font-semibold hover:bg-white/30 hover:scale-105 active:scale-95 shadow-lg hover:shadow-xl",children:[c.jsx(Da,{className:"text-xl md:text-2xl"}),c.jsx("span",{children:"Compartir"})]})})]})}),s.hasEnded&&c.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/80 backdrop-blur-sm z-50",children:c.jsxs("div",{className:"bg-gradient-to-br from-purple-600/95 to-pink-600/95 p-8 md:p-12 rounded-3xl text-center max-w-2xl mx-4 shadow-2xl border border-white/20",children:[c.jsx("div",{className:"text-6xl md:text-8xl mb-4 md:mb-6 animate-bounce",children:"🎉"}),c.jsx("h2",{className:"text-3xl md:text-5xl font-bold mb-3 md:mb-4 text-white drop-shadow-lg",children:"¡EL EVENTO HA LLEGADO!"}),c.jsx("p",{className:"text-xl md:text-2xl text-white/90 font-medium",children:"¡Es hora de celebrar!"})]})})]})})}var gc=Object.defineProperty,Ct=Object.getOwnPropertySymbols,hn=Object.prototype.hasOwnProperty,fn=Object.prototype.propertyIsEnumerable,hs=(t,e,r)=>e in t?gc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,br=(t,e)=>{for(var r in e||(e={}))hn.call(e,r)&&hs(t,r,e[r]);if(Ct)for(var r of Ct(e))fn.call(e,r)&&hs(t,r,e[r]);return t},yr=(t,e)=>{var r={};for(var s in t)hn.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&Ct)for(var s of Ct(t))e.indexOf(s)<0&&fn.call(t,s)&&(r[s]=t[s]);return r};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Ce;(t=>{const e=class A{constructor(o,u,d,h){if(this.version=o,this.errorCorrectionLevel=u,this.modules=[],this.isFunction=[],o<A.MIN_VERSION||o>A.MAX_VERSION)throw new RangeError("Version value out of range");if(h<-1||h>7)throw new RangeError("Mask value out of range");this.size=o*4+17;let f=[];for(let m=0;m<this.size;m++)f.push(!1);for(let m=0;m<this.size;m++)this.modules.push(f.slice()),this.isFunction.push(f.slice());this.drawFunctionPatterns();const g=this.addEccAndInterleave(d);if(this.drawCodewords(g),h==-1){let m=1e9;for(let p=0;p<8;p++){this.applyMask(p),this.drawFormatBits(p);const b=this.getPenaltyScore();b<m&&(h=p,m=b),this.applyMask(p)}}n(0<=h&&h<=7),this.mask=h,this.applyMask(h),this.drawFormatBits(h),this.isFunction=[]}static encodeText(o,u){const d=t.QrSegment.makeSegments(o);return A.encodeSegments(d,u)}static encodeBinary(o,u){const d=t.QrSegment.makeBytes(o);return A.encodeSegments([d],u)}static encodeSegments(o,u,d=1,h=40,f=-1,g=!0){if(!(A.MIN_VERSION<=d&&d<=h&&h<=A.MAX_VERSION)||f<-1||f>7)throw new RangeError("Invalid value");let m,p;for(m=d;;m++){const w=A.getNumDataCodewords(m,u)*8,x=i.getTotalBits(o,m);if(x<=w){p=x;break}if(m>=h)throw new RangeError("Data too long")}for(const w of[A.Ecc.MEDIUM,A.Ecc.QUARTILE,A.Ecc.HIGH])g&&p<=A.getNumDataCodewords(m,w)*8&&(u=w);let b=[];for(const w of o){r(w.mode.modeBits,4,b),r(w.numChars,w.mode.numCharCountBits(m),b);for(const x of w.getData())b.push(x)}n(b.length==p);const y=A.getNumDataCodewords(m,u)*8;n(b.length<=y),r(0,Math.min(4,y-b.length),b),r(0,(8-b.length%8)%8,b),n(b.length%8==0);for(let w=236;b.length<y;w^=253)r(w,8,b);let v=[];for(;v.length*8<b.length;)v.push(0);return b.forEach((w,x)=>v[x>>>3]|=w<<7-(x&7)),new A(m,u,v,f)}getModule(o,u){return 0<=o&&o<this.size&&0<=u&&u<this.size&&this.modules[u][o]}getModules(){return this.modules}drawFunctionPatterns(){for(let d=0;d<this.size;d++)this.setFunctionModule(6,d,d%2==0),this.setFunctionModule(d,6,d%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const o=this.getAlignmentPatternPositions(),u=o.length;for(let d=0;d<u;d++)for(let h=0;h<u;h++)d==0&&h==0||d==0&&h==u-1||d==u-1&&h==0||this.drawAlignmentPattern(o[d],o[h]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(o){const u=this.errorCorrectionLevel.formatBits<<3|o;let d=u;for(let f=0;f<10;f++)d=d<<1^(d>>>9)*1335;const h=(u<<10|d)^21522;n(h>>>15==0);for(let f=0;f<=5;f++)this.setFunctionModule(8,f,s(h,f));this.setFunctionModule(8,7,s(h,6)),this.setFunctionModule(8,8,s(h,7)),this.setFunctionModule(7,8,s(h,8));for(let f=9;f<15;f++)this.setFunctionModule(14-f,8,s(h,f));for(let f=0;f<8;f++)this.setFunctionModule(this.size-1-f,8,s(h,f));for(let f=8;f<15;f++)this.setFunctionModule(8,this.size-15+f,s(h,f));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let o=this.version;for(let d=0;d<12;d++)o=o<<1^(o>>>11)*7973;const u=this.version<<12|o;n(u>>>18==0);for(let d=0;d<18;d++){const h=s(u,d),f=this.size-11+d%3,g=Math.floor(d/3);this.setFunctionModule(f,g,h),this.setFunctionModule(g,f,h)}}drawFinderPattern(o,u){for(let d=-4;d<=4;d++)for(let h=-4;h<=4;h++){const f=Math.max(Math.abs(h),Math.abs(d)),g=o+h,m=u+d;0<=g&&g<this.size&&0<=m&&m<this.size&&this.setFunctionModule(g,m,f!=2&&f!=4)}}drawAlignmentPattern(o,u){for(let d=-2;d<=2;d++)for(let h=-2;h<=2;h++)this.setFunctionModule(o+h,u+d,Math.max(Math.abs(h),Math.abs(d))!=1)}setFunctionModule(o,u,d){this.modules[u][o]=d,this.isFunction[u][o]=!0}addEccAndInterleave(o){const u=this.version,d=this.errorCorrectionLevel;if(o.length!=A.getNumDataCodewords(u,d))throw new RangeError("Invalid argument");const h=A.NUM_ERROR_CORRECTION_BLOCKS[d.ordinal][u],f=A.ECC_CODEWORDS_PER_BLOCK[d.ordinal][u],g=Math.floor(A.getNumRawDataModules(u)/8),m=h-g%h,p=Math.floor(g/h);let b=[];const y=A.reedSolomonComputeDivisor(f);for(let w=0,x=0;w<h;w++){let j=o.slice(x,x+p-f+(w<m?0:1));x+=j.length;const S=A.reedSolomonComputeRemainder(j,y);w<m&&j.push(0),b.push(j.concat(S))}let v=[];for(let w=0;w<b[0].length;w++)b.forEach((x,j)=>{(w!=p-f||j>=m)&&v.push(x[w])});return n(v.length==g),v}drawCodewords(o){if(o.length!=Math.floor(A.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let u=0;for(let d=this.size-1;d>=1;d-=2){d==6&&(d=5);for(let h=0;h<this.size;h++)for(let f=0;f<2;f++){const g=d-f,p=(d+1&2)==0?this.size-1-h:h;!this.isFunction[p][g]&&u<o.length*8&&(this.modules[p][g]=s(o[u>>>3],7-(u&7)),u++)}}n(u==o.length*8)}applyMask(o){if(o<0||o>7)throw new RangeError("Mask value out of range");for(let u=0;u<this.size;u++)for(let d=0;d<this.size;d++){let h;switch(o){case 0:h=(d+u)%2==0;break;case 1:h=u%2==0;break;case 2:h=d%3==0;break;case 3:h=(d+u)%3==0;break;case 4:h=(Math.floor(d/3)+Math.floor(u/2))%2==0;break;case 5:h=d*u%2+d*u%3==0;break;case 6:h=(d*u%2+d*u%3)%2==0;break;case 7:h=((d+u)%2+d*u%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[u][d]&&h&&(this.modules[u][d]=!this.modules[u][d])}}getPenaltyScore(){let o=0;for(let f=0;f<this.size;f++){let g=!1,m=0,p=[0,0,0,0,0,0,0];for(let b=0;b<this.size;b++)this.modules[f][b]==g?(m++,m==5?o+=A.PENALTY_N1:m>5&&o++):(this.finderPenaltyAddHistory(m,p),g||(o+=this.finderPenaltyCountPatterns(p)*A.PENALTY_N3),g=this.modules[f][b],m=1);o+=this.finderPenaltyTerminateAndCount(g,m,p)*A.PENALTY_N3}for(let f=0;f<this.size;f++){let g=!1,m=0,p=[0,0,0,0,0,0,0];for(let b=0;b<this.size;b++)this.modules[b][f]==g?(m++,m==5?o+=A.PENALTY_N1:m>5&&o++):(this.finderPenaltyAddHistory(m,p),g||(o+=this.finderPenaltyCountPatterns(p)*A.PENALTY_N3),g=this.modules[b][f],m=1);o+=this.finderPenaltyTerminateAndCount(g,m,p)*A.PENALTY_N3}for(let f=0;f<this.size-1;f++)for(let g=0;g<this.size-1;g++){const m=this.modules[f][g];m==this.modules[f][g+1]&&m==this.modules[f+1][g]&&m==this.modules[f+1][g+1]&&(o+=A.PENALTY_N2)}let u=0;for(const f of this.modules)u=f.reduce((g,m)=>g+(m?1:0),u);const d=this.size*this.size,h=Math.ceil(Math.abs(u*20-d*10)/d)-1;return n(0<=h&&h<=9),o+=h*A.PENALTY_N4,n(0<=o&&o<=2568888),o}getAlignmentPatternPositions(){if(this.version==1)return[];{const o=Math.floor(this.version/7)+2,u=this.version==32?26:Math.ceil((this.version*4+4)/(o*2-2))*2;let d=[6];for(let h=this.size-7;d.length<o;h-=u)d.splice(1,0,h);return d}}static getNumRawDataModules(o){if(o<A.MIN_VERSION||o>A.MAX_VERSION)throw new RangeError("Version number out of range");let u=(16*o+128)*o+64;if(o>=2){const d=Math.floor(o/7)+2;u-=(25*d-10)*d-55,o>=7&&(u-=36)}return n(208<=u&&u<=29648),u}static getNumDataCodewords(o,u){return Math.floor(A.getNumRawDataModules(o)/8)-A.ECC_CODEWORDS_PER_BLOCK[u.ordinal][o]*A.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][o]}static reedSolomonComputeDivisor(o){if(o<1||o>255)throw new RangeError("Degree out of range");let u=[];for(let h=0;h<o-1;h++)u.push(0);u.push(1);let d=1;for(let h=0;h<o;h++){for(let f=0;f<u.length;f++)u[f]=A.reedSolomonMultiply(u[f],d),f+1<u.length&&(u[f]^=u[f+1]);d=A.reedSolomonMultiply(d,2)}return u}static reedSolomonComputeRemainder(o,u){let d=u.map(h=>0);for(const h of o){const f=h^d.shift();d.push(0),u.forEach((g,m)=>d[m]^=A.reedSolomonMultiply(g,f))}return d}static reedSolomonMultiply(o,u){if(o>>>8||u>>>8)throw new RangeError("Byte out of range");let d=0;for(let h=7;h>=0;h--)d=d<<1^(d>>>7)*285,d^=(u>>>h&1)*o;return n(d>>>8==0),d}finderPenaltyCountPatterns(o){const u=o[1];n(u<=this.size*3);const d=u>0&&o[2]==u&&o[3]==u*3&&o[4]==u&&o[5]==u;return(d&&o[0]>=u*4&&o[6]>=u?1:0)+(d&&o[6]>=u*4&&o[0]>=u?1:0)}finderPenaltyTerminateAndCount(o,u,d){return o&&(this.finderPenaltyAddHistory(u,d),u=0),u+=this.size,this.finderPenaltyAddHistory(u,d),this.finderPenaltyCountPatterns(d)}finderPenaltyAddHistory(o,u){u[0]==0&&(o+=this.size),u.pop(),u.unshift(o)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],t.QrCode=e;function r(l,o,u){if(o<0||o>31||l>>>o)throw new RangeError("Value out of range");for(let d=o-1;d>=0;d--)u.push(l>>>d&1)}function s(l,o){return(l>>>o&1)!=0}function n(l){if(!l)throw new Error("Assertion error")}const a=class F{constructor(o,u,d){if(this.mode=o,this.numChars=u,this.bitData=d,u<0)throw new RangeError("Invalid argument");this.bitData=d.slice()}static makeBytes(o){let u=[];for(const d of o)r(d,8,u);return new F(F.Mode.BYTE,o.length,u)}static makeNumeric(o){if(!F.isNumeric(o))throw new RangeError("String contains non-numeric characters");let u=[];for(let d=0;d<o.length;){const h=Math.min(o.length-d,3);r(parseInt(o.substring(d,d+h),10),h*3+1,u),d+=h}return new F(F.Mode.NUMERIC,o.length,u)}static makeAlphanumeric(o){if(!F.isAlphanumeric(o))throw new RangeError("String contains unencodable characters in alphanumeric mode");let u=[],d;for(d=0;d+2<=o.length;d+=2){let h=F.ALPHANUMERIC_CHARSET.indexOf(o.charAt(d))*45;h+=F.ALPHANUMERIC_CHARSET.indexOf(o.charAt(d+1)),r(h,11,u)}return d<o.length&&r(F.ALPHANUMERIC_CHARSET.indexOf(o.charAt(d)),6,u),new F(F.Mode.ALPHANUMERIC,o.length,u)}static makeSegments(o){return o==""?[]:F.isNumeric(o)?[F.makeNumeric(o)]:F.isAlphanumeric(o)?[F.makeAlphanumeric(o)]:[F.makeBytes(F.toUtf8ByteArray(o))]}static makeEci(o){let u=[];if(o<0)throw new RangeError("ECI assignment value out of range");if(o<128)r(o,8,u);else if(o<16384)r(2,2,u),r(o,14,u);else if(o<1e6)r(6,3,u),r(o,21,u);else throw new RangeError("ECI assignment value out of range");return new F(F.Mode.ECI,0,u)}static isNumeric(o){return F.NUMERIC_REGEX.test(o)}static isAlphanumeric(o){return F.ALPHANUMERIC_REGEX.test(o)}getData(){return this.bitData.slice()}static getTotalBits(o,u){let d=0;for(const h of o){const f=h.mode.numCharCountBits(u);if(h.numChars>=1<<f)return 1/0;d+=4+f+h.bitData.length}return d}static toUtf8ByteArray(o){o=encodeURI(o);let u=[];for(let d=0;d<o.length;d++)o.charAt(d)!="%"?u.push(o.charCodeAt(d)):(u.push(parseInt(o.substring(d+1,d+3),16)),d+=2);return u}};a.NUMERIC_REGEX=/^[0-9]*$/,a.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,a.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let i=a;t.QrSegment=a})(Ce||(Ce={}));(t=>{(e=>{const r=class{constructor(n,a){this.ordinal=n,this.formatBits=a}};r.LOW=new r(0,1),r.MEDIUM=new r(1,0),r.QUARTILE=new r(2,3),r.HIGH=new r(3,2),e.Ecc=r})(t.QrCode||(t.QrCode={}))})(Ce||(Ce={}));(t=>{(e=>{const r=class{constructor(n,a){this.modeBits=n,this.numBitsCharCount=a}numCharCountBits(n){return this.numBitsCharCount[Math.floor((n+7)/17)]}};r.NUMERIC=new r(1,[10,12,14]),r.ALPHANUMERIC=new r(2,[9,11,13]),r.BYTE=new r(4,[8,16,16]),r.KANJI=new r(8,[8,10,12]),r.ECI=new r(7,[0,0,0]),e.Mode=r})(t.QrSegment||(t.QrSegment={}))})(Ce||(Ce={}));var ze=Ce;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var mc={L:ze.QrCode.Ecc.LOW,M:ze.QrCode.Ecc.MEDIUM,Q:ze.QrCode.Ecc.QUARTILE,H:ze.QrCode.Ecc.HIGH},gn=128,mn="L",pn="#FFFFFF",wn="#000000",bn=!1,yn=1,pc=4,wc=0,bc=.1;function vn(t,e=0){const r=[];return t.forEach(function(s,n){let a=null;s.forEach(function(i,l){if(!i&&a!==null){r.push(`M${a+e} ${n+e}h${l-a}v1H${a+e}z`),a=null;return}if(l===s.length-1){if(!i)return;a===null?r.push(`M${l+e},${n+e} h1v1H${l+e}z`):r.push(`M${a+e},${n+e} h${l+1-a}v1H${a+e}z`);return}i&&a===null&&(a=l)})}),r.join("")}function xn(t,e){return t.slice().map((r,s)=>s<e.y||s>=e.y+e.h?r:r.map((n,a)=>a<e.x||a>=e.x+e.w?n:!1))}function yc(t,e,r,s){if(s==null)return null;const n=t.length+r*2,a=Math.floor(e*bc),i=n/e,l=(s.width||a)*i,o=(s.height||a)*i,u=s.x==null?t.length/2-l/2:s.x*i,d=s.y==null?t.length/2-o/2:s.y*i,h=s.opacity==null?1:s.opacity;let f=null;if(s.excavate){let m=Math.floor(u),p=Math.floor(d),b=Math.ceil(l+u-m),y=Math.ceil(o+d-p);f={x:m,y:p,w:b,h:y}}const g=s.crossOrigin;return{x:u,y:d,h:o,w:l,excavation:f,opacity:h,crossOrigin:g}}function vc(t,e){return e!=null?Math.max(Math.floor(e),0):t?pc:wc}function _n({value:t,level:e,minVersion:r,includeMargin:s,marginSize:n,imageSettings:a,size:i,boostLevel:l}){let o=L.useMemo(()=>{const m=(Array.isArray(t)?t:[t]).reduce((p,b)=>(p.push(...ze.QrSegment.makeSegments(b)),p),[]);return ze.QrCode.encodeSegments(m,mc[e],r,void 0,void 0,l)},[t,e,r,l]);const{cells:u,margin:d,numCells:h,calculatedImageSettings:f}=L.useMemo(()=>{let g=o.getModules();const m=vc(s,n),p=g.length+m*2,b=yc(g,i,m,a);return{cells:g,margin:m,numCells:p,calculatedImageSettings:b}},[o,i,a,s,n]);return{qrcode:o,margin:d,cells:u,numCells:h,calculatedImageSettings:f}}var xc=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),_c=L.forwardRef(function(e,r){const s=e,{value:n,size:a=gn,level:i=mn,bgColor:l=pn,fgColor:o=wn,includeMargin:u=bn,minVersion:d=yn,boostLevel:h,marginSize:f,imageSettings:g}=s,p=yr(s,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:b}=p,y=yr(p,["style"]),v=g==null?void 0:g.src,w=L.useRef(null),x=L.useRef(null),j=L.useCallback(P=>{w.current=P,typeof r=="function"?r(P):r&&(r.current=P)},[r]),[S,R]=L.useState(!1),{margin:O,cells:$,numCells:W,calculatedImageSettings:E}=_n({value:n,level:i,minVersion:d,boostLevel:h,includeMargin:u,marginSize:f,imageSettings:g,size:a});L.useEffect(()=>{if(w.current!=null){const P=w.current,M=P.getContext("2d");if(!M)return;let Q=$;const Y=x.current,Ne=E!=null&&Y!==null&&Y.complete&&Y.naturalHeight!==0&&Y.naturalWidth!==0;Ne&&E.excavation!=null&&(Q=xn($,E.excavation));const Te=window.devicePixelRatio||1;P.height=P.width=a*Te;const Ie=a/W*Te;M.scale(Ie,Ie),M.fillStyle=l,M.fillRect(0,0,W,W),M.fillStyle=o,xc?M.fill(new Path2D(vn(Q,O))):$.forEach(function(Je,Qe){Je.forEach(function(Ye,Bt){Ye&&M.fillRect(Bt+O,Qe+O,1,1)})}),E&&(M.globalAlpha=E.opacity),Ne&&M.drawImage(Y,E.x+O,E.y+O,E.w,E.h)}}),L.useEffect(()=>{R(!1)},[v]);const _=br({height:a,width:a},b);let C=null;return v!=null&&(C=L.createElement("img",{src:v,key:v,style:{display:"none"},onLoad:()=>{R(!0)},ref:x,crossOrigin:E==null?void 0:E.crossOrigin})),L.createElement(L.Fragment,null,L.createElement("canvas",br({style:_,height:a,width:a,ref:j,role:"img"},y)),C)});_c.displayName="QRCodeCanvas";var Or=L.forwardRef(function(e,r){const s=e,{value:n,size:a=gn,level:i=mn,bgColor:l=pn,fgColor:o=wn,includeMargin:u=bn,minVersion:d=yn,boostLevel:h,title:f,marginSize:g,imageSettings:m}=s,p=yr(s,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:b,cells:y,numCells:v,calculatedImageSettings:w}=_n({value:n,level:i,minVersion:d,boostLevel:h,includeMargin:u,marginSize:g,imageSettings:m,size:a});let x=y,j=null;m!=null&&w!=null&&(w.excavation!=null&&(x=xn(y,w.excavation)),j=L.createElement("image",{href:m.src,height:w.h,width:w.w,x:w.x+b,y:w.y+b,preserveAspectRatio:"none",opacity:w.opacity,crossOrigin:w.crossOrigin}));const S=vn(x,b);return L.createElement("svg",br({height:a,width:a,viewBox:`0 0 ${v} ${v}`,ref:r,role:"img"},p),!!f&&L.createElement("title",null,f),L.createElement("path",{fill:l,d:`M0,0 h${v}v${v}H0z`,shapeRendering:"crispEdges"}),L.createElement("path",{fill:o,d:S,shapeRendering:"crispEdges"}),j)});Or.displayName="QRCodeSVG";function Ec(){const[t,e]=k.useState([]),[r,s]=k.useState(!0),[n,a]=k.useState(null),[i,l]=k.useState(null),[o,u]=k.useState(null);k.useEffect(()=>{d()},[]);const d=async()=>{try{s(!0);const p=await Se.getAllCountdowns();e(p)}catch(p){console.error("Error cargando countdowns:",p),D.error("Error al cargar la lista")}finally{s(!1)}},h=async p=>{if(window.confirm("¿Estás seguro de eliminar este countdown? Esta acción no se puede deshacer."))try{u(p),await Se.deleteCountdown(p),e(t.filter(b=>b.id!==p)),D.success("Countdown eliminado exitosamente")}catch{D.error("Error al eliminar el countdown")}finally{u(null)}},f=p=>{const b=`https://dvdstv89.github.io/countdown-qr-app/#/c/${i.public_url||i.id}`;navigator.clipboard.writeText(b),D.success("¡Enlace copiado al portapapeles!")},g=p=>new Date(p).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),m=p=>{const b=`https://dvdstv89.github.io/countdown-qr-app/#/c/${p.public_url||p.id}`;window.open(b,"_blank")};return r?c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-50 to-pink-50",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Cargando tus countdowns..."})]})}):c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50 py-12 px-4",children:[c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsxs("div",{className:"mb-10 text-center md:text-left",children:[c.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Mis Countdowns"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Gestiona y edita todos tus countdowns creados"}),c.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[c.jsx("div",{children:c.jsxs("p",{className:"text-sm text-gray-500",children:[c.jsx("span",{className:"font-semibold text-purple-600",children:t.length})," countdowns creados"]})}),c.jsxs("div",{className:"flex gap-3",children:[c.jsxs(ue,{to:"/",className:"px-5 py-2.5 bg-white text-gray-700 rounded-lg hover:bg-gray-50 transition-all border border-gray-200 shadow-sm flex items-center gap-2",children:[c.jsx(ja,{}),"Inicio"]}),c.jsxs(ue,{to:"/create",className:"px-5 py-2.5 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all shadow-md flex items-center gap-2",children:[c.jsx("span",{children:"+"}),"Crear Nuevo"]})]})]})]}),t.length===0?c.jsxs("div",{className:"text-center py-16 bg-white rounded-2xl shadow-sm border border-gray-100",children:[c.jsx("div",{className:"text-6xl mb-4",children:"⏳"}),c.jsx("h3",{className:"text-2xl font-semibold text-gray-700 mb-2",children:"No hay countdowns creados"}),c.jsx("p",{className:"text-gray-500 mb-6",children:"Crea tu primer countdown para empezar"}),c.jsx(ue,{to:"/create",className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all shadow-md",children:"Crear mi primer countdown"})]}):c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(p=>{var b;return c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100 hover:shadow-xl transition-all duration-300 group",children:[c.jsxs("div",{className:"h-48 relative overflow-hidden",style:{background:p.useImage&&p.backgroundImage?`linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url(${p.backgroundImage})`:p.backgroundColor,backgroundSize:"cover",backgroundPosition:"center"},children:[c.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:c.jsxs("div",{className:"text-center text-white p-4",children:[c.jsx("h3",{className:"text-2xl font-bold mb-2 drop-shadow-lg",children:p.title}),c.jsx("p",{className:"text-sm opacity-90 line-clamp-2",children:p.message||"Sin mensaje"})]})}),c.jsxs("div",{className:"absolute top-3 right-3 flex gap-2",children:[c.jsx("span",{className:"bg-black/60 backdrop-blur-sm text-white text-xs px-2 py-1 rounded-full",children:p.useImage?c.jsx(Rt,{}):c.jsx(_r,{})}),p.views>0&&c.jsxs("span",{className:"bg-black/60 backdrop-blur-sm text-white text-xs px-2 py-1 rounded-full",children:["👁️ ",p.views]})]})]}),c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"space-y-3 mb-6",children:[c.jsxs("div",{className:"flex items-center text-gray-600",children:[c.jsx(Sa,{className:"mr-2 text-purple-500 flex-shrink-0"}),c.jsx("span",{className:"text-sm truncate",title:g(p.targetDate),children:g(p.targetDate)})]}),c.jsxs("div",{className:"flex items-center justify-between text-sm",children:[c.jsxs("div",{className:"text-gray-500",children:["ID:",c.jsx("code",{className:"ml-1 bg-gray-100 px-2 py-1 rounded text-xs",children:((b=p.public_url)==null?void 0:b.substring(0,8))||"local"})]}),c.jsxs("div",{className:"text-gray-500",children:["Icono:",c.jsx("span",{className:"ml-2 inline-block",children:c.jsx(Ge,{iconKey:p.progressIcon,color:"#8B5CF6",size:"1em"})})]})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs("button",{onClick:()=>m(p),className:"flex-1 flex items-center justify-center px-3 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors text-sm",title:"Ver en nueva pestaña",children:[c.jsx(Ur,{className:"mr-2"}),"Ver"]}),c.jsxs(ue,{to:`/edit/${p.id}`,className:"flex-1 flex items-center justify-center px-3 py-2 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 transition-colors text-sm",children:[c.jsx(Ca,{className:"mr-2"}),"Editar"]}),c.jsx("button",{onClick:()=>l(p),className:"flex items-center justify-center px-3 py-2 bg-orange-50 text-orange-600 rounded-lg hover:bg-orange-100 transition-colors",title:"Ver QR",children:c.jsx(Cs,{})}),c.jsx("button",{onClick:()=>f(),className:"flex items-center justify-center px-3 py-2 bg-purple-50 text-purple-600 rounded-lg hover:bg-purple-100 transition-colors",title:"Copiar enlace",children:c.jsx(Lr,{})}),c.jsx("button",{onClick:()=>h(p.id),disabled:o===p.id,className:"flex items-center justify-center px-3 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors disabled:opacity-50",title:"Eliminar",children:o===p.id?c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):c.jsx(Ts,{})})]})]})]},p.id)})}),t.length>0&&c.jsx("div",{className:"mt-8 text-center text-sm text-gray-500",children:c.jsx("p",{children:"💡 Consejo: Puedes editar cualquier countdown para actualizar sus datos o imagen de fondo"})})]}),i&&c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:c.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full animate-fadeIn",children:[c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Código QR"}),c.jsxs("p",{className:"text-gray-600",children:['Escanea para ver "',i.title,'"']})]}),c.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-200 mb-6 flex items-center justify-center",children:c.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:c.jsx(Or,{value:`https://dvdstv89.github.io/countdown-qr-app/#/c/${i.public_url||i.id}`,size:200,level:"H",bgColor:"#FFFFFF",fgColor:"#8B5CF6"})})}),c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("div",{className:"inline-flex items-center bg-gray-50 px-4 py-2 rounded-lg mb-3",children:c.jsx("code",{className:"text-sm text-blue-600 break-all font-mono",children:i.public_url||i.id})}),c.jsx("p",{className:"text-xs text-gray-500",children:"URL pública del countdown"})]}),c.jsxs("div",{className:"flex flex-col gap-3",children:[c.jsxs("button",{onClick:()=>f(),className:"py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all font-medium flex items-center justify-center gap-2",children:[c.jsx(Lr,{}),"Copiar enlace"]}),c.jsxs("button",{onClick:()=>{const p=`https://dvdstv89.github.io/countdown-qr-app/#/c/${i.public_url||i.id}`;window.open(p,"_blank")},className:"py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all font-medium flex items-center justify-center gap-2",children:[c.jsx(Ur,{}),"Abrir countdown"]}),c.jsx("button",{onClick:()=>l(null),className:"py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all",children:"Cerrar"})]})]})})]})}const kc=Ws(),jc=[{name:"Estrellas",url:"https://images.unsplash.com/photo-1519681393784-d120267933ba?w=800&auto=format&fit=crop"},{name:"Fiesta",url:"https://images.unsplash.com/photo-1530103862676-de8c9debad1d?w=800&auto=format&fit=crop"},{name:"Naturaleza",url:"https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=800&auto=format&fit=crop"},{name:"Navidad",url:"https://images.unsplash.com/photo-1544717305-2782549b5136?w=800&auto=format&fit=crop"},{name:"Abstracto",url:"https://images.unsplash.com/photo-1550684376-efcbd6e3f031?w=800&auto=format&fit=crop"},{name:"Reyes",url:"https://ccwrxgvddypgbbdmjsaw.supabase.co/storage/v1/object/public/countdown-images/backgrounds/1766347941172_1c9z4xkx0pt.jpg"}];function Sc(){const{id:t}=gs(),e=fs(),r=k.useRef(null),[s,n]=k.useState(!0),[a,i]=k.useState(!1),[l,o]=k.useState(!1),[u,d]=k.useState(null),[h,f]=k.useState({title:"",message:"",targetDate:"",startDate:"",backgroundColor:"#4a148c",textColor:"#ffffff",backgroundImage:"",progressIcon:"FaHourglassHalf",useImage:!1}),[g,m]=k.useState(""),[p,b]=k.useState({days:0,hours:0,minutes:0,seconds:0}),[y,v]=k.useState(0);k.useEffect(()=>{w()},[t]),k.useEffect(()=>{if(!h.targetDate||!h.startDate)return;const _=()=>{const P=new Date(h.targetDate),M=new Date(h.startDate),Q=new Date,Y=P-Q;if(Y<=0){b({days:0,hours:0,minutes:0,seconds:0}),v(100);return}const Ne=Math.floor(Y/(1e3*60*60*24)),Te=Math.floor(Y%(1e3*60*60*24)/(1e3*60*60)),Ie=Math.floor(Y%(1e3*60*60)/(1e3*60)),Je=Math.floor(Y%(1e3*60)/1e3);b({days:Ne,hours:Te,minutes:Ie,seconds:Je});const Qe=P-M,Ye=Q-M,Bt=Math.min(Math.max(Ye/Qe*100,0),100);v(Bt)};_();const C=setInterval(_,1e3);return()=>clearInterval(C)},[h.targetDate,h.startDate]),k.useEffect(()=>()=>{g.startsWith("blob:")&&URL.revokeObjectURL(g)},[g]);const w=async()=>{try{n(!0);const _=await Se.getCountdown(t),C=P=>P?new Date(P).toISOString().slice(0,16):"";f({title:_.title||"",message:_.message||"",targetDate:C(_.targetDate),startDate:C(_.startDate),backgroundColor:_.backgroundColor||"#4a148c",textColor:_.textColor||"#ffffff",backgroundImage:_.backgroundImage||"",progressIcon:_.progressIcon||"FaHourglassHalf",useImage:!!_.backgroundImage}),_.backgroundImage&&!_.backgroundImage.startsWith("blob:")&&m(_.backgroundImage)}catch(_){console.error("Error cargando countdown:",_),D.error("No se pudo cargar el countdown"),e("/list")}finally{n(!1)}},x=_=>{const{name:C,value:P,type:M,checked:Q}=_.target;f(Y=>({...Y,[C]:M==="checkbox"?Q:P}))},j=_=>{const C=_.target.files[0];if(!C)return;if(C.size>5*1024*1024){D.error("La imagen es muy grande (máximo 5MB)");return}if(!["image/jpeg","image/png","image/webp","image/gif"].includes(C.type)){D.error("Formato no válido. Usa JPG, PNG, WebP o GIF");return}const M=URL.createObjectURL(C);m(M),d(C),f(Q=>({...Q,backgroundImage:M,useImage:!0})),D.success("Imagen cargada para subir")},S=()=>{g.startsWith("blob:")&&URL.revokeObjectURL(g),m(""),d(null),f(_=>({..._,backgroundImage:"",useImage:!1})),r.current&&(r.current.value=""),D.success("Imagen removida")},R=_=>{f(C=>({...C,backgroundImage:_,useImage:!0})),m(""),d(null),r.current&&(r.current.value="")},O=async _=>{_.preventDefault();try{i(!0);const C={...h,useImage:!!h.useImage,backgroundImage:g||h.backgroundImage};await Se.updateCountdown(t,C,u),D.success("¡Countdown actualizado exitosamente!"),setTimeout(()=>{e("/list")},1500)}catch(C){console.error("Error actualizando:",C),D.error("Error al actualizar el countdown")}finally{i(!1)}},$=async()=>{if(window.confirm("¿Estás seguro de eliminar este countdown? Esta acción no se puede deshacer."))try{o(!0),await Se.deleteCountdown(t),D.success("Countdown eliminado exitosamente"),e("/list")}catch(_){console.error("Error eliminando:",_),D.error("Error al eliminar el countdown")}finally{o(!1)}},W=async _=>{try{await navigator.clipboard.writeText(_),D.success("✅ Enlace copiado!")}catch(C){console.error("Error usando clipboard:",C),D.error("❌ No se pudo copiar el enlace")}};if(s)return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-50 to-pink-50",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})});const E=`https://dvdstv89.github.io/countdown-qr-app/#/c/${t}`;return c.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Editar Countdown"}),c.jsx("p",{className:"text-gray-600",children:"Modifica los detalles de tu cuenta regresiva"})]}),c.jsxs("button",{onClick:()=>e("/list"),className:"flex items-center gap-2 px-4 py-2.5 bg-white text-gray-700 rounded-lg hover:bg-gray-50 transition-all border border-gray-200 shadow-sm",children:[c.jsx(Ea,{}),"Volver a la lista"]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 text-sm",children:[c.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[c.jsx("p",{className:"font-medium text-gray-700",children:"ID:"}),c.jsx("code",{className:"text-sm text-purple-600",children:t})]}),c.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[c.jsx("p",{className:"font-medium text-gray-700",children:"URL:"}),c.jsx("code",{className:"text-sm text-blue-600 truncate",children:E})]}),c.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[c.jsx("p",{className:"font-medium text-gray-700",children:"Estado:"}),c.jsx("span",{className:"text-sm text-green-600",children:"Activo"})]})]})]}),c.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[c.jsx("div",{className:"space-y-8",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Información básica"}),c.jsxs("form",{onSubmit:O,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Título del Evento *"}),c.jsx("input",{type:"text",name:"title",value:h.title,onChange:x,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",placeholder:"Ej: Cumpleaños de ...",required:!0})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha del Evento *"}),c.jsx("input",{type:"datetime-local",name:"targetDate",value:h.targetDate,onChange:x,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha de Inicio *"}),c.jsx("input",{type:"datetime-local",name:"startDate",value:h.startDate,onChange:x,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",required:!0}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Para calcular el progreso"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje Personalizado"}),c.jsx("textarea",{name:"message",value:h.message,onChange:x,rows:"3",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition resize-none",placeholder:"¡Falta poco para tu día especial!",maxLength:200}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1 text-right",children:[h.message.length,"/200 caracteres"]})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color de Fondo"}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("input",{type:"color",name:"backgroundColor",value:h.backgroundColor,onChange:x,className:"w-12 h-12 rounded-lg cursor-pointer border border-gray-300 hover:border-purple-400 transition"}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-gray-600 font-mono",children:h.backgroundColor}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click para cambiar"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color de Texto"}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("input",{type:"color",name:"textColor",value:h.textColor,onChange:x,className:"w-12 h-12 rounded-lg cursor-pointer border border-gray-300 hover:border-purple-400 transition"}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-gray-600 font-mono",children:h.textColor}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click para cambiar"})]})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Icono de Progreso"}),c.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-3",children:kc.map(_=>c.jsxs("button",{type:"button",onClick:()=>f({...h,progressIcon:_.key}),className:`p-3 rounded-lg border-2 transition-all transform hover:scale-105 ${h.progressIcon===_.key?"border-purple-500 bg-purple-50 scale-105 ring-1 ring-purple-300":"border-gray-200 hover:border-purple-300 hover:bg-gray-50"}`,children:[c.jsx("div",{className:"w-8 h-8 mx-auto flex items-center justify-center text-xl",children:c.jsx(Ge,{iconKey:_.key,color:"#4a148c",size:"1.5em"})}),c.jsx("span",{className:"text-xs mt-1 block text-gray-700",children:_.name})]},_.key))})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Imagen de Fondo"}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("button",{type:"button",onClick:()=>{f({...h,useImage:!1,backgroundImage:""}),S()},className:`px-3 py-1 rounded text-sm transition ${h.useImage?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-purple-100 text-purple-700 border border-purple-300"}`,children:[c.jsx(_r,{className:"inline mr-1"})," Solo color"]}),c.jsxs("button",{type:"button",onClick:()=>f({...h,useImage:!0}),className:`px-3 py-1 rounded text-sm transition ${h.useImage?"bg-purple-100 text-purple-700 border border-purple-300":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[c.jsx(Rt,{className:"inline mr-1"})," Con imagen"]})]})]}),h.useImage?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-4",children:jc.map(_=>c.jsxs("button",{type:"button",onClick:()=>R(_.url),className:`rounded-lg overflow-hidden border-2 transition-all transform hover:scale-[1.02] ${h.backgroundImage===_.url?"border-purple-500 ring-2 ring-purple-300 scale-[1.02]":"border-gray-200 hover:border-purple-300"}`,children:[c.jsx("img",{src:_.url,alt:_.name,className:"w-full h-24 object-cover",loading:"lazy"}),c.jsx("div",{className:"p-2 text-xs text-center bg-white text-gray-700",children:_.name})]},_.url))}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"O sube tu propia imagen:"}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsxs("label",{className:"flex-1 cursor-pointer",children:[c.jsxs("div",{className:"px-4 py-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-purple-400 transition-colors text-center group",children:[c.jsx(Is,{className:"inline mr-2 text-gray-400 group-hover:text-purple-500 text-lg mb-1"}),c.jsx("span",{className:"text-gray-600 group-hover:text-purple-600",children:"Haz clic para subir imagen"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG o WebP (max 5MB)"})]}),c.jsx("input",{ref:r,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:j,className:"hidden"})]}),u&&c.jsx("button",{type:"button",onClick:S,className:"p-3 text-red-500 hover:bg-red-50 rounded-lg transition",title:"Eliminar imagen personalizada",children:c.jsx(Ns,{})})]})]}),g&&c.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Vista previa (se subirá a la nube):"}),c.jsxs("div",{className:"h-32 rounded overflow-hidden border relative",children:[c.jsx("img",{src:g,alt:"Preview personalizada",className:"w-full h-full object-cover"}),c.jsx("div",{className:"absolute bottom-2 right-2 bg-black/70 text-white text-xs px-2 py-1 rounded",children:u==null?void 0:u.name})]}),c.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["📏 Tamaño: ",((u==null?void 0:u.size)/1024/1024).toFixed(2)," MB"]})]}),h.backgroundImage&&!g&&h.backgroundImage!==""&&c.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Imagen seleccionada:"}),c.jsx("div",{className:"h-32 rounded overflow-hidden border",children:c.jsx("img",{src:h.backgroundImage,alt:"Preview seleccionada",className:"w-full h-full object-cover"})}),c.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"🖼️ Imagen predeterminada"})]})]}):c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:c.jsx("p",{className:"text-sm text-gray-600",children:'🎨 Usando solo color de fondo. Para agregar una imagen, selecciona "Con imagen".'})})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-6 border-t",children:[c.jsx("button",{type:"submit",disabled:a,className:"flex-1 px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold rounded-lg shadow-lg hover:from-purple-700 hover:to-pink-700 transition-all flex items-center justify-center gap-2",children:a?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Guardando..."]}):c.jsxs(c.Fragment,{children:[c.jsx(Pa,{}),"Guardar cambios"]})}),c.jsx("button",{type:"button",onClick:$,disabled:l,className:"flex-1 px-6 py-3 bg-gradient-to-r from-red-500 to-pink-600 text-white font-bold rounded-lg shadow-lg hover:from-red-600 hover:to-pink-700 transition-all flex items-center justify-center gap-2",children:l?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Eliminando..."]}):c.jsxs(c.Fragment,{children:[c.jsx(Ts,{}),"Eliminar countdown"]})})]})]})]})}),c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Vista Previa"}),c.jsx("div",{className:"rounded-xl overflow-hidden shadow-lg mb-6 min-h-[400px] flex flex-col justify-center relative",style:{background:h.useImage&&h.backgroundImage?`linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${h.backgroundImage}) center/cover`:h.backgroundColor},children:c.jsxs("div",{className:"p-8 flex-1 flex flex-col justify-center relative z-10",style:{color:h.textColor},children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h3",{className:"text-3xl font-bold mb-4 drop-shadow-lg",children:h.title}),c.jsx("p",{className:"text-xl opacity-90 drop-shadow",children:h.message})]}),c.jsx("div",{className:"flex flex-wrap justify-center gap-4 mb-8",children:Object.entries(p).map(([_,C])=>c.jsxs("div",{className:"text-center bg-black/40 backdrop-blur-sm rounded-lg p-4 min-w-[80px] border border-white/20",children:[c.jsx("div",{className:"text-3xl font-bold",children:C.toString().padStart(2,"0")}),c.jsx("div",{className:"text-sm uppercase opacity-90 mt-1",children:_})]},_))}),c.jsxs("div",{className:"relative mb-4 px-4",children:[c.jsx("div",{className:"h-4 bg-black/40 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-white/60 rounded-full transition-all duration-1000",style:{width:`${y}%`}})}),h.progressIcon&&c.jsx("div",{className:"absolute top-1/2 transform -translate-y-1/2 -translate-x-1/2 transition-all duration-1000",style:{left:`${y}%`},children:c.jsx("div",{className:"w-10 h-10 filter drop-shadow-lg",children:c.jsx(Ge,{iconKey:h.progressIcon,color:h.textColor,size:"2.5em",animate:!0})})})]}),c.jsxs("div",{className:"text-center text-sm opacity-90",children:["Progreso: ",c.jsxs("span",{className:"font-bold text-lg",children:[y.toFixed(1),"%"]})]})]})}),c.jsxs("div",{className:"text-center text-gray-600 space-y-2",children:[c.jsxs("p",{className:"flex items-center justify-center gap-2",children:[c.jsx("span",{className:"text-lg",children:"📱"})," Esta vista se verá en cualquier teléfono"]}),c.jsxs("p",{className:"flex items-center justify-center gap-2",children:[c.jsx("span",{className:"text-lg",children:"🔄"})," El contador se actualiza en tiempo real"]}),h.useImage?c.jsxs("p",{className:"flex items-center justify-center gap-2 text-purple-600 font-medium",children:[c.jsx("span",{className:"text-lg",children:"🖼️"})," ",g?"Con imagen personalizada":"Con imagen predeterminada"]}):c.jsxs("p",{className:"flex items-center justify-center gap-2 text-purple-600 font-medium",children:[c.jsx("span",{className:"text-lg",children:"🎨"})," Usando solo color de fondo"]})]})]}),c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Código QR"}),c.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"bg-white p-4 rounded-lg border-4 border-white shadow-lg",children:c.jsx(Or,{value:E,size:200,level:"H",bgColor:"#FFFFFF",fgColor:"#8B5CF6"})}),c.jsx("div",{className:"absolute -top-2 -right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:"✓"})]}),c.jsxs("div",{className:"w-full max-w-md",children:[c.jsxs("p",{className:"text-sm text-gray-600 mb-2 font-medium flex items-center gap-2",children:[c.jsx(Ss,{})," Enlace del countdown:"]}),c.jsxs("div",{className:"flex items-center bg-gray-50 p-3 rounded-lg border border-gray-200",children:[c.jsx("code",{className:"flex-1 text-sm text-blue-600 break-all font-mono",children:E}),c.jsx("button",{onClick:()=>W(E),className:"ml-2 px-3 py-1.5 text-xs bg-blue-100 text-blue-600 rounded hover:bg-blue-200 transition font-medium",children:"Copiar"})]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 w-full max-w-md",children:[c.jsxs("button",{onClick:()=>{const _=document.createElement("a");_.download=`countdown-${h.title.replace(/\s+/g,"-")}-${Date.now()}.png`;const C=document.querySelector("canvas");C&&(_.href=C.toDataURL(),_.click(),D.success("QR descargado"))},className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all flex items-center justify-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Descargar QR"]}),c.jsxs("button",{onClick:()=>window.open(E,"_blank"),className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white font-semibold rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all flex items-center justify-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Ver Countdown"]})]})]})]})]})]})]})}function Cc(){return c.jsx("nav",{className:"bg-white shadow-lg sticky top-0 z-50",children:c.jsx("div",{className:"container mx-auto px-4 py-3",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs(ue,{to:"/",className:"flex items-center space-x-3 text-xl font-bold text-purple-700 hover:text-purple-800 transition-colors",children:[c.jsx(xr,{className:"text-purple-600"}),c.jsx("span",{children:"Countdown QR"})]}),c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs(ue,{to:"/",className:"flex items-center space-x-2 px-4 py-2 rounded-lg hover:bg-purple-50 transition-colors text-gray-700 hover:text-purple-700",children:[c.jsx(Ia,{}),c.jsx("span",{className:"hidden sm:inline",children:"Inicio"})]}),c.jsxs(ue,{to:"/list",className:"flex items-center space-x-2 px-4 py-2 rounded-lg hover:bg-purple-50 transition-colors text-gray-700 hover:text-purple-700",children:[c.jsx(Ra,{}),c.jsx("span",{className:"hidden sm:inline",children:"Mis Countdowns"})]}),c.jsxs(ue,{to:"/create",className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all shadow-md hover:shadow-lg",children:[c.jsx(Aa,{}),c.jsx("span",{className:"hidden sm:inline",children:"Crear Countdown"}),c.jsx("span",{className:"sm:hidden",children:"Crear"})]})]})]})})})}function Nc(){const e=!kn().pathname.startsWith("/c/");return c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50",children:[e&&c.jsx(Cc,{}),c.jsx("main",{className:e?"container mx-auto px-4 py-8":"",children:c.jsxs(jn,{children:[c.jsx(Xe,{path:"/",element:c.jsx(La,{})}),c.jsx(Xe,{path:"/create",element:c.jsx(hc,{})}),c.jsx(Xe,{path:"/c/:id",element:c.jsx(fc,{})}),c.jsx(Xe,{path:"/list",element:c.jsx(Ec,{})}),"      ",c.jsx(Xe,{path:"/edit/:id",element:c.jsx(Sc,{})}),"   "]})}),c.jsx(va,{position:"top-right"})]})}er.createRoot(document.getElementById("root")).render(c.jsx(L.StrictMode,{children:c.jsx(Sn,{children:c.jsx(Nc,{})})}));
