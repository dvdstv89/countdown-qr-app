import{r as x,a as hs,R as ae,L as ne,u as Nr,b as Cr,c as fs,d as gs,e as Ae}from"./vendor-DZk2g_ua.js";import{b as Wt,Q as Tr}from"./qrcode-CpWzLq_M.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();const ms="modulepreload",ps=function(t){return"/countdown-qr-app/"+t},Kt={},Gt=function(e,r,s){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));n=Promise.allSettled(r.map(c=>{if(c=ps(c),c in Kt)return;Kt[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":ms,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((f,g)=>{h.addEventListener("load",f),h.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return n.then(i=>{for(const l of i||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};var Or={exports:{}},rt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bs=x,vs=Symbol.for("react.element"),ws=Symbol.for("react.fragment"),ys=Object.prototype.hasOwnProperty,xs=bs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_s={key:!0,ref:!0,__self:!0,__source:!0};function Ir(t,e,r){var s,n={},a=null,i=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(i=e.ref);for(s in e)ys.call(e,s)&&!_s.hasOwnProperty(s)&&(n[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)n[s]===void 0&&(n[s]=e[s]);return{$$typeof:vs,type:t,key:a,ref:i,props:n,_owner:xs.current}}rt.Fragment=ws;rt.jsx=Ir;rt.jsxs=Ir;Or.exports=rt;var o=Or.exports,Ye={},Jt=hs;Ye.createRoot=Jt.createRoot,Ye.hydrateRoot=Jt.hydrateRoot;let js={data:""},ks=t=>{if(typeof window=="object"){let e=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(t||document.head).appendChild(e),e.firstChild}return t||js},Es=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Ss=/\/\*[^]*?\*\/|  +/g,Qt=/\n+/g,ce=(t,e)=>{let r="",s="",n="";for(let a in t){let i=t[a];a[0]=="@"?a[1]=="i"?r=a+" "+i+";":s+=a[1]=="f"?ce(i,a):a+"{"+ce(i,a[1]=="k"?"":e)+"}":typeof i=="object"?s+=ce(i,e?e.replace(/([^,])+/g,l=>a.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,l):l?l+" "+c:c)):a):i!=null&&(a=/^--/.test(a)?a:a.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=ce.p?ce.p(a,i):a+":"+i+";")}return r+(e&&n?e+"{"+n+"}":n)+s},re={},Rr=t=>{if(typeof t=="object"){let e="";for(let r in t)e+=r+Rr(t[r]);return e}return t},Ns=(t,e,r,s,n)=>{let a=Rr(t),i=re[a]||(re[a]=(c=>{let u=0,d=11;for(;u<c.length;)d=101*d+c.charCodeAt(u++)>>>0;return"go"+d})(a));if(!re[i]){let c=a!==t?t:(u=>{let d,h,f=[{}];for(;d=Es.exec(u.replace(Ss,""));)d[4]?f.shift():d[3]?(h=d[3].replace(Qt," ").trim(),f.unshift(f[0][h]=f[0][h]||{})):f[0][d[1]]=d[2].replace(Qt," ").trim();return f[0]})(t);re[i]=ce(n?{["@keyframes "+i]:c}:c,r?"":"."+i)}let l=r&&re.g?re.g:null;return r&&(re.g=re[i]),((c,u,d,h)=>{h?u.data=u.data.replace(h,c):u.data.indexOf(c)===-1&&(u.data=d?c+u.data:u.data+c)})(re[i],e,s,l),i},Cs=(t,e,r)=>t.reduce((s,n,a)=>{let i=e[a];if(i&&i.call){let l=i(r),c=l&&l.props&&l.props.className||/^go/.test(l)&&l;i=c?"."+c:l&&typeof l=="object"?l.props?"":ce(l,""):l===!1?"":l}return s+n+(i??"")},"");function st(t){let e=this||{},r=t.call?t(e.p):t;return Ns(r.unshift?r.raw?Cs(r,[].slice.call(arguments,1),e.p):r.reduce((s,n)=>Object.assign(s,n&&n.call?n(e.p):n),{}):r,ks(e.target),e.g,e.o,e.k)}let Ar,Et,St;st.bind({g:1});let ie=st.bind({k:1});function Ts(t,e,r,s){ce.p=e,Ar=t,Et=r,St=s}function he(t,e){let r=this||{};return function(){let s=arguments;function n(a,i){let l=Object.assign({},a),c=l.className||n.className;r.p=Object.assign({theme:Et&&Et()},l),r.o=/ *go\d+/.test(c),l.className=st.apply(r,s)+(c?" "+c:"");let u=t;return t[0]&&(u=l.as||t,delete l.as),St&&u[0]&&St(l),Ar(u,l)}return n}}var Os=t=>typeof t=="function",Ze=(t,e)=>Os(t)?t(e):t,Is=(()=>{let t=0;return()=>(++t).toString()})(),$r=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),Rs=20,Lt="default",Pr=(t,e)=>{let{toastLimit:r}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,r)};case 1:return{...t,toasts:t.toasts.map(i=>i.id===e.toast.id?{...i,...e.toast}:i)};case 2:let{toast:s}=e;return Pr(t,{type:t.toasts.find(i=>i.id===s.id)?1:0,toast:s});case 3:let{toastId:n}=e;return{...t,toasts:t.toasts.map(i=>i.id===n||n===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(i=>i.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let a=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+a}))}}},Qe=[],Dr={toasts:[],pausedAt:void 0,settings:{toastLimit:Rs}},ee={},Ur=(t,e=Lt)=>{ee[e]=Pr(ee[e]||Dr,t),Qe.forEach(([r,s])=>{r===e&&s(ee[e])})},Lr=t=>Object.keys(ee).forEach(e=>Ur(t,e)),As=t=>Object.keys(ee).find(e=>ee[e].toasts.some(r=>r.id===t)),nt=(t=Lt)=>e=>{Ur(e,t)},$s={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Ps=(t={},e=Lt)=>{let[r,s]=x.useState(ee[e]||Dr),n=x.useRef(ee[e]);x.useEffect(()=>(n.current!==ee[e]&&s(ee[e]),Qe.push([e,s]),()=>{let i=Qe.findIndex(([l])=>l===e);i>-1&&Qe.splice(i,1)}),[e]);let a=r.toasts.map(i=>{var l,c,u;return{...t,...t[i.type],...i,removeDelay:i.removeDelay||((l=t[i.type])==null?void 0:l.removeDelay)||(t==null?void 0:t.removeDelay),duration:i.duration||((c=t[i.type])==null?void 0:c.duration)||(t==null?void 0:t.duration)||$s[i.type],style:{...t.style,...(u=t[i.type])==null?void 0:u.style,...i.style}}});return{...r,toasts:a}},Ds=(t,e="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...r,id:(r==null?void 0:r.id)||Is()}),qe=t=>(e,r)=>{let s=Ds(e,t,r);return nt(s.toasterId||As(s.id))({type:2,toast:s}),s.id},F=(t,e)=>qe("blank")(t,e);F.error=qe("error");F.success=qe("success");F.loading=qe("loading");F.custom=qe("custom");F.dismiss=(t,e)=>{let r={type:3,toastId:t};e?nt(e)(r):Lr(r)};F.dismissAll=t=>F.dismiss(void 0,t);F.remove=(t,e)=>{let r={type:4,toastId:t};e?nt(e)(r):Lr(r)};F.removeAll=t=>F.remove(void 0,t);F.promise=(t,e,r)=>{let s=F.loading(e.loading,{...r,...r==null?void 0:r.loading});return typeof t=="function"&&(t=t()),t.then(n=>{let a=e.success?Ze(e.success,n):void 0;return a?F.success(a,{id:s,...r,...r==null?void 0:r.success}):F.dismiss(s),n}).catch(n=>{let a=e.error?Ze(e.error,n):void 0;a?F.error(a,{id:s,...r,...r==null?void 0:r.error}):F.dismiss(s)}),t};var Us=1e3,Ls=(t,e="default")=>{let{toasts:r,pausedAt:s}=Ps(t,e),n=x.useRef(new Map).current,a=x.useCallback((h,f=Us)=>{if(n.has(h))return;let g=setTimeout(()=>{n.delete(h),i({type:4,toastId:h})},f);n.set(h,g)},[]);x.useEffect(()=>{if(s)return;let h=Date.now(),f=r.map(g=>{if(g.duration===1/0)return;let p=(g.duration||0)+g.pauseDuration-(h-g.createdAt);if(p<0){g.visible&&F.dismiss(g.id);return}return setTimeout(()=>F.dismiss(g.id,e),p)});return()=>{f.forEach(g=>g&&clearTimeout(g))}},[r,s,e]);let i=x.useCallback(nt(e),[e]),l=x.useCallback(()=>{i({type:5,time:Date.now()})},[i]),c=x.useCallback((h,f)=>{i({type:1,toast:{id:h,height:f}})},[i]),u=x.useCallback(()=>{s&&i({type:6,time:Date.now()})},[s,i]),d=x.useCallback((h,f)=>{let{reverseOrder:g=!1,gutter:p=8,defaultPosition:m}=f||{},b=r.filter(v=>(v.position||m)===(h.position||m)&&v.height),y=b.findIndex(v=>v.id===h.id),_=b.filter((v,k)=>k<y&&v.visible).length;return b.filter(v=>v.visible).slice(...g?[_+1]:[0,_]).reduce((v,k)=>v+(k.height||0)+p,0)},[r]);return x.useEffect(()=>{r.forEach(h=>{if(h.dismissed)a(h.id,h.removeDelay);else{let f=n.get(h.id);f&&(clearTimeout(f),n.delete(h.id))}})},[r,a]),{toasts:r,handlers:{updateHeight:c,startPause:l,endPause:u,calculateOffset:d}}},Bs=ie`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Fs=ie`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,zs=ie`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Ms=he("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Bs} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Fs} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${zs} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,qs=ie`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Hs=he("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${qs} 1s linear infinite;
`,Vs=ie`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Ws=ie`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Ks=he("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Vs} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Ws} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Gs=he("div")`
  position: absolute;
`,Js=he("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Qs=ie`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Ys=he("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Qs} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Zs=({toast:t})=>{let{icon:e,type:r,iconTheme:s}=t;return e!==void 0?typeof e=="string"?x.createElement(Ys,null,e):e:r==="blank"?null:x.createElement(Js,null,x.createElement(Hs,{...s}),r!=="loading"&&x.createElement(Gs,null,r==="error"?x.createElement(Ms,{...s}):x.createElement(Ks,{...s})))},Xs=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,en=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,tn="0%{opacity:0;} 100%{opacity:1;}",rn="0%{opacity:1;} 100%{opacity:0;}",sn=he("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,nn=he("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,an=(t,e)=>{let r=t.includes("top")?1:-1,[s,n]=$r()?[tn,rn]:[Xs(r),en(r)];return{animation:e?`${ie(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ie(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},on=x.memo(({toast:t,position:e,style:r,children:s})=>{let n=t.height?an(t.position||e||"top-center",t.visible):{opacity:0},a=x.createElement(Zs,{toast:t}),i=x.createElement(nn,{...t.ariaProps},Ze(t.message,t));return x.createElement(sn,{className:t.className,style:{...n,...r,...t.style}},typeof s=="function"?s({icon:a,message:i}):x.createElement(x.Fragment,null,a,i))});Ts(x.createElement);var ln=({id:t,className:e,style:r,onHeightUpdate:s,children:n})=>{let a=x.useCallback(i=>{if(i){let l=()=>{let c=i.getBoundingClientRect().height;s(t,c)};l(),new MutationObserver(l).observe(i,{subtree:!0,childList:!0,characterData:!0})}},[t,s]);return x.createElement("div",{ref:a,className:e,style:r},n)},cn=(t,e)=>{let r=t.includes("top"),s=r?{top:0}:{bottom:0},n=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:$r()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(r?1:-1)}px)`,...s,...n}},un=st`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ve=16,dn=({reverseOrder:t,position:e="top-center",toastOptions:r,gutter:s,children:n,toasterId:a,containerStyle:i,containerClassName:l})=>{let{toasts:c,handlers:u}=Ls(r,a);return x.createElement("div",{"data-rht-toaster":a||"",style:{position:"fixed",zIndex:9999,top:Ve,left:Ve,right:Ve,bottom:Ve,pointerEvents:"none",...i},className:l,onMouseEnter:u.startPause,onMouseLeave:u.endPause},c.map(d=>{let h=d.position||e,f=u.calculateOffset(d,{reverseOrder:t,gutter:s,defaultPosition:e}),g=cn(h,f);return x.createElement(ln,{id:d.id,key:d.id,onHeightUpdate:u.updateHeight,className:d.visible?un:"",style:g},d.type==="custom"?Ze(d.message,d):n?n(d):x.createElement(on,{toast:d,position:h}))}))},O=F,Br={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Yt=ae.createContext&&ae.createContext(Br),de=function(){return de=Object.assign||function(t){for(var e,r=1,s=arguments.length;r<s;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},de.apply(this,arguments)},hn=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};function Fr(t){return t&&t.map(function(e,r){return ae.createElement(e.tag,de({key:r},e.attr),Fr(e.child))})}function I(t){return function(e){return ae.createElement(fn,de({attr:de({},t.attr)},e),Fr(t.child))}}function fn(t){var e=function(r){var s=t.attr,n=t.size,a=t.title,i=hn(t,["attr","size","title"]),l=n||r.size||"1em",c;return r.className&&(c=r.className),t.className&&(c=(c?c+" ":"")+t.className),ae.createElement("svg",de({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,s,i,{className:c,style:de(de({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),a&&ae.createElement("title",null,a),t.children)};return Yt!==void 0?ae.createElement(Yt.Consumer,null,function(r){return e(r)}):e(Br)}function gn(t){return I({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"}}]})(t)}function mn(t){return I({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 384c-28.02 0-31.26-32-74.5-32-43.43 0-46.825 32-74.75 32-27.695 0-31.454-32-74.75-32-42.842 0-47.218 32-74.5 32-28.148 0-31.202-32-74.75-32-43.547 0-46.653 32-74.75 32v-80c0-26.5 21.5-48 48-48h16V112h64v144h64V112h64v144h64V112h64v144h16c26.5 0 48 21.5 48 48v80zm0 128H0v-96c43.356 0 46.767-32 74.75-32 27.951 0 31.253 32 74.75 32 42.843 0 47.217-32 74.5-32 28.148 0 31.201 32 74.75 32 43.357 0 46.767-32 74.75-32 27.488 0 31.252 32 74.5 32v96zM96 96c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40zm128 0c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40zm128 0c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40z"}}]})(t)}function pn(t){return I({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"}}]})(t)}function bn(t){return I({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"}}]})(t)}function Zt(t){return I({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"}}]})(t)}function vn(t){return I({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"}}]})(t)}function Xt(t){return I({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M432,320H400a16,16,0,0,0-16,16V448H64V128H208a16,16,0,0,0,16-16V80a16,16,0,0,0-16-16H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V336A16,16,0,0,0,432,320ZM488,0h-128c-21.37,0-32.05,25.91-17,41l35.73,35.73L135,320.37a24,24,0,0,0,0,34L157.67,377a24,24,0,0,0,34,0L435.28,133.32,471,169c15,15,41,4.5,41-17V24A24,24,0,0,0,488,0Z"}}]})(t)}function wn(t){return I({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M32 448c0 17.7 14.3 32 32 32h160V320H32v128zm256 32h160c17.7 0 32-14.3 32-32V320H288v160zm192-320h-42.1c6.2-12.1 10.1-25.5 10.1-40 0-48.5-39.5-88-88-88-41.6 0-68.5 21.3-103 68.3-34.5-47-61.4-68.3-103-68.3-48.5 0-88 39.5-88 88 0 14.5 3.8 27.9 10.1 40H32c-17.7 0-32 14.3-32 32v80c0 8.8 7.2 16 16 16h480c8.8 0 16-7.2 16-16v-80c0-17.7-14.3-32-32-32zm-326.1 0c-22.1 0-40-17.9-40-40s17.9-40 40-40c19.9 0 34.6 3.3 86.1 80h-86.1zm206.1 0h-86.1c51.4-76.5 65.7-80 86.1-80 22.1 0 40 17.9 40 40s-17.9 40-40 40z"}}]})(t)}function yn(t){return I({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"}}]})(t)}function xn(t){return I({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"}}]})(t)}function Bt(t){return I({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M360 0H24C10.745 0 0 10.745 0 24v16c0 13.255 10.745 24 24 24 0 90.965 51.016 167.734 120.842 192C75.016 280.266 24 357.035 24 448c-13.255 0-24 10.745-24 24v16c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24v-16c0-13.255-10.745-24-24-24 0-90.965-51.016-167.734-120.842-192C308.984 231.734 360 154.965 360 64c13.255 0 24-10.745 24-24V24c0-13.255-10.745-24-24-24zm-75.078 384H99.08c17.059-46.797 52.096-80 92.92-80 40.821 0 75.862 33.196 92.922 80zm.019-256H99.078C91.988 108.548 88 86.748 88 64h208c0 22.805-3.987 44.587-11.059 64z"}}]})(t)}function at(t){return I({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"}}]})(t)}function zr(t){return I({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"}}]})(t)}function _n(t){return I({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M80 368H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm0-320H16A16 16 0 0 0 0 64v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16V64a16 16 0 0 0-16-16zm0 160H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm416 176H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"}}]})(t)}function Ft(t){return I({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"}}]})(t)}function jn(t){return I({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"}}]})(t)}function Mr(t){return I({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 224h192V32H0v192zM64 96h64v64H64V96zm192-64v192h192V32H256zm128 128h-64V96h64v64zM0 480h192V288H0v192zm64-128h64v64H64v-64zm352-64h32v128h-96v-32h-32v96h-64V288h96v32h64v-32zm0 160h32v32h-32v-32zm-64 0h32v32h-32v-32z"}}]})(t)}function kn(t){return I({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505.12019,19.09375c-1.18945-5.53125-6.65819-11-12.207-12.1875C460.716,0,435.507,0,410.40747,0,307.17523,0,245.26909,55.20312,199.05238,128H94.83772c-16.34763.01562-35.55658,11.875-42.88664,26.48438L2.51562,253.29688A28.4,28.4,0,0,0,0,264a24.00867,24.00867,0,0,0,24.00582,24H127.81618l-22.47457,22.46875c-11.36521,11.36133-12.99607,32.25781,0,45.25L156.24582,406.625c11.15623,11.1875,32.15619,13.15625,45.27726,0l22.47457-22.46875V488a24.00867,24.00867,0,0,0,24.00581,24,28.55934,28.55934,0,0,0,10.707-2.51562l98.72834-49.39063c14.62888-7.29687,26.50776-26.5,26.50776-42.85937V312.79688c72.59753-46.3125,128.03493-108.40626,128.03493-211.09376C512.07526,76.5,512.07526,51.29688,505.12019,19.09375ZM384.04033,168A40,40,0,1,1,424.05,128,40.02322,40.02322,0,0,1,384.04033,168Z"}}]})(t)}function En(t){return I({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}}]})(t)}function Sn(t){return I({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M352 320c-22.608 0-43.387 7.819-59.79 20.895l-102.486-64.054a96.551 96.551 0 0 0 0-41.683l102.486-64.054C308.613 184.181 329.392 192 352 192c53.019 0 96-42.981 96-96S405.019 0 352 0s-96 42.981-96 96c0 7.158.79 14.13 2.276 20.841L155.79 180.895C139.387 167.819 118.608 160 96 160c-53.019 0-96 42.981-96 96s42.981 96 96 96c22.608 0 43.387-7.819 59.79-20.895l102.486 64.054A96.301 96.301 0 0 0 256 416c0 53.019 42.981 96 96 96s96-42.981 96-96-42.981-96-96-96z"}}]})(t)}function Nn(t){return I({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M510.9 152.3l-5.9-14.5c-3.3-8-12.6-11.9-20.8-8.7L456 140.6v-29c0-8.6-7.2-15.6-16-15.6h-16c-8.8 0-16 7-16 15.6v46.9c0 .5.3 1 .3 1.5l-56.4 23c-5.9-10-13.3-18.9-22-26.6 13.6-16.6 22-37.4 22-60.5 0-53-43-96-96-96s-96 43-96 96c0 23.1 8.5 43.9 22 60.5-8.7 7.7-16 16.6-22 26.6l-56.4-23c.1-.5.3-1 .3-1.5v-46.9C104 103 96.8 96 88 96H72c-8.8 0-16 7-16 15.6v29l-28.1-11.5c-8.2-3.2-17.5.7-20.8 8.7l-5.9 14.5c-3.3 8 .7 17.1 8.9 20.3l135.2 55.2c-.4 4-1.2 8-1.2 12.2 0 10.1 1.7 19.6 4.2 28.9C120.9 296.4 104 334.2 104 376c0 54 28.4 100.9 70.8 127.8 9.3 5.9 20.3 8.2 31.3 8.2h99.2c13.3 0 26.3-4.1 37.2-11.7 46.5-32.3 74.4-89.4 62.9-152.6-5.5-30.2-20.5-57.6-41.6-79 2.5-9.2 4.2-18.7 4.2-28.7 0-4.2-.8-8.1-1.2-12.2L502 172.6c8.1-3.1 12.1-12.2 8.9-20.3zM224 96c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm32 272c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm0-64c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm0-64c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm0-88s-16-23.2-16-32 7.2-16 16-16 16 7.2 16 16-16 32-16 32zm32-56c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"}}]})(t)}function qr(t){return I({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"}}]})(t)}function Hr(t){return I({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"}}]})(t)}function Vr(t){return I({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M296 384h-80c-13.3 0-24-10.7-24-24V192h-87.7c-17.8 0-26.7-21.5-14.1-34.1L242.3 5.7c7.5-7.5 19.8-7.5 27.3 0l152.2 152.2c12.6 12.6 3.7 34.1-14.1 34.1H320v168c0 13.3-10.7 24-24 24zm216-8v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h136v8c0 30.9 25.1 56 56 56h80c30.9 0 56-25.1 56-56v-8h136c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"}}]})(t)}function Cn(){return o.jsx("div",{className:"text-center",children:o.jsxs("div",{className:"max-w-4xl mx-auto",children:[o.jsxs("h1",{className:"text-5xl md:text-6xl font-bold text-gray-900 mb-6",children:["Crea Countdowns Personalizados",o.jsx("span",{className:"block text-purple-600",children:"con Códigos QR"})]}),o.jsx("p",{className:"text-xl text-gray-600 mb-10",children:"Genera cuenta regresivas únicas para cumpleaños, eventos especiales, Navidad... ¡Todo con un QR que puedes imprimir o compartir!"}),o.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mb-12",children:[o.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-lg",children:[o.jsx("div",{className:"text-purple-600 mb-4",children:o.jsx(Mr,{className:"text-5xl mx-auto"})}),o.jsx("h3",{className:"text-2xl font-bold mb-3",children:"QR Generado Automáticamente"}),o.jsx("p",{className:"text-gray-600",children:"Cada countdown tiene su propio código QR único para compartir fácilmente."})]}),o.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-lg",children:[o.jsx("div",{className:"text-purple-600 mb-4",children:o.jsx(at,{className:"text-5xl mx-auto"})}),o.jsx("h3",{className:"text-2xl font-bold mb-3",children:"Personalización Completa"}),o.jsx("p",{className:"text-gray-600",children:"Elige colores, imágenes de fondo y iconos animados para la barra de progreso."})]})]}),o.jsx(ne,{to:"/create",className:"inline-block px-8 py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white text-xl font-bold rounded-full hover:from-purple-700 hover:to-pink-700 transform hover:-translate-y-1 transition-all duration-300 shadow-xl",children:"Comenzar a Crear →"}),o.jsxs("div",{className:"mt-16",children:[o.jsx("h2",{className:"text-3xl font-bold mb-8",children:"¿Cómo funciona?"}),o.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"bg-white p-6 rounded-xl shadow",children:[o.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:"1"}),o.jsx("h4",{className:"font-bold mb-2",children:"Configura tu evento"}),o.jsx("p",{className:"text-gray-600",children:"Elige fecha, mensaje, colores e icono."})]}),o.jsxs("div",{className:"bg-white p-6 rounded-xl shadow",children:[o.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:"2"}),o.jsx("h4",{className:"font-bold mb-2",children:"Genera el QR"}),o.jsx("p",{className:"text-gray-600",children:"Obtén automáticamente un código QR único."})]}),o.jsxs("div",{className:"bg-white p-6 rounded-xl shadow",children:[o.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:"3"}),o.jsx("h4",{className:"font-bold mb-2",children:"Comparte"}),o.jsx("p",{className:"text-gray-600",children:"Envía el QR o enlace a quien quieras."})]})]})]})]})})}function Tn(t){return I({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M2 22l14-5-9-9zM14.53 12.53l5.59-5.59a1.25 1.25 0 011.77 0l.59.59 1.06-1.06-.59-.59a2.758 2.758 0 00-3.89 0l-5.59 5.59 1.06 1.06zM10.06 6.88l-.59.59 1.06 1.06.59-.59a2.758 2.758 0 000-3.89l-.59-.59-1.06 1.07.59.59c.48.48.48 1.28 0 1.76zM17.06 11.88l-1.59 1.59 1.06 1.06 1.59-1.59a1.25 1.25 0 011.77 0l1.61 1.61 1.06-1.06-1.61-1.61a2.758 2.758 0 00-3.89 0zM15.06 5.88l-3.59 3.59 1.06 1.06 3.59-3.59a2.758 2.758 0 000-3.89l-1.59-1.59-1.06 1.06 1.59 1.59c.48.49.48 1.29 0 1.77z"}}]})(t)}function On(t){return I({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M122.7 23.32l1.7 21.87-16.7 14.25 21.4 5.17 8.4 20.25L149 66.18l21.8-1.75-14.2-16.71 5.1-21.32-20.3 8.35-18.7-11.43zM464 32a16 16 0 0 0-16 16 16 16 0 0 0 16 16 16 16 0 0 0 16-16 16 16 0 0 0-16-16zM239.8 42.5a16 16 0 0 0-16 16 16 16 0 0 0 16 16 16 16 0 0 0 16-16 16 16 0 0 0-16-16zm183.9 6.84c-9.2 1.74-17.7 7.18-25.9 14.28-7.6 6.53-14.7 14.66-20.7 23.45-18.8 3.01-37.6 10.67-50.2 21.13-16.1 13.2-30.4 35.8-38.2 59.1-7.4 3.1-14.4 6.8-20.1 10.8-15.5 10.9-23.5 31.8-29.4 50-5.9 18.3-8.8 34.3-8.8 34.3l17.8 3.2s2.7-15 8.1-31.9c5.5-16.9 14.8-35.3 22.7-40.8 1.3-.9 3-1.9 4.5-2.8-.6 5.7-.6 11.4.3 16.8 1.8 11.4 8 22.3 19 28.2 7.8 4.2 16.6 3.2 24 .2 7.4-3.1 14-8.2 19.7-14.2 5.7-6 10.4-13.1 13.2-20.6 2.8-7.5 3.8-16 .2-23.9h-.1c-3.9-8.4-11.4-13.8-19.4-16.1-8-2.3-16.6-2.2-25.2-.9-1.5.2-2.9.7-4.4 1 7.4-15.8 18-30.7 27.5-38.6 6.2-5.1 16.6-10 27.7-13.6-1.4 3.8-2.5 7.6-3 11.5-1.6 10.5.7 21.9 9.1 29.7 6.1 5.6 14.3 6.5 21.5 5.3 7.1-1.2 14-4.4 20.2-8.5 6.2-4.2 11.7-9.4 15.6-15.5 3.9-6.1 6.5-13.9 4-21.7v-.1c-3.3-10.07-11.5-16.99-20.6-20.27-3.9-1.4-8-2.19-12.2-2.66 2.9-3.26 5.9-6.31 8.9-8.92 6.8-5.84 13.7-9.5 17.6-10.23l-3.4-17.68zM174.8 84.39l-15.2 9.56 34.5 55.25-56.4 2.9 26.5 57.8 16.4-7.6-15.5-33.6 60.6-3.1-50.9-81.21zm216.4 19.31c6.1-.1 11.5.6 15.5 2.1 5.4 1.9 8.1 4.3 9.5 8.8.4 1.1.2 3.3-1.9 6.6-2.2 3.4-6.1 7.2-10.5 10.2-4.5 3-9.5 5.1-13.2 5.7-3.8.7-5.5 0-6.3-.7-3.5-3.2-4.5-7.2-3.5-13.9.8-5.4 3.3-11.9 7-18.6 1.2 0 2.3-.2 3.4-.2zM94.99 123a16 16 0 0 0-16 16 16 16 0 0 0 16 16A16 16 0 0 0 111 139a16 16 0 0 0-16.01-16zm356.11 37.2l-14.4 16.6-21.8-1.8 11.4 18.8-8.5 20.2 21.4-5 16.6 14.3 1.9-21.9 18.7-11.4-20.2-8.5-5.1-21.3zm-123.5 16.5c2.9.1 5.6.5 7.7 1.1 4.3 1.2 6.6 3 8.2 6.4.9 1.9 1 5.4-.7 10-1.7 4.7-5.2 10.1-9.4 14.6s-9.3 8.1-13.5 9.8c-4.2 1.7-6.8 1.6-8.5.7h-.1c-5.8-3.2-8.6-7.8-9.7-15.2-1-6.3-.3-14.3 1.8-22.9 4.9-1.7 9.8-3.1 14.5-3.8 3.5-.5 6.7-.7 9.7-.7zm-202.4 51.9c-7.2-.2-11.7 1.5-14.5 4.3-2.8 2.8-4.5 7.3-4.3 14.5.2 7.3 2.6 16.9 7.2 27.6 9.2 21.5 27.3 47.4 51.6 71.8 24.3 24.3 50.3 42.3 71.8 51.5 10.6 4.6 20.2 7 27.5 7.2 7.3.3 11.7-1.5 14.5-4.3 2.8-2.8 4.6-7.2 4.3-14.5-.2-7.3-2.6-16.9-7.2-27.6-9.2-21.4-27.2-47.4-51.5-71.7-24.3-24.4-50.3-42.4-71.8-51.6-10.7-4.6-20.3-7-27.6-7.2zm232 31.3l-33 54-29.1-27.9-12.4 13 45.1 43.3 33.8-55.2 38.7 32.3 89.3-38.2-7-16.6-79.3 34-46.1-38.7zM93.43 272.6l-17.64 57.9c41.41 49.1 89.71 76.7 142.11 94.7l21.6-6.6c-3.1-1.1-6.4-2.4-9.7-3.8-24.4-10.4-51.7-29.6-77.3-55.3-25.7-25.7-44.9-53-55.34-77.4-1.41-3.2-2.65-6.4-3.73-9.5zm-23.82 78.2l-14.01 46c28.89 27 59 39.2 90.6 50.2l43.4-13.2c-43.2-17.6-84-43.3-119.99-83zM368 352a16 16 0 0 0-16 16 16 16 0 0 0 16 16 16 16 0 0 0 16-16 16 16 0 0 0-16-16zM49.81 415.9l-20.29 66.6 88.28-26.9c-22.77-9.1-45.78-20.7-67.99-39.7z"}}]})(t)}function In(t){return I({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M23 7a8.44 8.44 0 0 0-5 1.31c-.36-.41-.73-.82-1.12-1.21l-.29-.27.14-.12a3.15 3.15 0 0 0 .9-3.49A3.9 3.9 0 0 0 14 1v2a2 2 0 0 1 1.76 1c.17.4 0 .84-.47 1.31l-.23.21a16.71 16.71 0 0 0-3.41-2.2c-2.53-1.14-3.83-.61-4.47 0a2.18 2.18 0 0 0-.46.68l-.18.53L5.1 8.87C6.24 11.71 9 16.76 15 18.94l5-1.66a1 1 0 0 0 .43-.31l.21-.18c1.43-1.44.51-4.21-1.41-6.9A6.63 6.63 0 0 1 23 9zm-3.79 8.37h-.06c-.69.37-3.55-.57-6.79-3.81-.34-.34-.66-.67-.95-1-.1-.11-.19-.23-.29-.35l-.53-.64-.28-.39c-.14-.19-.28-.38-.4-.56s-.16-.26-.24-.39-.22-.34-.31-.51-.13-.24-.19-.37-.17-.28-.23-.42-.09-.23-.14-.34-.11-.27-.15-.4S8.6 6 8.58 5.9s-.06-.24-.08-.34a2 2 0 0 1 0-.24 1.15 1.15 0 0 1 0-.26l.11-.31c.17-.18.91-.23 2.23.37a13.83 13.83 0 0 1 2.49 1.54A4.17 4.17 0 0 1 12 7v2a6.43 6.43 0 0 0 3-.94l.49.46c.44.43.83.86 1.19 1.27A5.31 5.31 0 0 0 16 13.2l2-.39a3.23 3.23 0 0 1 0-1.14c1.29 1.97 1.53 3.39 1.21 3.7zM4.4 11l-2.23 6.7A3.28 3.28 0 0 0 5.28 22a3.21 3.21 0 0 0 1-.17l6.52-2.17A18.7 18.7 0 0 1 4.4 11z"}}]})(t)}const Rn={FaBirthdayCake:mn,GiPartyPopper:On,FaGift:wn,FaHourglassHalf:Bt,FaHeart:yn,FaRocket:kn,MdCelebration:Tn,FaSnowman:Nn,BiSolidParty:In},Re=({iconKey:t="FaHourglassHalf",color:e="currentColor",size:r="1.5em",className:s="",animate:n=!1})=>{const a=Rn[t]||Bt;return o.jsx("div",{className:`inline-flex items-center justify-center ${n?"animate-float":""} ${s}`,children:o.jsx(a,{style:{color:e,fontSize:r}})})},Wr=()=>[{name:"Pastel",key:"FaBirthdayCake",type:"birthday"},{name:"Fiesta",key:"GiPartyPopper",type:"party"},{name:"Regalo",key:"FaGift",type:"gift"},{name:"Reloj",key:"FaHourglassHalf",type:"hourglass"},{name:"Corazón",key:"FaHeart",type:"love"},{name:"Cohete",key:"FaRocket",type:"rocket"},{name:"Celebración",key:"MdCelebration",type:"celebration"},{name:"Navidad",key:"FaSnowman",type:"christmas"},{name:"Evento",key:"BiSolidParty",type:"event"}];function it(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r}function An(t,e,r,s){function n(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function l(d){try{u(s.next(d))}catch(h){i(h)}}function c(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(l,c)}u((s=s.apply(t,e||[])).next())})}const $n=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class zt extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class Pn extends zt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class er extends zt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class tr extends zt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Nt;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Nt||(Nt={}));class Dn{constructor(e,{headers:r={},customFetch:s,region:n=Nt.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=$n(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return An(this,arguments,void 0,function*(r,s={}){var n;let a,i;try{const{headers:l,method:c,body:u,signal:d,timeout:h}=s;let f={},{region:g}=s;g||(g=this.region);const p=new URL(`${this.url}/${r}`);g&&g!=="any"&&(f["x-region"]=g,p.searchParams.set("forceFunctionRegion",g));let m;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",m=u):typeof u=="string"?(f["Content-Type"]="text/plain",m=u):typeof FormData<"u"&&u instanceof FormData?m=u:(f["Content-Type"]="application/json",m=JSON.stringify(u)):m=u;let b=d;h&&(i=new AbortController,a=setTimeout(()=>i.abort(),h),d?(b=i.signal,d.addEventListener("abort",()=>i.abort())):b=i.signal);const y=yield this.fetch(p.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:m,signal:b}).catch($=>{throw new Pn($)}),_=y.headers.get("x-relay-error");if(_&&_==="true")throw new er(y);if(!y.ok)throw new tr(y);let v=((n=y.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),k;return v==="application/json"?k=yield y.json():v==="application/octet-stream"||v==="application/pdf"?k=yield y.blob():v==="text/event-stream"?k=y:v==="multipart/form-data"?k=yield y.formData():k=yield y.text(),{data:k,error:null,response:y}}catch(l){return{data:null,error:l,response:l instanceof tr||l instanceof er?l.context:void 0}}finally{a&&clearTimeout(a)}})}}var Un=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},Ln=class{constructor(t){var e,r;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(r=t.isMaybeSingle)!==null&&r!==void 0?r:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{let i=null,l=null,c=null,u=a.status,d=a.statusText;if(a.ok){var h,f;if(r.method!=="HEAD"){var g;const y=await a.text();y===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((g=r.headers.get("Accept"))===null||g===void 0)&&g.includes("application/vnd.pgrst.plan+text"))?l=y:l=JSON.parse(y))}const m=(h=r.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),b=(f=a.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");m&&b&&b.length>1&&(c=parseInt(b[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(l)&&(l.length>1?(i={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,c=null,u=406,d="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var p;const m=await a.text();try{i=JSON.parse(m),Array.isArray(i)&&a.status===404&&(l=[],i=null,u=200,d="OK")}catch{a.status===404&&m===""?(u=204,d="No Content"):i={message:m}}if(i&&r.isMaybeSingle&&(!(i==null||(p=i.details)===null||p===void 0)&&p.includes("0 rows"))&&(i=null,u=200,d="OK"),i&&r.shouldThrowOnError)throw new Un(i)}return{error:i,data:l,count:c,status:u,statusText:d}});return this.shouldThrowOnError||(n=n.catch(a=>{var i;let l="";const c=a==null?void 0:a.cause;if(c){var u,d,h,f;const p=(u=c==null?void 0:c.message)!==null&&u!==void 0?u:"",m=(d=c==null?void 0:c.code)!==null&&d!==void 0?d:"";l=`${(h=a==null?void 0:a.name)!==null&&h!==void 0?h:"FetchError"}: ${a==null?void 0:a.message}`,l+=`

Caused by: ${(f=c==null?void 0:c.name)!==null&&f!==void 0?f:"Error"}: ${p}`,m&&(l+=` (${m})`),c!=null&&c.stack&&(l+=`
${c.stack}`)}else{var g;l=(g=a==null?void 0:a.stack)!==null&&g!==void 0?g:""}return{error:{message:`${(i=a==null?void 0:a.name)!==null&&i!==void 0?i:"FetchError"}: ${a==null?void 0:a.message}`,details:l,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),n.then(t,e)}returns(){return this}overrideTypes(){return this}},Bn=class extends Ln{select(t){let e=!1;const r=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:s,referencedTable:n=s}={}){const a=n?`${n}.order`:"order",i=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${i?`${i},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:r=e}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:r,referencedTable:s=r}={}){const n=typeof s>"u"?"offset":`${s}.offset`,a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${t}`),this.url.searchParams.set(a,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:s=!1,wal:n=!1,format:a="text"}={}){var i;const l=[t?"analyze":null,e?"verbose":null,r?"settings":null,s?"buffers":null,n?"wal":null].filter(Boolean).join("|"),c=(i=this.headers.get("Accept"))!==null&&i!==void 0?i:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const rr=new RegExp("[,()]");var Ne=class extends Bn{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const r=Array.from(new Set(e)).map(s=>typeof s=="string"&&rr.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}notIn(t,e){const r=Array.from(new Set(e)).map(s=>typeof s=="string"&&rr.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`not.in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:s}={}){let n="";s==="plain"?n="pl":s==="phrase"?n="ph":s==="websearch"&&(n="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${n}fts${a}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e,referencedTable:r=e}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}},Fn=class{constructor(t,{headers:e={},schema:r,fetch:s}){this.url=t,this.headers=new Headers(e),this.schema=r,this.fetch=s}select(t,e){const{head:r=!1,count:s}=e??{},n=r?"HEAD":"GET";let a=!1;const i=(t??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",i),s&&this.headers.append("Prefer",`count=${s}`),new Ne({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:r=!0}={}){var s;const n="POST";if(e&&this.headers.append("Prefer",`count=${e}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const a=t.reduce((i,l)=>i.concat(Object.keys(l)),[]);if(a.length>0){const i=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",i.join(","))}}return new Ne({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:s,defaultToNull:n=!0}={}){var a;const i="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),s&&this.headers.append("Prefer",`count=${s}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Ne({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(t,{count:e}={}){var r;const s="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new Ne({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:t}={}){var e;const r="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Ne({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},zn=class Kr{constructor(e,{headers:r={},schema:s,fetch:n}={}){this.url=e,this.headers=new Headers(r),this.schemaName=s,this.fetch=n}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new Fn(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Kr(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:s=!1,get:n=!1,count:a}={}){var i;let l;const c=new URL(`${this.url}/rpc/${e}`);let u;s||n?(l=s?"HEAD":"GET",Object.entries(r).filter(([h,f])=>f!==void 0).map(([h,f])=>[h,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([h,f])=>{c.searchParams.append(h,f)})):(l="POST",u=r);const d=new Headers(this.headers);return a&&d.set("Prefer",`count=${a}`),new Ne({method:l,url:c,headers:d,schema:this.schemaName,body:u,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};class Mn{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,n=parseInt(s.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const s=this.getWebSocketConstructor();return new s(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const qn="2.89.0",Hn=`realtime-js/${qn}`,Gr="1.0.0",Vn="2.0.0",sr=Gr,Ct=1e4,Wn=1e3,Kn=100;var le;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(le||(le={}));var B;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(B||(B={}));var Z;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Z||(Z={}));var Tt;(function(t){t.websocket="websocket"})(Tt||(Tt={}));var pe;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(pe||(pe={}));class Gn{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,s;const n=(s=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var r,s;const n=(s=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:{},i=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,i)}_encodeUserBroadcastPush(e,r,s){var n,a;const i=e.topic,l=(n=e.ref)!==null&&n!==void 0?n:"",c=(a=e.join_ref)!==null&&a!==void 0?a:"",u=e.payload.event,d=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},h=Object.keys(d).length===0?"":JSON.stringify(d);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`topic length ${i.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+i.length+u.length+h.length,g=new ArrayBuffer(this.HEADER_LENGTH+f);let p=new DataView(g),m=0;p.setUint8(m++,this.KINDS.userBroadcastPush),p.setUint8(m++,c.length),p.setUint8(m++,l.length),p.setUint8(m++,i.length),p.setUint8(m++,u.length),p.setUint8(m++,h.length),p.setUint8(m++,r),Array.from(c,y=>p.setUint8(m++,y.charCodeAt(0))),Array.from(l,y=>p.setUint8(m++,y.charCodeAt(0))),Array.from(i,y=>p.setUint8(m++,y.charCodeAt(0))),Array.from(u,y=>p.setUint8(m++,y.charCodeAt(0))),Array.from(h,y=>p.setUint8(m++,y.charCodeAt(0)));var b=new Uint8Array(g.byteLength+s.byteLength);return b.set(new Uint8Array(g),0),b.set(new Uint8Array(s),g.byteLength),b.buffer}decode(e,r){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return r(s)}if(typeof e=="string"){const s=JSON.parse(e),[n,a,i,l,c]=s;return r({join_ref:n,ref:a,topic:i,event:l,payload:c})}return r({})}_binaryDecode(e){const r=new DataView(e),s=r.getUint8(0),n=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,n)}}_decodeUserBroadcast(e,r,s){const n=r.getUint8(1),a=r.getUint8(2),i=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const u=s.decode(e.slice(c,c+n));c=c+n;const d=s.decode(e.slice(c,c+a));c=c+a;const h=s.decode(e.slice(c,c+i));c=c+i;const f=e.slice(c,e.byteLength),g=l===this.JSON_ENCODING?JSON.parse(s.decode(f)):f,p={type:this.BROADCAST_EVENT,event:d,payload:g};return i>0&&(p.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e==null?void 0:e.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>r.includes(s)))}}class Jr{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var R;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(R||(R={}));const nr=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((a,i)=>(a[i]=Jn(i,t,e,n),a),{}):{}},Jn=(t,e,r,s)=>{const n=e.find(l=>l.name===t),a=n==null?void 0:n.type,i=r[t];return a&&!s.includes(a)?Qr(a,i):Ot(i)},Qr=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return Xn(e,r)}switch(t){case R.bool:return Qn(e);case R.float4:case R.float8:case R.int2:case R.int4:case R.int8:case R.numeric:case R.oid:return Yn(e);case R.json:case R.jsonb:return Zn(e);case R.timestamp:return ea(e);case R.abstime:case R.date:case R.daterange:case R.int4range:case R.int8range:case R.money:case R.reltime:case R.text:case R.time:case R.timestamptz:case R.timetz:case R.tsrange:case R.tstzrange:return Ot(e);default:return Ot(e)}},Ot=t=>t,Qn=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Yn=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Zn=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},Xn=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let a;const i=t.slice(1,r);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(l=>Qr(e,l))}return t},ea=t=>typeof t=="string"?t.replace(" ","T"):t,Yr=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class pt{constructor(e,r,s={},n=Ct){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ar;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(ar||(ar={}));class Pe{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:a,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Pe.syncState(this.state,n,a,i),this.pendingDiffs.forEach(c=>{this.state=Pe.syncDiff(this.state,c,a,i)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},n=>{const{onJoin:a,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Pe.syncDiff(this.state,n,a,i),l())}),this.onJoin((n,a,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:i})}),this.onLeave((n,a,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const a=this.cloneDeep(e),i=this.transformState(r),l={},c={};return this.map(a,(u,d)=>{i[u]||(c[u]=d)}),this.map(i,(u,d)=>{const h=a[u];if(h){const f=d.map(b=>b.presence_ref),g=h.map(b=>b.presence_ref),p=d.filter(b=>g.indexOf(b.presence_ref)<0),m=h.filter(b=>f.indexOf(b.presence_ref)<0);p.length>0&&(l[u]=p),m.length>0&&(c[u]=m)}else l[u]=d}),this.syncDiff(a,{joins:l,leaves:c},s,n)}static syncDiff(e,r,s,n){const{joins:a,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(a,(l,c)=>{var u;const d=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(c),d.length>0){const h=e[l].map(g=>g.presence_ref),f=d.filter(g=>h.indexOf(g.presence_ref)<0);e[l].unshift(...f)}s(l,d,c)}),this.map(i,(l,c)=>{let u=e[l];if(!u)return;const d=c.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[l]=u,n(l,u,c),u.length===0&&delete e[l]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ir;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(ir||(ir={}));var De;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(De||(De={}));var se;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(se||(se={}));class Oe{constructor(e,r={config:{}},s){var n,a;if(this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=B.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new pt(this,Z.join,this.params,this.timeout),this.rejoinTimer=new Jr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=B.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=B.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=B.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=B.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=B.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Z.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new Pe(this),this.broadcastEndpointURL=Yr(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var s,n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==B.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params,u=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(g=>g.filter))!==null&&n!==void 0?n:[],d=!!this.bindings[De.PRESENCE]&&this.bindings[De.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,h={},f={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(g=>e==null?void 0:e(se.CHANNEL_ERROR,g)),this._onClose(()=>e==null?void 0:e(se.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:g})=>{var p;if(this.socket._isManualToken()||this.socket.setAuth(),g===void 0){e==null||e(se.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,b=(p=m==null?void 0:m.length)!==null&&p!==void 0?p:0,y=[];for(let _=0;_<b;_++){const v=m[_],{filter:{event:k,schema:$,table:T,filter:A}}=v,q=g&&g[_];if(q&&q.event===k&&Oe.isFilterValueEqual(q.schema,$)&&Oe.isFilterValueEqual(q.table,T)&&Oe.isFilterValueEqual(q.filter,A))y.push(Object.assign(Object.assign({},v),{id:q.id}));else{this.unsubscribe(),this.state=B.errored,e==null||e(se.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(se.SUBSCRIBED);return}}).receive("error",g=>{this.state=B.errored,e==null||e(se.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(se.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this.state===B.joined&&e===De.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,r,s)}async httpSend(e,r,s={}){var n;if(r==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const i={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:i}=e,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=u.body)===null||n===void 0?void 0:n.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,l,c;const u=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=B.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Z.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new pt(this,Z.leave,{},e),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=B.closed,this.bindings={}}async _fetchWithTimeout(e,r,s){const n=new AbortController,a=setTimeout(()=>n.abort(),s),i=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(a),i}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new pt(this,e,r,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Kn){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,a;const i=e.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=Z;if(s&&[l,c,u,d].indexOf(i)>=0&&s!==this._joinRef())return;let f=this._onMessage(i,r,s);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(g=>{var p,m,b;return((p=g.filter)===null||p===void 0?void 0:p.event)==="*"||((b=(m=g.filter)===null||m===void 0?void 0:m.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===i}).map(g=>g.callback(f,s)):(a=this.bindings[i])===null||a===void 0||a.filter(g=>{var p,m,b,y,_,v;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in g){const k=g.id,$=(p=g.filter)===null||p===void 0?void 0:p.event;return k&&((m=r.ids)===null||m===void 0?void 0:m.includes(k))&&($==="*"||($==null?void 0:$.toLocaleLowerCase())===((b=r.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const k=(_=(y=g==null?void 0:g.filter)===null||y===void 0?void 0:y.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return k==="*"||k===((v=r==null?void 0:r.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===i}).map(g=>{if(typeof f=="object"&&"ids"in f){const p=f.data,{schema:m,table:b,commit_timestamp:y,type:_,errors:v}=p;f=Object.assign(Object.assign({},{schema:m,table:b,commit_timestamp:y,eventType:_,new:{},old:{},errors:v}),this._getPayloadRecords(p))}g.callback(f,s)})}_isClosed(){return this.state===B.closed}_isJoined(){return this.state===B.joined}_isJoining(){return this.state===B.joining}_isLeaving(){return this.state===B.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),a={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&Oe.isEqual(n.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}static isFilterValueEqual(e,r){return(e??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Z.close,{},e)}_onError(e){this._on(Z.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=B.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=nr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=nr(e.columns,e.old_record)),r}}const bt=()=>{},We={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},ta=[1e3,2e3,5e3,1e4],ra=1e4,sa=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class na{constructor(e,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ct,this.transport=null,this.heartbeatIntervalMs=We.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=bt,this.ref=0,this.reconnectTimer=null,this.vsn=sr,this.logger=bt,this.conn=null,this.sendBuffer=[],this.serializer=new Gn,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...a)=>n(...a):(...a)=>fetch(...a),!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Tt.websocket}`,this.httpEndpoint=Yr(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Mn.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case le.connecting:return pe.Connecting;case le.open:return pe.Open;case le.closing:return pe.Closing;default:return pe.Closed}}isConnected(){return this.connectionState()===pe.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(a=>a.topic===s);if(n)return n;{const a=new Oe(`realtime:${e}`,r,this);return this.channels.push(a),a}}push(e){const{topic:r,event:s,payload:n,ref:a}=e,i=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${s} (${a})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Wn,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},We.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:n,payload:a,ref:i}=r,l=i?`(${i})`:"",c=a.status||"";this.log("receive",`${c} ${s} ${n} ${l}`.trim(),a),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(n,a,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===le.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===le.open||this.conn.readyState===le.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Z.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([sa],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r,s=!1;if(e)r=e,s=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),r=this.accessTokenValue}else r=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:Hn};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Z.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(r)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new Jr(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},We.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,s,n,a,i,l,c,u,d,h,f,g;switch(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:Ct,this.heartbeatIntervalMs=(n=e==null?void 0:e.heartbeatIntervalMs)!==null&&n!==void 0?n:We.HEARTBEAT_INTERVAL,this.worker=(a=e==null?void 0:e.worker)!==null&&a!==void 0?a:!1,this.accessToken=(i=e==null?void 0:e.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:bt,this.vsn=(c=e==null?void 0:e.vsn)!==null&&c!==void 0?c:sr,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:p=>ta[p-1]||ra,this.vsn){case Gr:this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(p,m)=>m(JSON.stringify(p)),this.decode=(h=e==null?void 0:e.decode)!==null&&h!==void 0?h:(p,m)=>m(JSON.parse(p));break;case Vn:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(g=e==null?void 0:e.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var Ue=class extends Error{constructor(t,e){var r;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((r=e.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function aa(t,e,r){const s=new URL(e,t);if(r)for(const[n,a]of Object.entries(r))a!==void 0&&s.searchParams.set(n,a);return s.toString()}async function ia(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function oa(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:n,body:a,headers:i}){const l=aa(t.baseUrl,s,n),c=await ia(t.auth),u=await e(l,{method:r,headers:{...a?{"Content-Type":"application/json"}:{},...c,...i},body:a?JSON.stringify(a):void 0}),d=await u.text(),h=(u.headers.get("content-type")||"").includes("application/json"),f=h&&d?JSON.parse(d):d;if(!u.ok){const g=h?f:void 0,p=g==null?void 0:g.error;throw new Ue((p==null?void 0:p.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:p==null?void 0:p.type,icebergCode:p==null?void 0:p.code,details:g})}return{status:u.status,headers:u.headers,data:f}}}}function Ke(t){return t.join("")}var la=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:Ke(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ke(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ke(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ke(t.namespace)}`}),!0}catch(e){if(e instanceof Ue&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof Ue&&r.status===409)return;throw r}}};function xe(t){return t.join("")}var ca=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${xe(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${xe(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${xe(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${xe(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${xe(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${xe(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof Ue&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof Ue&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},ua=class{constructor(t){var s;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=oa({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(s=t.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new la(this.client,e),this.tableOps=new ca(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},ot=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function P(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var da=class extends ot{constructor(t,e,r){super(t),this.name="StorageApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},It=class extends ot{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const Mt=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),ha=()=>Response,Rt=t=>{if(Array.isArray(t))return t.map(r=>Rt(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[n]=Rt(s)}),e},fa=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},ga=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Le(t){"@babel/helpers - typeof";return Le=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Le(t)}function ma(t,e){if(Le(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(Le(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pa(t){var e=ma(t,"string");return Le(e)=="symbol"?e:e+""}function ba(t,e,r){return(e=pa(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function or(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function N(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?or(Object(r),!0).forEach(function(s){ba(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):or(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}const vt=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},va=async(t,e,r)=>{t instanceof await ha()&&!(r!=null&&r.noResolveJson)?t.json().then(s=>{const n=t.status||500,a=(s==null?void 0:s.statusCode)||n+"";e(new da(vt(s),n,a))}).catch(s=>{e(new It(vt(s),s))}):e(new It(vt(t),t))},wa=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?n:(fa(s)?(n.headers=N({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,e!=null&&e.duplex&&(n.duplex=e.duplex),N(N({},n),r))};async function He(t,e,r,s,n,a){return new Promise((i,l)=>{t(r,wa(e,s,n,a)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>va(c,l,s))})}async function Be(t,e,r,s){return He(t,"GET",e,r,s)}async function Y(t,e,r,s,n){return He(t,"POST",e,s,n,r)}async function At(t,e,r,s,n){return He(t,"PUT",e,s,n,r)}async function ya(t,e,r,s){return He(t,"HEAD",e,N(N({},r),{},{noResolveJson:!0}),s)}async function qt(t,e,r,s,n){return He(t,"DELETE",e,s,n,r)}var xa=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(P(e))return{data:null,error:e};throw e}}};let Zr;Zr=Symbol.toStringTag;var _a=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[Zr]="BlobDownloadBuilder",this.promise=null}asStream(){return new xa(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(P(e))return{data:null,error:e};throw e}}};const ja={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},lr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var ka=class{constructor(t,e={},r,s){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=r,this.fetch=Mt(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,r,s){var n=this;try{let a;const i=N(N({},lr),s);let l=N(N({},n.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",n.encodeMetadata(c)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.has("cacheControl")||a.append("cacheControl",i.cacheControl),c&&!a.has("metadata")&&a.append("metadata",n.encodeMetadata(c))):(a=r,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,c&&(l["x-metadata"]=n.toBase64(n.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!i.duplex&&(i.duplex="half")),s!=null&&s.headers&&(l=N(N({},l),s.headers));const u=n._removeEmptyFolders(e),d=n._getFinalPath(u),h=await(t=="PUT"?At:Y)(n.fetch,`${n.url}/object/${d}`,a,N({headers:l},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(P(a))return{data:null,error:a};throw a}}async upload(t,e,r){return this.uploadOrUpdate("POST",t,e,r)}async uploadToSignedUrl(t,e,r,s){var n=this;const a=n._removeEmptyFolders(t),i=n._getFinalPath(a),l=new URL(n.url+`/object/upload/sign/${i}`);l.searchParams.set("token",e);try{let c;const u=N({upsert:lr.upsert},s),d=N(N({},n.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",u.cacheControl)):(c=r,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType),{data:{path:a,fullPath:(await At(n.fetch,l.toString(),c,{headers:d})).Key},error:null}}catch(c){if(n.shouldThrowOnError)throw c;if(P(c))return{data:null,error:c};throw c}}async createSignedUploadUrl(t,e){var r=this;try{let s=r._getFinalPath(t);const n=N({},r.headers);e!=null&&e.upsert&&(n["x-upsert"]="true");const a=await Y(r.fetch,`${r.url}/object/upload/sign/${s}`,{},{headers:n}),i=new URL(r.url+a.url),l=i.searchParams.get("token");if(!l)throw new ot("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:l},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(P(s))return{data:null,error:s};throw s}}async update(t,e,r){return this.uploadOrUpdate("PUT",t,e,r)}async move(t,e,r){var s=this;try{return{data:await Y(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(P(n))return{data:null,error:n};throw n}}async copy(t,e,r){var s=this;try{return{data:{path:(await Y(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:s.headers})).Key},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(P(n))return{data:null,error:n};throw n}}async createSignedUrl(t,e,r){var s=this;try{let n=s._getFinalPath(t),a=await Y(s.fetch,`${s.url}/object/sign/${n}`,N({expiresIn:e},r!=null&&r.transform?{transform:r.transform}:{}),{headers:s.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${s.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(P(n))return{data:null,error:n};throw n}}async createSignedUrls(t,e,r){var s=this;try{const n=await Y(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:t},{headers:s.headers}),a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(i=>N(N({},i),{},{signedUrl:i.signedURL?encodeURI(`${s.url}${i.signedURL}${a}`):null})),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(P(n))return{data:null,error:n};throw n}}download(t,e){const r=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),n=s?`?${s}`:"",a=this._getFinalPath(t),i=()=>Be(this.fetch,`${this.url}/${r}/${a}${n}`,{headers:this.headers,noResolveJson:!0});return new _a(i,this.shouldThrowOnError)}async info(t){var e=this;const r=e._getFinalPath(t);try{return{data:Rt(await Be(e.fetch,`${e.url}/object/info/${r}`,{headers:e.headers})),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(P(s))return{data:null,error:s};throw s}}async exists(t){var e=this;const r=e._getFinalPath(t);try{return await ya(e.fetch,`${e.url}/object/${r}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(P(s)&&s instanceof It){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}}getPublicUrl(t,e){const r=this._getFinalPath(t),s=[],n=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";n!==""&&s.push(n);const a=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",i=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});i!==""&&s.push(i);let l=s.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${l}`)}}}async remove(t){var e=this;try{return{data:await qt(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(P(r))return{data:null,error:r};throw r}}async list(t,e,r){var s=this;try{const n=N(N(N({},ja),e),{},{prefix:t||""});return{data:await Y(s.fetch,`${s.url}/object/list/${s.bucketId}`,n,{headers:s.headers},r),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(P(n))return{data:null,error:n};throw n}}async listV2(t,e){var r=this;try{const s=N({},t);return{data:await Y(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,s,{headers:r.headers},e),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(P(s))return{data:null,error:s};throw s}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const Xr="2.89.0",es={"X-Client-Info":`storage-js/${Xr}`};var Ea=class{constructor(t,e={},r,s){this.shouldThrowOnError=!1;const n=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase.")),this.url=n.href.replace(/\/$/,""),this.headers=N(N({},es),e),this.fetch=Mt(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const r=e.listBucketOptionsToQueryString(t);return{data:await Be(e.fetch,`${e.url}/bucket${r}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(P(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await Be(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(P(r))return{data:null,error:r};throw r}}async createBucket(t,e={public:!1}){var r=this;try{return{data:await Y(r.fetch,`${r.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(P(s))return{data:null,error:s};throw s}}async updateBucket(t,e){var r=this;try{return{data:await At(r.fetch,`${r.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(P(s))return{data:null,error:s};throw s}}async emptyBucket(t){var e=this;try{return{data:await Y(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(P(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await qt(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(P(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},Sa=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=N(N({},es),e),this.fetch=Mt(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await Y(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(P(r))return{data:null,error:r};throw r}}async listBuckets(t){var e=this;try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const s=r.toString(),n=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return{data:await Be(e.fetch,n,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(P(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await qt(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(P(r))return{data:null,error:r};throw r}}from(t){var e=this;if(!ga(t))throw new ot("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new ua({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(n,a){const i=n[a];return typeof i!="function"?i:async(...l)=>{try{return{data:await i.apply(n,l),error:null}}catch(c){if(s)throw c;return{data:null,error:c}}}}})}};const Ht={"X-Client-Info":`storage-js/${Xr}`,"Content-Type":"application/json"};var ts=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function K(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var wt=class extends ts{constructor(t,e,r){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Na=class extends ts{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const Vt=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Ca=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},cr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Ta=async(t,e,r)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(r!=null&&r.noResolveJson)){const s=t.status||500,n=t;if(typeof n.json=="function")n.json().then(a=>{const i=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||s+"";e(new wt(cr(a),s,i))}).catch(()=>{const a=s+"";e(new wt(n.statusText||`HTTP ${s} error`,s,a))});else{const a=s+"";e(new wt(n.statusText||`HTTP ${s} error`,s,a))}}else e(new Na(cr(t),t))},Oa=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return s?(Ca(s)?(n.headers=N({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,N(N({},n),r)):n};async function Ia(t,e,r,s,n,a){return new Promise((i,l)=>{t(r,Oa(e,s,n,a)).then(c=>{if(!c.ok)throw c;if(s!=null&&s.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>i(c)).catch(c=>Ta(c,l,s))})}async function G(t,e,r,s,n){return Ia(t,"POST",e,s,n,r)}var Ra=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=N(N({},Ht),e),this.fetch=Vt(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await G(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(K(r))return{data:null,error:r};throw r}}async getIndex(t,e){var r=this;try{return{data:await G(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(K(s))return{data:null,error:s};throw s}}async listIndexes(t){var e=this;try{return{data:await G(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(K(r))return{data:null,error:r};throw r}}async deleteIndex(t,e){var r=this;try{return{data:await G(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers})||{},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(K(s))return{data:null,error:s};throw s}}},Aa=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=N(N({},Ht),e),this.fetch=Vt(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await G(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(K(r))return{data:null,error:r};throw r}}async getVectors(t){var e=this;try{return{data:await G(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(K(r))return{data:null,error:r};throw r}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await G(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(K(r))return{data:null,error:r};throw r}}async queryVectors(t){var e=this;try{return{data:await G(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(K(r))return{data:null,error:r};throw r}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await G(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(K(r))return{data:null,error:r};throw r}}},$a=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=N(N({},Ht),e),this.fetch=Vt(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await G(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(K(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await G(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(K(r))return{data:null,error:r};throw r}}async listBuckets(t={}){var e=this;try{return{data:await G(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(K(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await G(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(K(r))return{data:null,error:r};throw r}}},Pa=class extends $a{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new Da(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,r=this;return e().call(r,t)}async getBucket(t){var e=()=>super.getBucket,r=this;return e().call(r,t)}async listBuckets(t={}){var e=()=>super.listBuckets,r=this;return e().call(r,t)}async deleteBucket(t){var e=()=>super.deleteBucket,r=this;return e().call(r,t)}},Da=class extends Ra{constructor(t,e,r,s){super(t,e,s),this.vectorBucketName=r}async createIndex(t){var e=()=>super.createIndex,r=this;return e().call(r,N(N({},t),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,r=this;return e().call(r,N(N({},t),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,r=this;return e().call(r,r.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,r=this;return e().call(r,r.vectorBucketName,t)}index(t){return new Ua(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},Ua=class extends Aa{constructor(t,e,r,s,n){super(t,e,n),this.vectorBucketName=r,this.indexName=s}async putVectors(t){var e=()=>super.putVectors,r=this;return e().call(r,N(N({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(t){var e=()=>super.getVectors,r=this;return e().call(r,N(N({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,r=this;return e().call(r,N(N({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,r=this;return e().call(r,N(N({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,r=this;return e().call(r,N(N({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},La=class extends Ea{constructor(t,e={},r,s){super(t,e,r,s)}from(t){return new ka(this.url,this.headers,t,this.fetch)}get vectors(){return new Pa(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Sa(this.url+"/iceberg",this.headers,this.fetch)}};const rs="2.89.0",Ce=30*1e3,$t=3,yt=$t*Ce,Ba="http://localhost:9999",Fa="supabase.auth.token",za={"X-Client-Info":`gotrue-js/${rs}`},Pt="X-Supabase-Api-Version",ss={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Ma=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,qa=10*60*1e3;class Fe extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function j(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Ha extends Fe{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function Va(t){return j(t)&&t.name==="AuthApiError"}class be extends Fe{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class oe extends Fe{constructor(e,r,s,n){super(e,s,n),this.name=r,this.status=s}}class W extends oe{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Wa(t){return j(t)&&t.name==="AuthSessionMissingError"}class _e extends oe{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ge extends oe{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Je extends oe{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Ka(t){return j(t)&&t.name==="AuthImplicitGrantRedirectError"}class ur extends oe{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ga extends oe{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Dt extends oe{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function xt(t){return j(t)&&t.name==="AuthRetryableFetchError"}class dr extends oe{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class Ut extends oe{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Xe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),hr=` 	
\r=`.split(""),Ja=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<hr.length;e+=1)t[hr[e].charCodeAt(0)]=-2;for(let e=0;e<Xe.length;e+=1)t[Xe[e].charCodeAt(0)]=e;return t})();function fr(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(Xe[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(Xe[s]),e.queuedBits-=6}}function ns(t,e,r){const s=Ja[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function gr(t){const e=[],r=i=>{e.push(String.fromCodePoint(i))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=i=>{Za(i,s,r)};for(let i=0;i<t.length;i+=1)ns(t.charCodeAt(i),n,a);return e.join("")}function Qa(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Ya(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}Qa(s,e)}}function Za(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Ie(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)ns(t.charCodeAt(n),r,s);return new Uint8Array(e)}function Xa(t){const e=[];return Ya(t,r=>e.push(r)),new Uint8Array(e)}function ve(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};return t.forEach(n=>fr(n,r,s)),fr(null,r,s),e.join("")}function ei(t){return Math.round(Date.now()/1e3)+t}function ti(){return Symbol("auth-callback")}const M=()=>typeof window<"u"&&typeof document<"u",fe={tested:!1,writable:!1},as=()=>{if(!M())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(fe.tested)return fe.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),fe.tested=!0,fe.writable=!0}catch{fe.tested=!0,fe.writable=!1}return fe.writable};function ri(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,a)=>{e[a]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const is=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),si=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Te=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},ge=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},z=async(t,e)=>{await t.removeItem(e)};class lt{constructor(){this.promise=new lt.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}lt.promiseConstructor=Promise;function _t(t){const e=t.split(".");if(e.length!==3)throw new Ut("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!Ma.test(e[s]))throw new Ut("JWT not in base64url format");return{header:JSON.parse(gr(e[0])),payload:JSON.parse(gr(e[1])),signature:Ie(e[2]),raw:{header:e[0],payload:e[1]}}}async function ni(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function ai(t,e){return new Promise((s,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await t(a);if(!e(a,null,i)){s(i);return}}catch(i){if(!e(a,i)){n(i);return}}})()})}function ii(t){return("0"+t.toString(16)).substr(-2)}function oi(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let a=0;a<56;a++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,ii).join("")}async function li(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function ci(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await li(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function je(t,e,r=!1){const s=oi();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await Te(t,`${e}-code-verifier`,n);const a=await ci(s);return[a,s===a?"plain":"s256"]}const ui=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function di(t){const e=t.headers.get(Pt);if(!e||!e.match(ui))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function hi(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function fi(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const gi=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ke(t){if(!gi.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function jt(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function mi(t,e){return new Proxy(t,{get:(r,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const a=s.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,n)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,s,n)}})}function mr(t){return JSON.parse(JSON.stringify(t))}const me=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),pi=[502,503,504];async function pr(t){var e;if(!si(t))throw new Dt(me(t),0);if(pi.includes(t.status))throw new Dt(me(t),t.status);let r;try{r=await t.json()}catch(a){throw new be(me(a),a)}let s;const n=di(t);if(n&&n.getTime()>=ss["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new dr(me(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new W}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new dr(me(r),t.status,r.weak_password.reasons);throw new Ha(me(r),t.status||500,s)}const bi=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function S(t,e,r,s){var n;const a=Object.assign({},s==null?void 0:s.headers);a[Pt]||(a[Pt]=ss["2024-01-01"].name),s!=null&&s.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const i=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(i.redirect_to=s.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await vi(t,e,r+l,{headers:a,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function vi(t,e,r,s,n,a){const i=bi(e,s,n,a);let l;try{l=await t(r,Object.assign({},i))}catch(c){throw console.error(c),new Dt(me(c),0)}if(l.ok||await pr(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await pr(c)}}function Q(t){var e;let r=null;xi(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=ei(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function br(t){const e=Q(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function ue(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function wi(t){return{data:t,error:null}}function yi(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:a}=t,i=it(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:a},c=Object.assign({},i);return{data:{properties:l,user:c},error:null}}function vr(t){return t}function xi(t){return t.access_token&&t.refresh_token&&t.expires_in}const kt=["global","local","others"];class _i{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=is(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=kt[0]){if(kt.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${kt.join(", ")}`);try{return await S(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(j(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await S(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ue})}catch(s){if(j(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=it(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await S(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:yi,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(j(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await S(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ue})}catch(r){if(j(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,a,i,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await S(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:vr});if(d.error)throw d.error;const h=await d.json(),f=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,g=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(p.split(";")[1].split("=")[1]);u[`${b}Page`]=m}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(j(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){ke(e);try{return await S(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ue})}catch(r){if(j(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){ke(e);try{return await S(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:ue})}catch(s){if(j(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){ke(e);try{return await S(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:ue})}catch(s){if(j(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){ke(e.userId);try{const{data:r,error:s}=await S(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(j(r))return{data:null,error:r};throw r}}async _deleteFactor(e){ke(e.userId),ke(e.id);try{return{data:await S(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(j(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,s,n,a,i,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await S(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:vr});if(d.error)throw d.error;const h=await d.json(),f=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,g=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(p.split(";")[1].split("=")[1]);u[`${b}Page`]=m}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(j(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await S(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(j(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await S(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(j(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await S(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(j(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await S(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(j(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await S(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(j(r))return{data:null,error:r};throw r}}}function wr(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const Ee={debug:!!(globalThis&&as()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class os extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ji extends os{}async function ki(t,e,r){Ee.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Ee.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){Ee.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{Ee.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw Ee.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new ji(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Ee.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Ei(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function ls(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function Si(t){return parseInt(t,16)}function Ni(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function Ci(t){var e;const{chainId:r,domain:s,expirationTime:n,issuedAt:a=new Date,nonce:i,notBefore:l,requestId:c,resources:u,scheme:d,uri:h,version:f}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const g=ls(t.address),p=d?`${d}://${s}`:s,m=t.statement?`${t.statement}
`:"",b=`${p} wants you to sign in with your Ethereum account:
${g}

${m}`;let y=`URI: ${h}
Version: ${f}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${a.toISOString()}`;if(n&&(y+=`
Expiration Time: ${n.toISOString()}`),l&&(y+=`
Not Before: ${l.toISOString()}`),c&&(y+=`
Request ID: ${c}`),u){let _=`
Resources:`;for(const v of u){if(!v||typeof v!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${v}`);_+=`
- ${v}`}y+=_}return`${b}
${y}`}class U extends Error{constructor({message:e,code:r,cause:s,name:n}){var a;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(a=n??(s instanceof Error?s.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class et extends U{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function Ti({error:t,options:e}){var r,s,n;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new U({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new U({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new U({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new U({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new U({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new U({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new U({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new U({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const i=window.location.hostname;if(cs(i)){if(a.rp.id!==i)return new U({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new U({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new U({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new U({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new U({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Oi({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new U({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new U({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(cs(s)){if(r.rpId!==s)return new U({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new U({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new U({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new U({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class Ii{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Ri=new Ii;function Ai(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:s}=t,n=it(t,["challenge","user","excludeCredentials"]),a=Ie(e).buffer,i=Object.assign(Object.assign({},r),{id:Ie(r.id).buffer}),l=Object.assign(Object.assign({},n),{challenge:a,user:i});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let c=0;c<s.length;c++){const u=s[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:Ie(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function $i(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,s=it(t,["challenge","allowCredentials"]),n=Ie(e).buffer,a=Object.assign(Object.assign({},s),{challenge:n});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const l=r[i];a.allowCredentials[i]=Object.assign(Object.assign({},l),{id:Ie(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function Pi(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:ve(new Uint8Array(t.response.attestationObject)),clientDataJSON:ve(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Di(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,s=t.getClientExtensionResults(),n=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:ve(new Uint8Array(n.authenticatorData)),clientDataJSON:ve(new Uint8Array(n.clientDataJSON)),signature:ve(new Uint8Array(n.signature)),userHandle:n.userHandle?ve(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function cs(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function yr(){var t,e;return!!(M()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function Ui(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new et("Browser returned unexpected credential type",e)}:{data:null,error:new et("Empty credential response",e)}}catch(e){return{data:null,error:Ti({error:e,options:t})}}}async function Li(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new et("Browser returned unexpected credential type",e)}:{data:null,error:new et("Empty credential response",e)}}catch(e){return{data:null,error:Oi({error:e,options:t})}}}const Bi={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Fi={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function tt(...t){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of t)if(n)for(const a in n){const i=n[a];if(i!==void 0)if(Array.isArray(i))s[a]=i;else if(r(i))s[a]=i;else if(e(i)){const l=s[a];e(l)?s[a]=tt(l,i):s[a]=tt(i)}else s[a]=i}return s}function zi(t,e){return tt(Bi,t,e||{})}function Mi(t,e){return tt(Fi,t,e||{})}class qi{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:s,signal:n},a){try{const{data:i,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!i)return{data:null,error:l};const c=n??Ri.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:u}=i.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${s}`),u.displayName||(u.displayName=u.name)}switch(i.webauthn.type){case"create":{const u=zi(i.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:d,error:h}=await Ui({publicKey:u,signal:c});return d?{data:{factorId:e,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}case"request":{const u=Mi(i.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:d,error:h}=await Li(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:u,signal:c}));return d?{data:{factorId:e,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}}}catch(i){return j(i)?{data:null,error:i}:{data:null,error:new be("Unexpected error in challenge",i)}}}async _verify({challengeId:e,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},a){if(!r)return{data:null,error:new Fe("rpId is required for WebAuthn authentication")};try{if(!yr())return{data:null,error:new be("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:s},signal:n},{request:a});if(!i)return{data:null,error:l};const{webauthn:c}=i;return this._verify({factorId:e,challengeId:i.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:s,credential_response:c.credential_response}})}catch(i){return j(i)?{data:null,error:i}:{data:null,error:new be("Unexpected error in authenticate",i)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},a){if(!r)return{data:null,error:new Fe("rpId is required for WebAuthn registration")};try{if(!yr())return{data:null,error:new be("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this._enroll({friendlyName:e});if(!i)return await this.client.mfa.listFactors().then(d=>{var h;return(h=d.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:n},{create:a});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:s,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(i){return j(i)?{data:null,error:i}:{data:null,error:new be("Unexpected error in register",i)}}}}Ei();const Hi={url:Ba,storageKey:Fa,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:za,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function xr(t,e,r){return await r()}const Se={};class ze{get jwks(){var e,r;return(r=(e=Se[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Se[this.storageKey]=Object.assign(Object.assign({},Se[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Se[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Se[this.storageKey]=Object.assign(Object.assign({},Se[this.storageKey]),{cachedAt:e})}constructor(e){var r,s,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},Hi),e);if(this.storageKey=a.storageKey,this.instanceID=(r=ze.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,ze.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&M()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new _i({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=is(a.fetch),this.lock=a.lock||xr,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:this.persistSession&&M()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=ki:this.lock=xr,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new qi(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:as()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=wr(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=wr(this.memoryStorage)),M()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${rs}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},s="none";if(M()&&(r=ri(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),M()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:a}=await this._getSessionFromURL(r,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),Ka(a)){const c=(e=a.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return j(r)?this._returnResult({error:r}):this._returnResult({error:new be("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,n;try{const a=await S(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:Q}),{data:i,error:l}=a;if(l||!i)return this._returnResult({data:{user:null,session:null},error:l});const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(j(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var r,s,n;try{let a;if("email"in e){const{email:d,password:h,options:f}=e;let g=null,p=null;this.flowType==="pkce"&&([g,p]=await je(this.storage,this.storageKey)),a=await S(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:g,code_challenge_method:p},xform:Q})}else if("phone"in e){const{phone:d,password:h,options:f}=e;a=await S(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(n=f==null?void 0:f.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Q})}else throw new Ge("You must provide either an email or phone number and a password");const{data:i,error:l}=a;if(l||!i)return await z(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(await z(this.storage,`${this.storageKey}-code-verifier`),j(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let r;if("email"in e){const{email:a,password:i,options:l}=e;r=await S(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:br})}else if("phone"in e){const{phone:a,password:i,options:l}=e;r=await S(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:br})}else throw new Ge("You must provide either an email or phone number and a password");const{data:s,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const a=new _e;return this._returnResult({data:{user:null,session:null},error:a})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(j(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,s,n,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,s,n,a,i,l,c,u,d,h,f;let g,p;if("message"in e)g=e.message,p=e.signature;else{const{chain:m,wallet:b,statement:y,options:_}=e;let v;if(M())if(typeof b=="object")v=b;else{const H=window;if("ethereum"in H&&typeof H.ethereum=="object"&&"request"in H.ethereum&&typeof H.ethereum.request=="function")v=H.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=b}const k=new URL((r=_==null?void 0:_.url)!==null&&r!==void 0?r:window.location.href),$=await v.request({method:"eth_requestAccounts"}).then(H=>H).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!$||$.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const T=ls($[0]);let A=(s=_==null?void 0:_.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!A){const H=await v.request({method:"eth_chainId"});A=Si(H)}const q={domain:k.host,address:T,statement:y,uri:k.href,version:"1",chainId:A,nonce:(n=_==null?void 0:_.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(i=(a=_==null?void 0:_.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(l=_==null?void 0:_.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=_==null?void 0:_.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=_==null?void 0:_.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=_==null?void 0:_.signInWithEthereum)===null||d===void 0?void 0:d.resources};g=Ci(q),p=await v.request({method:"personal_sign",params:[Ni(g),T]})}try{const{data:m,error:b}=await S(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:g,signature:p},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Q});if(b)throw b;if(!m||!m.session||!m.user){const y=new _e;return this._returnResult({data:{user:null,session:null},error:y})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:b})}catch(m){if(j(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(e){var r,s,n,a,i,l,c,u,d,h,f,g;let p,m;if("message"in e)p=e.message,m=e.signature;else{const{chain:b,wallet:y,statement:_,options:v}=e;let k;if(M())if(typeof y=="object")k=y;else{const T=window;if("solana"in T&&typeof T.solana=="object"&&("signIn"in T.solana&&typeof T.solana.signIn=="function"||"signMessage"in T.solana&&typeof T.solana.signMessage=="function"))k=T.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=y}const $=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in k&&k.signIn){const T=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:$.host,uri:$.href}),_?{statement:_}:null));let A;if(Array.isArray(T)&&T[0]&&typeof T[0]=="object")A=T[0];else if(T&&typeof T=="object"&&"signedMessage"in T&&"signature"in T)A=T;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in A&&"signature"in A&&(typeof A.signedMessage=="string"||A.signedMessage instanceof Uint8Array)&&A.signature instanceof Uint8Array)p=typeof A.signedMessage=="string"?A.signedMessage:new TextDecoder().decode(A.signedMessage),m=A.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${$.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),..._?["",_,""]:[""],"Version: 1",`URI: ${$.href}`,`Issued At: ${(n=(s=v==null?void 0:v.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=v==null?void 0:v.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((i=v==null?void 0:v.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((l=v==null?void 0:v.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((u=v==null?void 0:v.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((h=(d=v==null?void 0:v.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...v.signInWithSolana.resources.map(A=>`- ${A}`)]:[]].join(`
`);const T=await k.signMessage(new TextEncoder().encode(p),"utf8");if(!T||!(T instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=T}}try{const{data:b,error:y}=await S(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:ve(m)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:Q});if(y)throw y;if(!b||!b.session||!b.user){const _=new _e;return this._returnResult({data:{user:null,session:null},error:_})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:y})}catch(b){if(j(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async _exchangeCodeForSession(e){const r=await ge(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{if(!s&&this.flowType==="pkce")throw new Ga;const{data:a,error:i}=await S(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Q});if(await z(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!a||!a.session||!a.user){const l=new _e;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:i})}catch(a){if(await z(this.storage,`${this.storageKey}-code-verifier`),j(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:r,provider:s,token:n,access_token:a,nonce:i}=e,l=await S(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Q}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new _e;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(r){if(j(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,s,n,a,i;try{if("email"in e){const{email:l,options:c}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await je(this.storage,this.storageKey));const{error:h}=await S(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:l,options:c}=e,{data:u,error:d}=await S(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new Ge("You must provide either an email or phone number.")}catch(l){if(await z(this.storage,`${this.storageKey}-code-verifier`),j(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var r,s;try{let n,a;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,a=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:i,error:l}=await S(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:Q});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,u=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(n){if(j(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var r,s,n,a,i;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await je(this.storage,this.storageKey));const u=await S(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:wi});return!((a=u.data)===null||a===void 0)&&a.url&&M()&&!(!((i=e.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(l){if(await z(this.storage,`${this.storageKey}-code-verifier`),j(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new W;const{error:n}=await S(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(j(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:a}=e,{error:i}=await S(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in e){const{phone:s,type:n,options:a}=e,{data:i,error:l}=await S(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:l})}throw new Ge("You must provide either an email or phone number and a type")}catch(r){if(j(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await ge(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<yt:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const i=await ge(this.userStorage,this.storageKey+"-user");i!=null&&i.user?e.user=i.user:e.user=jt()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};e.user=mi(e.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(e){try{return e?await S(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ue}):await this._useSession(async r=>{var s,n,a;const{data:i,error:l}=r;if(l)throw l;return!(!((s=i.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new W}:await S(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:ue})})}catch(r){if(j(r))return Wa(r)&&(await this._removeSession(),await z(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:a}=s;if(a)throw a;if(!n.session)throw new W;const i=n.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await je(this.storage,this.storageKey));const{data:u,error:d}=await S(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:i.access_token,xform:ue});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(s){if(await z(this.storage,`${this.storageKey}-code-verifier`),j(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new W;const r=Date.now()/1e3;let s=r,n=!0,a=null;const{payload:i}=_t(e.access_token);if(i.exp&&(s=i.exp,n=s<=r),n){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(j(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:i,error:l}=r;if(l)throw l;e=(s=i.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new W;const{data:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(j(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!M())throw new Je("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Je(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new ur("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Je("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ur("No code detected.");const{data:_,error:v}=await this._exchangeCodeForSession(e.code);if(v)throw v;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:a,refresh_token:i,expires_in:l,expires_at:c,token_type:u}=e;if(!a||!l||!i||!u)throw new Je("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let f=d+h;c&&(f=parseInt(c));const g=f-d;g*1e3<=Ce&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${h}s`);const p=f-h;d-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,f,d):d-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,f,d);const{data:m,error:b}=await this._getUser(a);if(b)throw b;const y={provider_token:s,provider_refresh_token:n,access_token:a,expires_in:h,expires_at:f,refresh_token:i,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:y,redirectType:e.type},error:null})}catch(s){if(j(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await ge(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({error:a});const i=(s=n.session)===null||s===void 0?void 0:s.access_token;if(i){const{error:l}=await this.admin.signOut(i,e);if(l&&!(Va(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await z(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=ti(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:a},error:i}=r;if(i)throw i;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await je(this.storage,this.storageKey,!0));try{return await S(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(await z(this.storage,`${this.storageKey}-code-verifier`),j(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(j(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:s,error:n}=await this._useSession(async a=>{var i,l,c,u,d;const{data:h,error:f}=a;if(f)throw f;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await S(this.fetch,"GET",g,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return M()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(j(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var s;try{const{error:n,data:{session:a}}=r;if(n)throw n;const{options:i,provider:l,token:c,access_token:u,nonce:d}=e,h=await S(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=a==null?void 0:a.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:Q}),{data:f,error:g}=h;return g?this._returnResult({data:{user:null,session:null},error:g}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new _e}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:g}))}catch(n){if(await z(this.storage,`${this.storageKey}-code-verifier`),j(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:a,error:i}=r;if(i)throw i;return await S(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(j(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await ai(async n=>(n>0&&await ni(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await S(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Q})),(n,a)=>{const i=200*Math.pow(2,n);return a&&xt(a)&&Date.now()+i-s<Ce})}catch(s){if(this._debug(r,"error",s),j(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),M()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await ge(this.storage,this.storageKey);if(n&&this.userStorage){let i=await ge(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:n.user},await Te(this.userStorage,this.storageKey+"-user",i)),n.user=(e=i==null?void 0:i.user)!==null&&e!==void 0?e:jt()}else if(n&&!n.user&&!n.user){const i=await ge(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(n.user=i.user,await z(this.storage,this.storageKey+"-user"),await Te(this.storage,this.storageKey,n)):n.user=jt()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const a=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<yt;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${yt}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),xt(i)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(n.access_token);!l&&(i!=null&&i.user)?(n.user=i.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(s,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new W;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new lt;const{data:a,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!a.session)throw new W;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(n,"error",a),j(a)){const i={data:null,error:a};return xt(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(c){a.push(c)}});if(await Promise.all(i),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await z(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await Te(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const a=mr(n);await Te(this.storage,this.storageKey,a)}else{const n=mr(r);await Te(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await z(this.storage,this.storageKey),await z(this.storage,this.storageKey+"-code-verifier"),await z(this.storage,this.storageKey+"-user"),this.userStorage&&await z(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&M()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ce);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/Ce);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Ce}ms, refresh threshold is ${$t} ticks`),n<=$t&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof os)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!M()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,i]=await je(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(l.toString())}if(s!=null&&s.queryParams){const a=new URLSearchParams(s.queryParams);n.push(a.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;return a?this._returnResult({data:null,error:a}):await S(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(j(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:u}=await S(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return u?this._returnResult({data:null,error:u}):(e.factorType==="totp"&&c.type==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(j(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?Pi(e.webauthn.credential_response):Di(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await S(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:i,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(j(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=await S(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});if(i.error)return i;const{data:l}=i;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Ai(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:$i(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(j(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=r==null?void 0:r.factors)!==null&&e!==void 0?e:[])n.all.push(a),a.status==="verified"&&n[a.factor_type].push(a);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:s},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=_t(s.access_token);let i=null;a.aal&&(i=a.aal);let l=i;((r=(e=s.user.factors)===null||e===void 0?void 0:e.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:i,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await S(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new W})})}catch(r){if(j(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!n)return this._returnResult({data:null,error:new W});const i=await S(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&M()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(j(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!n)return this._returnResult({data:null,error:new W});const i=await S(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&M()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(j(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;return s?this._returnResult({data:null,error:s}):r?await S(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new W})})}catch(e){if(j(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?(await S(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new W})})}catch(r){if(j(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(l=>l.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+qa>n)return s;const{data:a,error:i}=await S(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=n,s=a.keys.find(l=>l.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:g,error:p}=await this.getSession();if(p||!g.session)return this._returnResult({data:null,error:p});s=g.session.access_token}const{header:n,payload:a,signature:i,raw:{header:l,payload:c}}=_t(s);r!=null&&r.allowExpired||hi(a.exp);const u=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:g}=await this.getUser(s);if(g)throw g;return{data:{claims:a,header:n,signature:i},error:null}}const d=fi(n.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,i,Xa(`${l}.${c}`)))throw new Ut("Invalid JWT signature");return{data:{claims:a,header:n,signature:i},error:null}}catch(s){if(j(s))return this._returnResult({data:null,error:s});throw s}}}ze.nextInstanceID={};const Vi=ze,Wi="2.89.0";let $e="";typeof Deno<"u"?$e="deno":typeof document<"u"?$e="web":typeof navigator<"u"&&navigator.product==="ReactNative"?$e="react-native":$e="node";const Ki={"X-Client-Info":`supabase-js-${$e}/${Wi}`},Gi={headers:Ki},Ji={schema:"public"},Qi={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Yi={};function Me(t){"@babel/helpers - typeof";return Me=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Me(t)}function Zi(t,e){if(Me(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(Me(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xi(t){var e=Zi(t,"string");return Me(e)=="symbol"?e:e+""}function eo(t,e,r){return(e=Xi(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _r(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function D(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_r(Object(r),!0).forEach(function(s){eo(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_r(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}const to=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),ro=()=>Headers,so=(t,e,r)=>{const s=to(r),n=ro();return async(a,i)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:t;let u=new n(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),s(a,D(D({},i),{},{headers:u}))}};function no(t){return t.endsWith("/")?t:t+"/"}function ao(t,e){var r,s;const{db:n,auth:a,realtime:i,global:l}=t,{db:c,auth:u,realtime:d,global:h}=e,f={db:D(D({},c),n),auth:D(D({},u),a),realtime:D(D({},d),i),storage:{},global:D(D(D({},h),l),{},{headers:D(D({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function io(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(no(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var oo=class extends Vi{constructor(t){super(t)}},lo=class{constructor(t,e,r){var s,n;this.supabaseUrl=t,this.supabaseKey=e;const a=io(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const i=`sb-${a.hostname.split(".")[0]}-auth-token`,l={db:Ji,realtime:Yi,auth:D(D({},Qi),{},{storageKey:i}),global:Gi},c=ao(r??{},l);if(this.storageKey=(s=c.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(n=c.global.headers)!==null&&n!==void 0?n:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=c.auth)!==null&&u!==void 0?u:{},this.headers,c.global.fetch)}this.fetch=so(e,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(D({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&this.accessToken().then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new zn(new URL("rest/v1",a).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new La(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new Dn(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,r;if(t.accessToken)return await t.accessToken();const{data:s}=await t.auth.getSession();return(e=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:s,userStorage:n,storageKey:a,flowType:i,lock:l,debug:c,throwOnError:u},d,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new oo({url:this.authUrl.href,headers:D(D({},f),d),storageKey:a,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:s,userStorage:n,flowType:i,lock:l,debug:c,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new na(this.realtimeUrl.href,D(D({},t),{},{params:D(D({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const co=(t,e,r)=>new lo(t,e,r);function uo(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}uo()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const ho="https://ccwrxgvddypgbbdmjsaw.supabase.co",fo="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNjd3J4Z3ZkZHlwZ2JiZG1qc2F3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYzMjM5NTQsImV4cCI6MjA4MTg5OTk1NH0.9RsMSsYIwENQLvvgI2jXgZGJNfoy9iHvf_70_6aaClY",X=co(ho,fo),jr={async uploadBackgroundImage(t){try{if(!t)throw new Error("No se seleccionó archivo");if(t.size>5*1024*1024)throw new Error("La imagen debe ser menor a 5MB");const e=t.name.split(".").pop(),r=`${Date.now()}_${Math.random().toString(36).substring(2)}.${e}`,s=`backgrounds/${r}`;console.log("📤 Subiendo imagen:",r);const{data:n,error:a}=await X.storage.from("countdown-images").upload(s,t);if(a)throw a;const{data:{publicUrl:i}}=X.storage.from("countdown-images").getPublicUrl(s);return console.log("✅ Imagen subida:",i),{success:!0,url:i,fileName:r,path:s}}catch(e){return console.error("❌ Error subiendo imagen:",e),{success:!1,error:e.message}}},async deleteImage(t){try{const{error:e}=await X.storage.from("countdown-images").remove([t]);if(e)throw e;return{success:!0}}catch(e){return console.error("Error eliminando imagen:",e),{success:!1,error:e.message}}}},ye={async getAllCountdowns(){try{console.log("📋 Obteniendo todos los countdowns...");const{data:t,error:e}=await X.from("countdowns").select("*").order("created_at",{ascending:!1});if(e)throw console.error("❌ Error al obtener countdowns:",e),e;return console.log(`✅ ${(t==null?void 0:t.length)||0} countdowns encontrados`),t.map(r=>{var s;return{id:r.id,public_url:r.public_url,title:r.title,targetDate:r.target_date,startDate:((s=r.custom_data)==null?void 0:s.start_date)||r.created_at,message:r.message,backgroundColor:r.background_color||"#4a148c",textColor:r.text_color||"#ffffff",progressIcon:r.progress_icon||"FaHourglassHalf",backgroundImage:r.background_image,useImage:!!r.background_image,views:r.views||0,created_at:r.created_at,custom_data:r.custom_data||{}}})}catch(t){console.error("💥 Error en getAllCountdowns:",t);try{const e=[];for(let r=0;r<localStorage.length;r++){const s=localStorage.key(r);if(s.startsWith("countdown_")){const n=JSON.parse(localStorage.getItem(s));e.push({...n,id:s.replace("countdown_","")})}}return e}catch(e){throw console.error("Error cargando localmente:",e),t}}},async createCountdown(t,e=null){var r;try{console.log("📝 CREATE - Datos recibidos:",{targetDate:t.targetDate,startDate:t.startDate,formattedTarget:this.formatDateForDB(t.targetDate),formattedStart:this.formatDateForDB(t.startDate),timezoneOffset:new Date().getTimezoneOffset(),currentTime:new Date().toString()});let s=null;if(e&&t.useImage){const c=await jr.uploadBackgroundImage(e);c.success?s=c.url:(console.warn("⚠️ No se pudo subir imagen, usando URL directa"),s=t.backgroundImage)}else t.useImage&&t.backgroundImage&&!t.backgroundImage.startsWith("data:")&&(s=t.backgroundImage);const n=`cd_${Date.now().toString(36)}_${Math.random().toString(36).substring(2,6)}`,a={title:t.title,target_date:this.formatDateForDB(t.targetDate),message:t.message||null,background_color:t.backgroundColor||"#4a148c",text_color:t.textColor||"#ffffff",background_image:s,progress_icon:t.progressIcon||"FaHourglassHalf",public_url:n,views:0,custom_data:{start_date:this.formatDateForDB(t.startDate),use_image:!!t.useImage}};console.log("📤 INSERT a BD:",a);const{data:i,error:l}=await X.from("countdowns").insert([a]).select().single();if(l)throw console.error("❌ Error de Supabase:",l),new Error(`Error al crear countdown: ${l.message}`);return console.log("✅ Countdown creado:",i),{id:i.id,public_url:i.public_url,title:i.title,targetDate:i.target_date,startDate:((r=i.custom_data)==null?void 0:r.start_date)||t.startDate,message:i.message,backgroundColor:i.background_color,textColor:i.text_color,progressIcon:i.progress_icon||"FaHourglassHalf",backgroundImage:i.background_image,useImage:!!i.background_image,views:i.views||0,created_at:i.created_at}}catch(s){throw console.error("💥 Error en createCountdown:",s),s}},async getCountdown(t){var e;try{console.log("🔍 Buscando countdown:",t);let r=X.from("countdowns").select("*");/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)?r=r.eq("id",t):r=r.eq("public_url",t);const{data:n,error:a}=await r.single();if(a)throw a;return await this.incrementViews(n.id,n.views),{id:n.id,public_url:n.public_url,title:n.title,targetDate:n.target_date,startDate:((e=n.custom_data)==null?void 0:e.start_date)||n.created_at,message:n.message,backgroundColor:n.background_color||"#4a148c",textColor:n.text_color||"#ffffff",progressIcon:n.progress_icon||"FaHourglassHalf",backgroundImage:n.background_image,useImage:!!n.background_image,views:(n.views||0)+1,created_at:n.created_at,custom_data:n.custom_data||{}}}catch(r){throw console.error("💥 Error en getCountdown:",r),r}},async incrementViews(t,e=0){try{console.log("🔢 Incrementando vistas para ID:",t);const r=(e||0)+1,{error:s}=await X.from("countdowns").update({views:r}).eq("id",t);return s?(console.error("❌ Error incrementando vistas:",s),!1):(console.log(`✅ Vistas incrementadas a ${r} para ID: ${t}`),!0)}catch(r){return console.error("💥 Error en incrementViews:",r),!1}},async updateCountdown(t,e,r=null){var s;try{console.log("✏️ UPDATE - Datos recibidos:",{targetDate:e.targetDate,startDate:e.startDate,formattedTarget:this.formatDateForDB(e.targetDate),formattedStart:this.formatDateForDB(e.startDate)});let n=e.backgroundImage;if(r&&e.useImage){const c=await jr.uploadBackgroundImage(r);c.success&&(n=c.url)}const a={title:e.title,target_date:this.formatDateForDB(e.targetDate),message:e.message||null,background_color:e.backgroundColor||"#4a148c",text_color:e.textColor||"#ffffff",background_image:n,progress_icon:e.progressIcon||"FaHourglassHalf",updated_at:new Date().toISOString(),custom_data:{...e.custom_data,start_date:this.formatDateForDB(e.startDate),use_image:!!e.useImage}};console.log("📤 UPDATE a BD:",a);const{data:i,error:l}=await X.from("countdowns").update(a).eq("id",t).select().single();if(l)throw console.error("❌ Error de Supabase:",l),new Error(`Error al actualizar countdown: ${l.message}`);return localStorage.setItem(`countdown_${t}`,JSON.stringify({...e,backgroundImage:n})),console.log("✅ Countdown actualizado:",i),{id:i.id,public_url:i.public_url,title:i.title,targetDate:i.target_date,startDate:((s=i.custom_data)==null?void 0:s.start_date)||e.startDate,message:i.message,backgroundColor:i.background_color,textColor:i.text_color,progressIcon:i.progress_icon||"FaHourglassHalf",backgroundImage:i.background_image,useImage:!!i.background_image,views:i.views||0,created_at:i.created_at}}catch(n){console.error("💥 Error en updateCountdown:",n);try{return localStorage.setItem(`countdown_${t}`,JSON.stringify(e)),e}catch{throw n}}},async deleteCountdown(t){try{console.log("🗑️ Eliminando countdown:",t);const{error:e}=await X.from("countdowns").delete().eq("id",t);if(e)throw console.error("❌ Error de Supabase:",e),new Error(`Error al eliminar countdown: ${e.message}`);return localStorage.removeItem(`countdown_${t}`),console.log("✅ Countdown eliminado"),!0}catch(e){console.error("💥 Error en deleteCountdown:",e);try{return localStorage.removeItem(`countdown_${t}`),!0}catch{throw e}}},formatDateForDB(t){if(!t){console.log("⚠️ Fecha vacía, usando fecha actual");const e=new Date,r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),a=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0");return`${r}-${s}-${n} ${a}:${i}:00`}console.log("📅 formatDateForDB - Input:",t,"Tipo:",typeof t);try{if(typeof t=="string"&&t.includes("T")&&t.length===16){console.log("✅ Formato datetime-local detectado");const l=t.replace("T"," ")+":00";return console.log("📤 Output PostgreSQL:",l),l}if(typeof t=="string"&&t.includes(" ")&&t.length>=19)return console.log("✅ Ya está en formato PostgreSQL"),t;if(typeof t=="string"&&t.length===10&&t.includes("-"))return console.log("✅ Solo fecha, agregando hora 00:00:00"),t+" 00:00:00";if(t instanceof Date){console.log("✅ Es objeto Date, convirtiendo a PostgreSQL");const l=t.getFullYear(),c=String(t.getMonth()+1).padStart(2,"0"),u=String(t.getDate()).padStart(2,"0"),d=String(t.getHours()).padStart(2,"0"),h=String(t.getMinutes()).padStart(2,"0"),f=String(t.getSeconds()).padStart(2,"0");return`${l}-${c}-${u} ${d}:${h}:${f}`}if(typeof t=="string"&&t.includes("T")&&t.endsWith("Z")){console.log("✅ Formato ISO detectado, convirtiendo");const l=new Date(t),c=l.getFullYear(),u=String(l.getMonth()+1).padStart(2,"0"),d=String(l.getDate()).padStart(2,"0"),h=String(l.getHours()).padStart(2,"0"),f=String(l.getMinutes()).padStart(2,"0"),g=String(l.getSeconds()).padStart(2,"0");return`${c}-${u}-${d} ${h}:${f}:${g}`}console.warn("⚠️ Formato no reconocido:",t);const e=new Date,r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),a=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0");return`${r}-${s}-${n} ${a}:${i}:00`}catch(e){console.error("❌ Error en formatDateForDB:",e);const r=new Date,s=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0");return`${s}-${n}-${a} 00:00:00`}},async testConnection(){var t;try{const{data:e,error:r}=await X.from("countdowns").select("count(*)");if(r)throw r;return{success:!0,count:((t=e[0])==null?void 0:t.count)||0}}catch(e){return{success:!1,error:e.message}}}},go=()=>window.location.hostname.includes("github.io"),mo=()=>go()?`${window.location.origin}/countdown-qr-app`:"https://dvdstv89.github.io/countdown-qr-app",we=t=>`${mo()}/#/c/${t}`,kr=t=>{if(!t)return"";try{if(console.log("🔄 formatDateForInput - Entrada:",t),t.includes(" ")&&t.length>=19){const[a,i]=t.split(" "),[l,c]=i.split(":"),u=new Date(a+"T"+i),d=u.getTimezoneOffset()*6e4,f=new Date(u.getTime()-d).toISOString().slice(0,16);return console.log("✅ formatDateForInput - Salida:",f),f}const e=new Date(t),r=e.getTimezoneOffset()*6e4,n=new Date(e.getTime()-r).toISOString().slice(0,16);return console.log("✅ formatDateForInput - Salida:",n),n}catch(e){return console.error("❌ Error en formatDateForInput:",e),""}},Er=t=>{if(!t)return console.log("⚠️ formatDateForDB - Fecha vacía"),new Date().toISOString();console.log("🔄 formatDateForDB - Entrada:",t);try{if(t.includes("T")&&t.length===16){const c=t.replace("T"," ")+":00";return console.log("✅ formatDateForDB - Salida PostgreSQL:",c),c}if(t.includes(" ")&&t.length>=19)return console.log("✅ formatDateForDB - Ya es PostgreSQL"),t;if(t.length===10&&t.includes("-")){const c=t+" 00:00:00";return console.log("✅ formatDateForDB - Solo fecha:",c),c}console.warn("⚠️ formatDateForDB - Formato no reconocido:",t);const e=new Date,r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),a=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0"),l=`${r}-${s}-${n} ${a}:${i}:00`;return console.log("⚠️ formatDateForDB - Fallback:",l),l}catch(e){console.error("❌ Error en formatDateForDB:",e);const r=new Date,s=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0");return`${s}-${n}-${a} 00:00:00`}},po=Wr(),bo=[{name:"Estrellas",url:"https://images.unsplash.com/photo-1519681393784-d120267933ba?w=800&auto=format&fit=crop"},{name:"Fiesta",url:"https://images.unsplash.com/photo-1530103862676-de8c9debad1d?w=800&auto=format&fit=crop"},{name:"Naturaleza",url:"https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=800&auto=format&fit=crop"},{name:"Navidad",url:"https://images.unsplash.com/photo-1544717305-2782549b5136?w=800&auto=format&fit=crop"},{name:"Abstracto",url:"https://images.unsplash.com/photo-1550684376-efcbd6e3f031?w=800&auto=format&fit=crop"},{name:"Reyes",url:"https://ccwrxgvddypgbbdmjsaw.supabase.co/storage/v1/object/public/countdown-images/backgrounds/1766347941172_1c9z4xkx0pt.jpg"}];function vo(){const t=Nr(),e=x.useRef(null),[r,s]=x.useState(!1),[n,a]=x.useState(""),[i,l]=x.useState(!1),[c,u]=x.useState(""),[d,h]=x.useState({title:"Cumpleaños",targetDate:new Date(Date.now()+864e5).toISOString().slice(0,16),startDate:new Date().toISOString().slice(0,10),message:"¡Falta poco para tu día especial!",backgroundColor:"#4a148c",textColor:"#ffffff",backgroundImage:"",progressIcon:"https://cdn-icons-png.flaticon.com/512/3195/3195411.png",useImage:!1}),[f,g]=x.useState(null),[p,m]=x.useState(""),[b,y]=x.useState({days:0,hours:0,minutes:0,seconds:0}),[_,v]=x.useState(0);x.useEffect(()=>{const E=()=>{const C=new Date(d.targetDate),L=new Date(d.startDate),V=new Date,J=C-V;if(J<=0){y({days:0,hours:0,minutes:0,seconds:0}),v(100);return}const te=Math.floor(J/(1e3*60*60*24)),ut=Math.floor(J%(1e3*60*60*24)/(1e3*60*60)),dt=Math.floor(J%(1e3*60*60)/(1e3*60)),ht=Math.floor(J%(1e3*60)/1e3);y({days:te,hours:ut,minutes:dt,seconds:ht});const ft=C-L,gt=V-L,mt=Math.min(Math.max(gt/ft*100,0),100);v(mt)};E();const w=setInterval(E,1e3);return()=>clearInterval(w)},[d.targetDate,d.startDate]),x.useEffect(()=>()=>{p.startsWith("blob:")&&URL.revokeObjectURL(p)},[p]);const k=async E=>{E.preventDefault(),s(!0);try{console.log("🚀 Creando countdown...");const w=await ye.createCountdown(d,f);console.log("Respuesta del servicio:",w);const C=we(w.public_url);localStorage.setItem("last_countdown_url",C),localStorage.setItem("last_countdown_id",w.public_url),u(C);const L=await Wt.toDataURL(C,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"}});a(L),l(!0),O.success("✅ Countdown creado exitosamente!"),p.startsWith("blob:")&&(URL.revokeObjectURL(p),m(""),g(null))}catch(w){console.error("❌ Error:",w),O.error(`Error: ${w.message}`);const C=`local_${Date.now().toString(36)}`,L=we(C);u(L);const V=await Wt.toDataURL(L,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"}});a(V),l(!0),localStorage.setItem(`countdown_${C}`,JSON.stringify({id:C,public_url:C,...d,backgroundImage:p||d.backgroundImage,url:L,created:new Date().toISOString()})),O.success("Countdown guardado localmente")}finally{s(!1)}},$=E=>{const w=E.target.files[0];if(!w)return;if(w.size>5*1024*1024){O.error("La imagen es muy grande (máximo 5MB)");return}if(!["image/jpeg","image/png","image/webp","image/gif"].includes(w.type)){O.error("Formato no válido. Usa JPG, PNG, WebP o GIF");return}const L=URL.createObjectURL(w);m(L),g(w),h(V=>({...V,backgroundImage:L,useImage:!0})),O.success("Imagen cargada para subir")},T=()=>{p.startsWith("blob:")&&URL.revokeObjectURL(p),m(""),g(null),h(E=>({...E,backgroundImage:"",useImage:!1})),e.current&&(e.current.value=""),O.success("Imagen removida")},A=E=>{h(w=>({...w,backgroundImage:E,useImage:!0})),m(""),g(null),e.current&&(e.current.value="")},q=()=>{if(!n){O.error("Primero genera un QR");return}const E=document.createElement("a");E.download=`countdown-${d.title.replace(/\s+/g,"-")}-${Date.now()}.png`,E.href=n,E.click(),O.success("QR descargado")},H=async E=>{try{return await navigator.clipboard.writeText(E),O.success("✅ Enlace copiado!"),!0}catch(w){console.error("Error usando clipboard:",w);const C=document.createElement("textarea");C.value=E,C.style.position="fixed",C.style.left="-999999px",C.style.top="-999999px",document.body.appendChild(C),C.focus(),C.select();try{return document.execCommand("copy"),O.success("✅ Enlace copiado!"),!0}catch(L){return console.error("Fallback también falló:",L),O.error("❌ No se pudo copiar el enlace"),!1}finally{document.body.removeChild(C)}}},ct=()=>{if(!c){O.error("Primero crea un countdown");return}H(c)};return o.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Crear Countdown"}),o.jsx("p",{className:"text-gray-600",children:"Personaliza cada detalle de tu cuenta regresiva"})]}),o.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[o.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8",children:o.jsxs("form",{onSubmit:k,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Título del Evento *"}),o.jsx("input",{type:"text",value:d.title,onChange:E=>h({...d,title:E.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",placeholder:"Ej: Cumpleaños de ...",required:!0})]}),o.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha del Evento *"}),o.jsx("input",{type:"datetime-local",value:d.targetDate,onChange:E=>h({...d,targetDate:E.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha de Inicio *"}),o.jsx("input",{type:"date",value:d.startDate,onChange:E=>h({...d,startDate:E.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",required:!0}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Para calcular el progreso"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje Personalizado"}),o.jsx("textarea",{value:d.message,onChange:E=>h({...d,message:E.target.value}),rows:"3",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition resize-none",placeholder:"¡Falta poco para tu día especial!",maxLength:200}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1 text-right",children:[d.message.length,"/200 caracteres"]})]}),o.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color de Fondo"}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"color",value:d.backgroundColor,onChange:E=>h({...d,backgroundColor:E.target.value}),className:"w-12 h-12 rounded-lg cursor-pointer border border-gray-300 hover:border-purple-400 transition"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-gray-600 font-mono",children:d.backgroundColor}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click para cambiar"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color de Texto"}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"color",value:d.textColor,onChange:E=>h({...d,textColor:E.target.value}),className:"w-12 h-12 rounded-lg cursor-pointer border border-gray-300 hover:border-purple-400 transition"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-gray-600 font-mono",children:d.textColor}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click para cambiar"})]})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Icono de Progreso"}),o.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-3",children:po.map(E=>o.jsxs("button",{type:"button",onClick:()=>h({...d,progressIcon:E.key}),className:`p-3 rounded-lg border-2 transition-all transform hover:scale-105 ${d.progressIcon===E.key?"border-purple-500 bg-purple-50 scale-105 ring-1 ring-purple-300":"border-gray-200 hover:border-purple-300 hover:bg-gray-50"}`,children:[o.jsx("div",{className:"w-8 h-8 mx-auto flex items-center justify-center text-xl",children:o.jsx(Re,{iconKey:E.key,color:"#4a148c",size:"1.5em"})}),o.jsx("span",{className:"text-xs mt-1 block text-gray-700",children:E.name})]},E.key))})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Imagen de Fondo"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("button",{type:"button",onClick:()=>{h({...d,useImage:!1,backgroundImage:""}),T()},className:`px-3 py-1 rounded text-sm transition ${d.useImage?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-purple-100 text-purple-700 border border-purple-300"}`,children:[o.jsx(Ft,{className:"inline mr-1"})," Solo color"]}),o.jsxs("button",{type:"button",onClick:()=>h({...d,useImage:!0}),className:`px-3 py-1 rounded text-sm transition ${d.useImage?"bg-purple-100 text-purple-700 border border-purple-300":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[o.jsx(at,{className:"inline mr-1"})," Con imagen"]})]})]}),d.useImage?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-4",children:bo.map(E=>o.jsxs("button",{type:"button",onClick:()=>A(E.url),className:`rounded-lg overflow-hidden border-2 transition-all transform hover:scale-[1.02] ${d.backgroundImage===E.url?"border-purple-500 ring-2 ring-purple-300 scale-[1.02]":"border-gray-200 hover:border-purple-300"}`,children:[o.jsx("img",{src:E.url,alt:E.name,className:"w-full h-24 object-cover",loading:"lazy"}),o.jsx("div",{className:"p-2 text-xs text-center bg-white text-gray-700",children:E.name})]},E.url))}),o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"O sube tu propia imagen:"}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("label",{className:"flex-1 cursor-pointer",children:[o.jsxs("div",{className:"px-4 py-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-purple-400 transition-colors text-center group",children:[o.jsx(Vr,{className:"inline mr-2 text-gray-400 group-hover:text-purple-500 text-lg mb-1"}),o.jsx("span",{className:"text-gray-600 group-hover:text-purple-600",children:"Haz clic para subir imagen"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG o WebP (max 5MB)"})]}),o.jsx("input",{ref:e,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:$,className:"hidden"})]}),f&&o.jsx("button",{type:"button",onClick:T,className:"p-3 text-red-500 hover:bg-red-50 rounded-lg transition",title:"Eliminar imagen personalizada",children:o.jsx(qr,{})})]})]}),p&&o.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[o.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Vista previa (se subirá a la nube):"}),o.jsxs("div",{className:"h-32 rounded overflow-hidden border relative",children:[o.jsx("img",{src:p,alt:"Preview personalizada",className:"w-full h-full object-cover"}),o.jsx("div",{className:"absolute bottom-2 right-2 bg-black/70 text-white text-xs px-2 py-1 rounded",children:f==null?void 0:f.name})]}),o.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["📏 Tamaño: ",((f==null?void 0:f.size)/1024/1024).toFixed(2)," MB"]})]}),d.backgroundImage&&!p&&d.backgroundImage!==""&&o.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[o.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Imagen seleccionada:"}),o.jsx("div",{className:"h-32 rounded overflow-hidden border",children:o.jsx("img",{src:d.backgroundImage,alt:"Preview seleccionada",className:"w-full h-full object-cover"})}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"🖼️ Imagen predeterminada"})]})]}):o.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:o.jsx("p",{className:"text-sm text-gray-600",children:'🎨 Usando solo color de fondo. Para agregar una imagen, selecciona "Con imagen".'})})]}),o.jsx("button",{type:"submit",disabled:r,className:"w-full py-4 px-6 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold rounded-lg shadow-lg hover:from-purple-700 hover:to-pink-700 transform hover:-translate-y-1 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:transform-none",children:r?o.jsxs("span",{className:"flex items-center justify-center",children:[o.jsxs("svg",{className:"animate-spin h-5 w-5 mr-3",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Guardando en la nube..."]}):"🎯 Generar Countdown y QR"})]})}),o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Vista Previa"}),o.jsx("div",{className:"rounded-xl overflow-hidden shadow-lg mb-6 min-h-[400px] flex flex-col justify-center relative",style:{background:d.useImage&&d.backgroundImage?`linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${d.backgroundImage}) center/cover`:d.backgroundColor},children:o.jsxs("div",{className:"p-8 flex-1 flex flex-col justify-center relative z-10",style:{color:d.textColor},children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("h3",{className:"text-3xl font-bold mb-4 drop-shadow-lg",children:d.title}),o.jsx("p",{className:"text-xl opacity-90 drop-shadow",children:d.message})]}),o.jsx("div",{className:"flex flex-wrap justify-center gap-4 mb-8",children:Object.entries(b).map(([E,w])=>o.jsxs("div",{className:"text-center bg-black/40 backdrop-blur-sm rounded-lg p-4 min-w-[80px] border border-white/20",children:[o.jsx("div",{className:"text-3xl font-bold",children:w.toString().padStart(2,"0")}),o.jsx("div",{className:"text-sm uppercase opacity-90 mt-1",children:E})]},E))}),o.jsxs("div",{className:"relative mb-4 px-4",children:[o.jsx("div",{className:"h-4 bg-black/40 rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-white/60 rounded-full transition-all duration-1000",style:{width:`${_}%`}})}),d.progressIcon&&o.jsx("div",{className:"absolute top-1/2 transform -translate-y-1/2 -translate-x-1/2 transition-all duration-1000",style:{left:`${_}%`},children:o.jsx("div",{className:"w-10 h-10 filter drop-shadow-lg",children:o.jsx(Re,{iconKey:d.progressIcon,color:d.textColor,size:"2.5em",animate:!0})})})]}),o.jsxs("div",{className:"text-center text-sm opacity-90",children:["Progreso: ",o.jsxs("span",{className:"font-bold text-lg",children:[_.toFixed(1),"%"]})]})]})}),o.jsxs("div",{className:"text-center text-gray-600 space-y-2",children:[o.jsxs("p",{className:"flex items-center justify-center gap-2",children:[o.jsx("span",{className:"text-lg",children:"📱"})," Esta vista se verá en cualquier teléfono"]}),o.jsxs("p",{className:"flex items-center justify-center gap-2",children:[o.jsx("span",{className:"text-lg",children:"🔄"})," El contador se actualiza en tiempo real"]}),d.useImage?o.jsxs("p",{className:"flex items-center justify-center gap-2 text-purple-600 font-medium",children:[o.jsx("span",{className:"text-lg",children:"🖼️"})," ",p?"Con imagen personalizada":"Con imagen predeterminada"]}):o.jsxs("p",{className:"flex items-center justify-center gap-2 text-purple-600 font-medium",children:[o.jsx("span",{className:"text-lg",children:"🎨"})," Usando solo color de fondo"]})]})]}),i&&n&&o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Código QR Generado"}),o.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[o.jsxs("div",{className:"relative",children:[o.jsx("img",{src:n,alt:"QR Code",className:"border-4 border-white shadow-lg rounded-lg w-64 h-64"}),o.jsx("div",{className:"absolute -top-2 -right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:"✓"})]}),c&&o.jsxs("div",{className:"w-full max-w-md",children:[o.jsxs("p",{className:"text-sm text-gray-600 mb-2 font-medium flex items-center gap-2",children:[o.jsx(zr,{})," Enlace generado:"]}),o.jsxs("div",{className:"flex items-center bg-gray-50 p-3 rounded-lg border border-gray-200",children:[o.jsx("code",{className:"flex-1 text-sm text-blue-600 break-all font-mono",children:c}),o.jsx("button",{onClick:()=>H(c),className:"ml-2 px-3 py-1.5 text-xs bg-blue-100 text-blue-600 rounded hover:bg-blue-200 transition font-medium",children:"Copiar"})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 w-full max-w-md",children:[o.jsxs("button",{onClick:q,className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all flex items-center justify-center gap-2",children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Descargar QR"]}),o.jsxs("button",{onClick:ct,disabled:!c,className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white font-semibold rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copiar Enlace"]})]}),o.jsxs("div",{className:"text-center text-gray-600 space-y-3 pt-4 border-t",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsxs("p",{className:"flex items-center justify-center gap-2",children:[o.jsx("span",{className:"text-lg",children:"📱"})," Escanea este QR con la cámara de tu teléfono"]}),o.jsxs("p",{className:"flex items-center justify-center gap-2",children:[o.jsx("span",{className:"text-lg",children:"🔗"})," O comparte el enlace directamente"]})]}),o.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-100",children:[o.jsxs("p",{className:"text-green-700 font-medium flex items-center justify-center gap-2",children:[o.jsx("span",{className:"text-lg",children:"✅"})," Datos guardados en la nube"]}),o.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Tu countdown está disponible en cualquier dispositivo"})]}),o.jsxs("div",{className:"flex justify-center gap-4 pt-2",children:[o.jsx("button",{onClick:()=>t(`/c/${c.split("/").pop()}`),className:"px-4 py-2 text-sm bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition font-medium",children:"Ver Countdown"}),o.jsx("button",{onClick:()=>{c&&window.open(c,"_blank")},className:"px-4 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition font-medium",children:"Abrir en Nueva Pestaña"})]})]})]})]})]})]}),o.jsx("div",{className:"mt-12 pt-8 border-t border-gray-200",children:o.jsxs("div",{className:"grid md:grid-cols-3 gap-6 text-center md:text-left",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"🌐 Acceso Universal"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Tu countdown está disponible en cualquier dispositivo con internet"})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"📊 Estadísticas"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Podrás ver cuántas personas han visto tu countdown"})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"🔄 Actualización en Tiempo Real"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Los visitantes ven el contador actualizado al segundo"})]})]})})]})}function wo(){const{id:t}=Cr(),[e,r]=x.useState(null),[s,n]=x.useState({}),[a,i]=x.useState(0),[l,c]=x.useState(!0),[u,d]=x.useState(null);if(x.useEffect(()=>{(async()=>{try{c(!0);const g=await ye.getCountdown(t);r(g),d(null)}catch(g){console.error("Error cargando countdown:",g),d("No se pudo cargar el countdown desde la nube");try{const p=localStorage.getItem(`countdown_${t}`);if(p){const m=JSON.parse(p);r(m),O.success("Cargado desde copia local")}}catch(p){console.error("Error cargando localmente:",p)}}finally{c(!1)}})()},[t]),x.useEffect(()=>{if(!e)return;const f=()=>{const p=new Date(e.targetDate),m=new Date(e.startDate),b=new Date,y=p-b;if(y<=0){n({days:0,hours:0,minutes:0,seconds:0,hasEnded:!0}),i(100);return}const _=Math.floor(y/(1e3*60*60*24)),v=Math.floor(y%(1e3*60*60*24)/(1e3*60*60)),k=Math.floor(y%(1e3*60*60)/(1e3*60)),$=Math.floor(y%(1e3*60)/1e3);n({days:_,hours:v,minutes:k,seconds:$,hasEnded:!1});const T=p-m,A=b-m,q=Math.min(Math.max(A/T*100,0),100);i(q)};f();const g=setInterval(f,1e3);return()=>clearInterval(g)},[e]),l)return o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-500 to-pink-500",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto"}),o.jsx("p",{className:"mt-4 text-white",children:"Cargando countdown desde la nube..."})]})});if(u&&!e)return o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-500 to-pink-500",children:o.jsxs("div",{className:"bg-white/10 backdrop-blur-sm p-8 rounded-2xl text-center max-w-md",children:[o.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"⚠️ Error"}),o.jsx("p",{className:"text-white mb-6",children:u}),o.jsx("button",{onClick:()=>window.location.href="/",className:"px-6 py-3 bg-white text-purple-600 font-bold rounded-lg hover:bg-gray-100",children:"Volver al inicio"})]})});const h=new Date(e.targetDate).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return o.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 md:p-6 relative",style:{background:e.useImage&&e.backgroundImage?`linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url(${e.backgroundImage}) center/cover no-repeat`:e.backgroundColor,color:e.textColor},children:o.jsxs("div",{className:"max-w-4xl w-full text-center space-y-8 md:space-y-10",children:[e.views>0&&o.jsxs("div",{className:"absolute top-4 right-4 bg-black/50 backdrop-blur-md px-4 py-2 rounded-full text-sm text-white/90 shadow-lg",children:["👁️ ",e.views," vistas"]}),o.jsxs("div",{className:"space-y-4 mb-6",children:[o.jsx("h1",{className:"text-4xl md:text-6xl font-bold drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)] px-4",children:e.title}),o.jsx("p",{className:"text-xl md:text-2xl opacity-95 drop-shadow-[0_2px_4px_rgba(0,0,0,0.6)] px-4",children:e.message})]}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-6 max-w-2xl mx-auto px-2",children:Object.entries({days:"Días",hours:"Horas",minutes:"Minutos",seconds:"Segundos"}).map(([f,g])=>{var p;return o.jsxs("div",{className:"bg-gradient-to-br from-black/40 to-black/20 backdrop-blur-lg rounded-2xl p-4 md:p-6 shadow-2xl border border-white/10",children:[o.jsx("div",{className:"text-4xl md:text-5xl font-bold mb-1 md:mb-2 font-mono tracking-tight",children:((p=s[f])==null?void 0:p.toString().padStart(2,"0"))||"00"}),o.jsx("div",{className:"text-sm md:text-base uppercase tracking-widest font-semibold opacity-90",children:g})]},f)})}),o.jsxs("div",{className:"relative py-6 md:py-8 px-2 max-w-2xl mx-auto w-full",children:[o.jsx("div",{className:"h-3 bg-black/40 backdrop-blur-sm rounded-full overflow-hidden shadow-inner",children:o.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500/80 to-purple-500/80 rounded-full transition-all duration-1000 shadow-lg",style:{width:`${a}%`}})}),e.progressIcon&&o.jsx("div",{className:"absolute top-1/2 transform -translate-y-1/2 -translate-x-1/2 transition-all duration-1000 z-10",style:{left:`${a}%`},children:o.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 filter drop-shadow-[0_0_20px_rgba(255,255,255,0.5)]",children:o.jsx(Re,{iconKey:e.progressIcon,color:e.textColor,size:"4em",animate:!0})})})]}),o.jsx("div",{className:"mt-8 md:mt-12 pt-6 md:pt-8 border-t border-white/20 max-w-2xl mx-auto w-full",children:o.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 md:gap-6 px-2",children:[o.jsxs("div",{className:"bg-gradient-to-r from-black/50 to-black/30 backdrop-blur-md rounded-xl p-5 md:p-6 shadow-xl border border-white/10 flex-1",children:[o.jsx("h3",{className:"text-lg md:text-xl font-bold mb-2 text-white/90",children:"📅 Fecha del Evento"}),o.jsx("p",{className:"text-base md:text-lg text-white font-medium tracking-wide",children:h})]}),o.jsx("div",{children:o.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(window.location.href),alert("¡Enlace copiado al portapapeles!")},className:"px-6 py-3 md:px-8 md:py-4 bg-gradient-to-r from-white/25 to-white/15 backdrop-blur-lg rounded-xl transition-all duration-300 border border-white/30 flex items-center space-x-2 md:space-x-3 text-base md:text-xl font-semibold hover:bg-white/30 hover:scale-105 active:scale-95 shadow-lg hover:shadow-xl",children:[o.jsx(Sn,{className:"text-xl md:text-2xl"}),o.jsx("span",{children:"Compartir"})]})})]})}),s.hasEnded&&o.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/80 backdrop-blur-sm z-50",children:o.jsxs("div",{className:"bg-gradient-to-br from-purple-600/95 to-pink-600/95 p-8 md:p-12 rounded-3xl text-center max-w-2xl mx-4 shadow-2xl border border-white/20",children:[o.jsx("div",{className:"text-6xl md:text-8xl mb-4 md:mb-6 animate-bounce",children:"🎉"}),o.jsx("h2",{className:"text-3xl md:text-5xl font-bold mb-3 md:mb-4 text-white drop-shadow-lg",children:"¡EL EVENTO HA LLEGADO!"}),o.jsx("p",{className:"text-xl md:text-2xl text-white/90 font-medium",children:"¡Es hora de celebrar!"})]})})]})})}function yo(){const[t,e]=x.useState([]),[r,s]=x.useState(!0),[n,a]=x.useState(null),[i,l]=x.useState(null),[c,u]=x.useState(null);x.useEffect(()=>{d()},[]);const d=async()=>{try{s(!0);const m=await ye.getAllCountdowns();e(m)}catch(m){console.error("Error cargando countdowns:",m),O.error("Error al cargar la lista")}finally{s(!1)}},h=async m=>{if(window.confirm("¿Estás seguro de eliminar este countdown? Esta acción no se puede deshacer."))try{u(m),await ye.deleteCountdown(m),e(t.filter(b=>b.id!==m)),O.success("Countdown eliminado exitosamente")}catch{O.error("Error al eliminar el countdown")}finally{u(null)}},f=m=>{const b=we(m.public_url||m.id);navigator.clipboard.writeText(b),O.success("¡Enlace copiado al portapapeles!")},g=m=>new Date(m).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),p=m=>{const b=we(m.public_url||m.id);window.open(b,"_blank")};return r?o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-50 to-pink-50",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Cargando tus countdowns..."})]})}):o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50 py-12 px-4",children:[o.jsxs("div",{className:"max-w-7xl mx-auto",children:[o.jsxs("div",{className:"mb-10 text-center md:text-left",children:[o.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Mis Countdowns"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Gestiona y edita todos tus countdowns creados"}),o.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[o.jsx("div",{children:o.jsxs("p",{className:"text-sm text-gray-500",children:[o.jsx("span",{className:"font-semibold text-purple-600",children:t.length})," countdowns creados"]})}),o.jsxs("div",{className:"flex gap-3",children:[o.jsxs(ne,{to:"/",className:"px-5 py-2.5 bg-white text-gray-700 rounded-lg hover:bg-gray-50 transition-all border border-gray-200 shadow-sm flex items-center gap-2",children:[o.jsx(pn,{}),"Inicio"]}),o.jsxs(ne,{to:"/create",className:"px-5 py-2.5 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all shadow-md flex items-center gap-2",children:[o.jsx("span",{children:"+"}),"Crear Nuevo"]})]})]})]}),t.length===0?o.jsxs("div",{className:"text-center py-16 bg-white rounded-2xl shadow-sm border border-gray-100",children:[o.jsx("div",{className:"text-6xl mb-4",children:"⏳"}),o.jsx("h3",{className:"text-2xl font-semibold text-gray-700 mb-2",children:"No hay countdowns creados"}),o.jsx("p",{className:"text-gray-500 mb-6",children:"Crea tu primer countdown para empezar"}),o.jsx(ne,{to:"/create",className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all shadow-md",children:"Crear mi primer countdown"})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(m=>{var b;return o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100 hover:shadow-xl transition-all duration-300 group",children:[o.jsxs("div",{className:"h-48 relative overflow-hidden",style:{background:m.useImage&&m.backgroundImage?`linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url(${m.backgroundImage})`:m.backgroundColor,backgroundSize:"cover",backgroundPosition:"center"},children:[o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:o.jsxs("div",{className:"text-center text-white p-4",children:[o.jsx("h3",{className:"text-2xl font-bold mb-2 drop-shadow-lg",children:m.title}),o.jsx("p",{className:"text-sm opacity-90 line-clamp-2",children:m.message||"Sin mensaje"})]})}),o.jsxs("div",{className:"absolute top-3 right-3 flex gap-2",children:[o.jsx("span",{className:"bg-black/60 backdrop-blur-sm text-white text-xs px-2 py-1 rounded-full",children:m.useImage?o.jsx(at,{}):o.jsx(Ft,{})}),m.views>0&&o.jsxs("span",{className:"bg-black/60 backdrop-blur-sm text-white text-xs px-2 py-1 rounded-full",children:["👁️ ",m.views]})]})]}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"space-y-3 mb-6",children:[o.jsxs("div",{className:"flex items-center text-gray-600",children:[o.jsx(bn,{className:"mr-2 text-purple-500 flex-shrink-0"}),o.jsx("span",{className:"text-sm truncate",title:g(m.targetDate),children:g(m.targetDate)})]}),o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsxs("div",{className:"text-gray-500",children:["ID:",o.jsx("code",{className:"ml-1 bg-gray-100 px-2 py-1 rounded text-xs",children:((b=m.public_url)==null?void 0:b.substring(0,8))||"local"})]}),o.jsxs("div",{className:"text-gray-500",children:["Icono:",o.jsx("span",{className:"ml-2 inline-block",children:o.jsx(Re,{iconKey:m.progressIcon,color:"#8B5CF6",size:"1em"})})]})]})]}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs("button",{onClick:()=>p(m),className:"flex-1 flex items-center justify-center px-3 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors text-sm",title:"Ver en nueva pestaña",children:[o.jsx(Xt,{className:"mr-2"}),"Ver"]}),o.jsxs(ne,{to:`/edit/${m.id}`,className:"flex-1 flex items-center justify-center px-3 py-2 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 transition-colors text-sm",children:[o.jsx(vn,{className:"mr-2"}),"Editar"]}),o.jsx("button",{onClick:()=>l(m),className:"flex items-center justify-center px-3 py-2 bg-orange-50 text-orange-600 rounded-lg hover:bg-orange-100 transition-colors",title:"Ver QR",children:o.jsx(Mr,{})}),o.jsx("button",{onClick:()=>f(m),className:"flex items-center justify-center px-3 py-2 bg-purple-50 text-purple-600 rounded-lg hover:bg-purple-100 transition-colors",title:"Copiar enlace",children:o.jsx(Zt,{})}),o.jsx("button",{onClick:()=>h(m.id),disabled:c===m.id,className:"flex items-center justify-center px-3 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors disabled:opacity-50",title:"Eliminar",children:c===m.id?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):o.jsx(Hr,{})})]})]})]},m.id)})}),t.length>0&&o.jsx("div",{className:"mt-8 text-center text-sm text-gray-500",children:o.jsx("p",{children:"💡 Consejo: Puedes editar cualquier countdown para actualizar sus datos o imagen de fondo"})})]}),i&&o.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full animate-fadeIn",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Código QR"}),o.jsxs("p",{className:"text-gray-600",children:['Escanea para ver "',i.title,'"']})]}),o.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-200 mb-6 flex items-center justify-center",children:o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:o.jsx(Tr,{value:we(i.public_url||i.id),size:200,level:"H",bgColor:"#FFFFFF",fgColor:"#8B5CF6"})})}),o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("div",{className:"inline-flex items-center bg-gray-50 px-4 py-2 rounded-lg mb-3",children:o.jsx("code",{className:"text-sm text-blue-600 break-all font-mono",children:i.public_url||i.id})}),o.jsx("p",{className:"text-xs text-gray-500",children:"URL pública del countdown"})]}),o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsxs("button",{onClick:()=>f(i),className:"py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all font-medium flex items-center justify-center gap-2",children:[o.jsx(Zt,{}),"Copiar enlace"]}),o.jsxs("button",{onClick:()=>{const m=we(i.public_url||i.id);window.open(m,"_blank")},className:"py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all font-medium flex items-center justify-center gap-2",children:[o.jsx(Xt,{}),"Abrir countdown"]}),o.jsx("button",{onClick:()=>l(null),className:"py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all",children:"Cerrar"})]})]})})]})}const xo=Wr(),_o=[{name:"Estrellas",url:"https://images.unsplash.com/photo-1519681393784-d120267933ba?w=800&auto=format&fit=crop"},{name:"Fiesta",url:"https://images.unsplash.com/photo-1530103862676-de8c9debad1d?w=800&auto=format&fit=crop"},{name:"Naturaleza",url:"https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=800&auto=format&fit=crop"},{name:"Navidad",url:"https://images.unsplash.com/photo-1544717305-2782549b5136?w=800&auto=format&fit=crop"},{name:"Abstracto",url:"https://images.unsplash.com/photo-1550684376-efcbd6e3f031?w=800&auto=format&fit=crop"},{name:"Reyes",url:"https://ccwrxgvddypgbbdmjsaw.supabase.co/storage/v1/object/public/countdown-images/backgrounds/1766347941172_1c9z4xkx0pt.jpg"}];function jo(){const{id:t}=Cr(),e=Nr(),r=x.useRef(null),[s,n]=x.useState(!0),[a,i]=x.useState(!1),[l,c]=x.useState(!1),[u,d]=x.useState(null),[h,f]=x.useState({title:"",message:"",targetDate:"",startDate:"",backgroundColor:"#4a148c",textColor:"#ffffff",backgroundImage:"",progressIcon:"FaHourglassHalf",useImage:!1}),[g,p]=x.useState(""),[m,b]=x.useState({days:0,hours:0,minutes:0,seconds:0}),[y,_]=x.useState(0);x.useEffect(()=>{v()},[t]),x.useEffect(()=>{if(!h.targetDate||!h.startDate)return;const w=()=>{const L=new Date(h.targetDate),V=new Date(h.startDate),J=new Date,te=L-J;if(te<=0){b({days:0,hours:0,minutes:0,seconds:0}),_(100);return}const ut=Math.floor(te/(1e3*60*60*24)),dt=Math.floor(te%(1e3*60*60*24)/(1e3*60*60)),ht=Math.floor(te%(1e3*60*60)/(1e3*60)),ft=Math.floor(te%(1e3*60)/1e3);b({days:ut,hours:dt,minutes:ht,seconds:ft});const gt=L-V,mt=J-V,ds=Math.min(Math.max(mt/gt*100,0),100);_(ds)};w();const C=setInterval(w,1e3);return()=>clearInterval(C)},[h.targetDate,h.startDate]),x.useEffect(()=>()=>{g.startsWith("blob:")&&URL.revokeObjectURL(g)},[g]);const v=async()=>{try{n(!0);const w=await ye.getCountdown(t);f({title:w.title||"",message:w.message||"",targetDate:kr(w.targetDate),startDate:kr(w.startDate),backgroundColor:w.backgroundColor||"#4a148c",textColor:w.textColor||"#ffffff",backgroundImage:w.backgroundImage||"",progressIcon:w.progressIcon||"FaHourglassHalf",useImage:!!w.backgroundImage}),w.backgroundImage&&!w.backgroundImage.startsWith("blob:")&&p(w.backgroundImage)}catch(w){console.error("Error cargando countdown:",w),O.error("No se pudo cargar el countdown"),e("/list")}finally{n(!1)}},k=w=>{const{name:C,value:L,type:V,checked:J}=w.target;f(te=>({...te,[C]:V==="checkbox"?J:L}))},$=w=>{const C=w.target.files[0];if(!C)return;if(C.size>5*1024*1024){O.error("La imagen es muy grande (máximo 5MB)");return}if(!["image/jpeg","image/png","image/webp","image/gif"].includes(C.type)){O.error("Formato no válido. Usa JPG, PNG, WebP o GIF");return}const V=URL.createObjectURL(C);p(V),d(C),f(J=>({...J,backgroundImage:V,useImage:!0})),O.success("Imagen cargada para subir")},T=()=>{g.startsWith("blob:")&&URL.revokeObjectURL(g),p(""),d(null),f(w=>({...w,backgroundImage:"",useImage:!1})),r.current&&(r.current.value=""),O.success("Imagen removida")},A=w=>{f(C=>({...C,backgroundImage:w,useImage:!0})),p(""),d(null),r.current&&(r.current.value="")},q=async w=>{w.preventDefault();try{i(!0);const C={...h,targetDate:Er(h.targetDate),startDate:Er(h.startDate),useImage:!!h.useImage,backgroundImage:g||h.backgroundImage};await ye.updateCountdown(t,C,u),O.success("¡Countdown actualizado exitosamente!"),setTimeout(()=>{e("/list")},1500)}catch(C){console.error("Error actualizando:",C),O.error("Error al actualizar el countdown")}finally{i(!1)}},H=async()=>{if(window.confirm("¿Estás seguro de eliminar este countdown? Esta acción no se puede deshacer."))try{c(!0),await ye.deleteCountdown(t),O.success("Countdown eliminado exitosamente"),e("/list")}catch(w){console.error("Error eliminando:",w),O.error("Error al eliminar el countdown")}finally{c(!1)}},ct=async w=>{try{await navigator.clipboard.writeText(w),O.success("✅ Enlace copiado!")}catch(C){console.error("Error usando clipboard:",C),O.error("❌ No se pudo copiar el enlace")}};if(s)return o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-50 to-pink-50",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})});const E=we(t);return o.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[o.jsxs("div",{className:"mb-8",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Editar Countdown"}),o.jsx("p",{className:"text-gray-600",children:"Modifica los detalles de tu cuenta regresiva"})]}),o.jsxs("button",{onClick:()=>e("/list"),className:"flex items-center gap-2 px-4 py-2.5 bg-white text-gray-700 rounded-lg hover:bg-gray-50 transition-all border border-gray-200 shadow-sm",children:[o.jsx(gn,{}),"Volver a la lista"]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 text-sm",children:[o.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[o.jsx("p",{className:"font-medium text-gray-700",children:"ID:"}),o.jsx("code",{className:"text-sm text-purple-600",children:t})]}),o.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[o.jsx("p",{className:"font-medium text-gray-700",children:"URL:"}),o.jsx("code",{className:"text-sm text-blue-600 truncate",children:E})]}),o.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[o.jsx("p",{className:"font-medium text-gray-700",children:"Estado:"}),o.jsx("span",{className:"text-sm text-green-600",children:"Activo"})]})]})]}),o.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[o.jsx("div",{className:"space-y-8",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Información básica"}),o.jsxs("form",{onSubmit:q,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Título del Evento *"}),o.jsx("input",{type:"text",name:"title",value:h.title,onChange:k,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",placeholder:"Ej: Cumpleaños de ...",required:!0})]}),o.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha del Evento *"}),o.jsx("input",{type:"datetime-local",name:"targetDate",value:h.targetDate,onChange:k,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha de Inicio *"}),o.jsx("input",{type:"datetime-local",name:"startDate",value:h.startDate,onChange:k,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",required:!0}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Para calcular el progreso"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje Personalizado"}),o.jsx("textarea",{name:"message",value:h.message,onChange:k,rows:"3",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition resize-none",placeholder:"¡Falta poco para tu día especial!",maxLength:200}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1 text-right",children:[h.message.length,"/200 caracteres"]})]}),o.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color de Fondo"}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"color",name:"backgroundColor",value:h.backgroundColor,onChange:k,className:"w-12 h-12 rounded-lg cursor-pointer border border-gray-300 hover:border-purple-400 transition"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-gray-600 font-mono",children:h.backgroundColor}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click para cambiar"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color de Texto"}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"color",name:"textColor",value:h.textColor,onChange:k,className:"w-12 h-12 rounded-lg cursor-pointer border border-gray-300 hover:border-purple-400 transition"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-gray-600 font-mono",children:h.textColor}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click para cambiar"})]})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Icono de Progreso"}),o.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-3",children:xo.map(w=>o.jsxs("button",{type:"button",onClick:()=>f({...h,progressIcon:w.key}),className:`p-3 rounded-lg border-2 transition-all transform hover:scale-105 ${h.progressIcon===w.key?"border-purple-500 bg-purple-50 scale-105 ring-1 ring-purple-300":"border-gray-200 hover:border-purple-300 hover:bg-gray-50"}`,children:[o.jsx("div",{className:"w-8 h-8 mx-auto flex items-center justify-center text-xl",children:o.jsx(Re,{iconKey:w.key,color:"#4a148c",size:"1.5em"})}),o.jsx("span",{className:"text-xs mt-1 block text-gray-700",children:w.name})]},w.key))})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Imagen de Fondo"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("button",{type:"button",onClick:()=>{f({...h,useImage:!1,backgroundImage:""}),T()},className:`px-3 py-1 rounded text-sm transition ${h.useImage?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-purple-100 text-purple-700 border border-purple-300"}`,children:[o.jsx(Ft,{className:"inline mr-1"})," Solo color"]}),o.jsxs("button",{type:"button",onClick:()=>f({...h,useImage:!0}),className:`px-3 py-1 rounded text-sm transition ${h.useImage?"bg-purple-100 text-purple-700 border border-purple-300":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[o.jsx(at,{className:"inline mr-1"})," Con imagen"]})]})]}),h.useImage?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-4",children:_o.map(w=>o.jsxs("button",{type:"button",onClick:()=>A(w.url),className:`rounded-lg overflow-hidden border-2 transition-all transform hover:scale-[1.02] ${h.backgroundImage===w.url?"border-purple-500 ring-2 ring-purple-300 scale-[1.02]":"border-gray-200 hover:border-purple-300"}`,children:[o.jsx("img",{src:w.url,alt:w.name,className:"w-full h-24 object-cover",loading:"lazy"}),o.jsx("div",{className:"p-2 text-xs text-center bg-white text-gray-700",children:w.name})]},w.url))}),o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"O sube tu propia imagen:"}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("label",{className:"flex-1 cursor-pointer",children:[o.jsxs("div",{className:"px-4 py-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-purple-400 transition-colors text-center group",children:[o.jsx(Vr,{className:"inline mr-2 text-gray-400 group-hover:text-purple-500 text-lg mb-1"}),o.jsx("span",{className:"text-gray-600 group-hover:text-purple-600",children:"Haz clic para subir imagen"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG o WebP (max 5MB)"})]}),o.jsx("input",{ref:r,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:$,className:"hidden"})]}),u&&o.jsx("button",{type:"button",onClick:T,className:"p-3 text-red-500 hover:bg-red-50 rounded-lg transition",title:"Eliminar imagen personalizada",children:o.jsx(qr,{})})]})]}),g&&o.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[o.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Vista previa (se subirá a la nube):"}),o.jsxs("div",{className:"h-32 rounded overflow-hidden border relative",children:[o.jsx("img",{src:g,alt:"Preview personalizada",className:"w-full h-full object-cover"}),o.jsx("div",{className:"absolute bottom-2 right-2 bg-black/70 text-white text-xs px-2 py-1 rounded",children:u==null?void 0:u.name})]}),o.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["📏 Tamaño: ",((u==null?void 0:u.size)/1024/1024).toFixed(2)," MB"]})]}),h.backgroundImage&&!g&&h.backgroundImage!==""&&o.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[o.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Imagen seleccionada:"}),o.jsx("div",{className:"h-32 rounded overflow-hidden border",children:o.jsx("img",{src:h.backgroundImage,alt:"Preview seleccionada",className:"w-full h-full object-cover"})}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"🖼️ Imagen predeterminada"})]})]}):o.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:o.jsx("p",{className:"text-sm text-gray-600",children:'🎨 Usando solo color de fondo. Para agregar una imagen, selecciona "Con imagen".'})})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-6 border-t",children:[o.jsx("button",{type:"submit",disabled:a,className:"flex-1 px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold rounded-lg shadow-lg hover:from-purple-700 hover:to-pink-700 transition-all flex items-center justify-center gap-2",children:a?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Guardando..."]}):o.jsxs(o.Fragment,{children:[o.jsx(En,{}),"Guardar cambios"]})}),o.jsx("button",{type:"button",onClick:H,disabled:l,className:"flex-1 px-6 py-3 bg-gradient-to-r from-red-500 to-pink-600 text-white font-bold rounded-lg shadow-lg hover:from-red-600 hover:to-pink-700 transition-all flex items-center justify-center gap-2",children:l?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Eliminando..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Hr,{}),"Eliminar countdown"]})})]})]})]})}),o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Vista Previa"}),o.jsx("div",{className:"rounded-xl overflow-hidden shadow-lg mb-6 min-h-[400px] flex flex-col justify-center relative",style:{background:h.useImage&&h.backgroundImage?`linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${h.backgroundImage}) center/cover`:h.backgroundColor},children:o.jsxs("div",{className:"p-8 flex-1 flex flex-col justify-center relative z-10",style:{color:h.textColor},children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("h3",{className:"text-3xl font-bold mb-4 drop-shadow-lg",children:h.title}),o.jsx("p",{className:"text-xl opacity-90 drop-shadow",children:h.message})]}),o.jsx("div",{className:"flex flex-wrap justify-center gap-4 mb-8",children:Object.entries(m).map(([w,C])=>o.jsxs("div",{className:"text-center bg-black/40 backdrop-blur-sm rounded-lg p-4 min-w-[80px] border border-white/20",children:[o.jsx("div",{className:"text-3xl font-bold",children:C.toString().padStart(2,"0")}),o.jsx("div",{className:"text-sm uppercase opacity-90 mt-1",children:w})]},w))}),o.jsxs("div",{className:"relative mb-4 px-4",children:[o.jsx("div",{className:"h-4 bg-black/40 rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-white/60 rounded-full transition-all duration-1000",style:{width:`${y}%`}})}),h.progressIcon&&o.jsx("div",{className:"absolute top-1/2 transform -translate-y-1/2 -translate-x-1/2 transition-all duration-1000",style:{left:`${y}%`},children:o.jsx("div",{className:"w-10 h-10 filter drop-shadow-lg",children:o.jsx(Re,{iconKey:h.progressIcon,color:h.textColor,size:"2.5em",animate:!0})})})]}),o.jsxs("div",{className:"text-center text-sm opacity-90",children:["Progreso: ",o.jsxs("span",{className:"font-bold text-lg",children:[y.toFixed(1),"%"]})]})]})}),o.jsxs("div",{className:"text-center text-gray-600 space-y-2",children:[o.jsxs("p",{className:"flex items-center justify-center gap-2",children:[o.jsx("span",{className:"text-lg",children:"📱"})," Esta vista se verá en cualquier teléfono"]}),o.jsxs("p",{className:"flex items-center justify-center gap-2",children:[o.jsx("span",{className:"text-lg",children:"🔄"})," El contador se actualiza en tiempo real"]}),h.useImage?o.jsxs("p",{className:"flex items-center justify-center gap-2 text-purple-600 font-medium",children:[o.jsx("span",{className:"text-lg",children:"🖼️"})," ",g?"Con imagen personalizada":"Con imagen predeterminada"]}):o.jsxs("p",{className:"flex items-center justify-center gap-2 text-purple-600 font-medium",children:[o.jsx("span",{className:"text-lg",children:"🎨"})," Usando solo color de fondo"]})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Código QR"}),o.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"bg-white p-4 rounded-lg border-4 border-white shadow-lg",children:o.jsx(Tr,{value:E,size:200,level:"H",bgColor:"#FFFFFF",fgColor:"#8B5CF6"})}),o.jsx("div",{className:"absolute -top-2 -right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:"✓"})]}),o.jsxs("div",{className:"w-full max-w-md",children:[o.jsxs("p",{className:"text-sm text-gray-600 mb-2 font-medium flex items-center gap-2",children:[o.jsx(zr,{})," Enlace del countdown:"]}),o.jsxs("div",{className:"flex items-center bg-gray-50 p-3 rounded-lg border border-gray-200",children:[o.jsx("code",{className:"flex-1 text-sm text-blue-600 break-all font-mono",children:E}),o.jsx("button",{onClick:()=>ct(E),className:"ml-2 px-3 py-1.5 text-xs bg-blue-100 text-blue-600 rounded hover:bg-blue-200 transition font-medium",children:"Copiar"})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 w-full max-w-md",children:[o.jsxs("button",{onClick:()=>{const w=document.createElement("a");w.download=`countdown-${h.title.replace(/\s+/g,"-")}-${Date.now()}.png`;const C=document.querySelector("canvas");C&&(w.href=C.toDataURL(),w.click(),O.success("QR descargado"))},className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all flex items-center justify-center gap-2",children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Descargar QR"]}),o.jsxs("button",{onClick:()=>window.open(E,"_blank"),className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white font-semibold rounded-lg hover:from-blue-600 hover:to-cyan-700 transition-all flex items-center justify-center gap-2",children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Ver Countdown"]})]})]})]})]})]})]})}function ko(){return o.jsx("nav",{className:"bg-white shadow-lg sticky top-0 z-50",children:o.jsx("div",{className:"container mx-auto px-4 py-3",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs(ne,{to:"/",className:"flex items-center space-x-3 text-xl font-bold text-purple-700 hover:text-purple-800 transition-colors",children:[o.jsx(Bt,{className:"text-purple-600"}),o.jsx("span",{children:"Countdown QR"})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs(ne,{to:"/",className:"flex items-center space-x-2 px-4 py-2 rounded-lg hover:bg-purple-50 transition-colors text-gray-700 hover:text-purple-700",children:[o.jsx(xn,{}),o.jsx("span",{className:"hidden sm:inline",children:"Inicio"})]}),o.jsxs(ne,{to:"/list",className:"flex items-center space-x-2 px-4 py-2 rounded-lg hover:bg-purple-50 transition-colors text-gray-700 hover:text-purple-700",children:[o.jsx(_n,{}),o.jsx("span",{className:"hidden sm:inline",children:"Mis Countdowns"})]}),o.jsxs(ne,{to:"/create",className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all shadow-md hover:shadow-lg",children:[o.jsx(jn,{}),o.jsx("span",{className:"hidden sm:inline",children:"Crear Countdown"}),o.jsx("span",{className:"sm:hidden",children:"Crear"})]})]})]})})})}function Sr(){const e=!fs().pathname.startsWith("/c/");return o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50",children:[e&&o.jsx(ko,{}),o.jsx("main",{className:e?"container mx-auto px-4 py-8":"",children:o.jsxs(gs,{children:[o.jsx(Ae,{path:"/",element:o.jsx(Cn,{})}),o.jsx(Ae,{path:"/create",element:o.jsx(vo,{})}),o.jsx(Ae,{path:"/c/:id",element:o.jsx(wo,{})}),o.jsx(Ae,{path:"/list",element:o.jsx(yo,{})}),"      ",o.jsx(Ae,{path:"/edit/:id",element:o.jsx(jo,{})}),"   "]})}),o.jsx(dn,{position:"top-right"})]})}const us=window.location.hostname.includes("github.io"),Eo=window.location.hostname==="localhost"||window.location.hostname.includes("192.168.")||window.location.hostname.includes("172.")||window.location.hostname==="127.0.0.1";console.log("🌍 Entorno detectado:",{hostname:window.location.hostname,isGitHubPages:us,isLocalDevelopment:Eo,href:window.location.href});us?Gt(async()=>{const{HashRouter:t}=await import("./vendor-DZk2g_ua.js").then(e=>e.i);return{HashRouter:t}},[]).then(({HashRouter:t})=>{Ye.createRoot(document.getElementById("root")).render(o.jsx(ae.StrictMode,{children:o.jsx(t,{children:o.jsx(Sr,{})})}))}):Gt(async()=>{const{BrowserRouter:t}=await import("./vendor-DZk2g_ua.js").then(e=>e.i);return{BrowserRouter:t}},[]).then(({BrowserRouter:t})=>{Ye.createRoot(document.getElementById("root")).render(o.jsx(ae.StrictMode,{children:o.jsx(t,{children:o.jsx(Sr,{})})}))});
